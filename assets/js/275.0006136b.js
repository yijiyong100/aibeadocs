(window.webpackJsonp=window.webpackJsonp||[]).push([[275],{790:function(s,t,a){"use strict";a.r(t);var r=a(53),n=Object(r.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),a("p",[s._v("本文主要是介绍 常用SQL-存储过程 。")])]),s._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#概念"}},[s._v("概念")])]),a("li",[a("a",{attrs:{href:"#创建存储过程语法"}},[s._v("创建存储过程语法")])]),a("li",[a("a",{attrs:{href:"#存储过程与sql语句对比"}},[s._v("存储过程与SQL语句对比")])]),a("li",[a("a",{attrs:{href:"#为什么在实际应用中-存储过程用到相对较少呢"}},[s._v("为什么在实际应用中，存储过程用到相对较少呢？")])]),a("li",[a("a",{attrs:{href:"#存储过程与sql语句如何抉择"}},[s._v("存储过程与SQL语句如何抉择？")])]),a("li",[a("a",{attrs:{href:"#存储过程的具体应用"}},[s._v("存储过程的具体应用")]),a("ul",[a("li",[a("a",{attrs:{href:"#一、基础查询"}},[s._v("一、基础查询")])]),a("li",[a("a",{attrs:{href:"#_1、创建不带参数的存储过程"}},[s._v("1、创建不带参数的存储过程")])]),a("li",[a("a",{attrs:{href:"#_2、带参数的存储过程"}},[s._v("2、带参数的存储过程")])]),a("li",[a("a",{attrs:{href:"#_3、带有通配符"}},[s._v("3、带有通配符")])]),a("li",[a("a",{attrs:{href:"#_4、带有输出参数"}},[s._v("4、带有输出参数")])])])]),a("li",[a("a",{attrs:{href:"#二、使用存储过程进行增删改"}},[s._v("二、使用存储过程进行增删改")]),a("ul",[a("li",[a("a",{attrs:{href:"#_1、新增"}},[s._v("1、新增")])]),a("li",[a("a",{attrs:{href:"#_2、修改"}},[s._v("2、修改")])]),a("li",[a("a",{attrs:{href:"#_3、删除"}},[s._v("3、删除")])])])]),a("li",[a("a",{attrs:{href:"#三、存储过程实现分页查询"}},[s._v("三、存储过程实现分页查询")]),a("ul",[a("li",[a("a",{attrs:{href:"#_1、使用row-number函数分页"}},[s._v("1、使用row_number函数分页")])]),a("li",[a("a",{attrs:{href:"#_2、使用传统的top分页"}},[s._v("2、使用传统的top分页")])])])]),a("li",[a("a",{attrs:{href:"#四、其他功能"}},[s._v("四、其他功能：")]),a("ul",[a("li",[a("a",{attrs:{href:"#_1、存储过程-每次执行都进行重新编译"}},[s._v("1、存储过程，每次执行都进行重新编译")])]),a("li",[a("a",{attrs:{href:"#_2、对存储过程进行加密"}},[s._v("2、对存储过程进行加密")])])])]),a("li",[a("a",{attrs:{href:"#参考文章"}},[s._v("参考文章")])])])]),a("p"),s._v(" "),a("h1",{attrs:{id:"sql总结-五-存储过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sql总结-五-存储过程"}},[s._v("#")]),s._v(" SQL总结（五）存储过程")]),s._v(" "),a("h2",{attrs:{id:"概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概念"}},[s._v("#")]),s._v(" 概念")]),s._v(" "),a("p",[s._v("存储过程（Stored Procedure）：已预编译为一个可执行过程的一个或多个SQL语句。")]),s._v(" "),a("p",[s._v("注意：不同的数据库Mysql、SQLServer、Oracle、DB2，上的SQL语法会有差异，具体需要参考对应的数据库文档。\n如下案例主要参考SQLServer数据库。")]),s._v(" "),a("h2",{attrs:{id:"创建存储过程语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建存储过程语法"}},[s._v("#")]),s._v(" 创建存储过程语法")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("proc")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" procedure_name\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("{@参数数据类型} "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("默认值"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("output"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n     {@参数数据类型} "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("默认值"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("output"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v("\n    SQL_statementsgo\n")])])]),a("h2",{attrs:{id:"存储过程与sql语句对比"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#存储过程与sql语句对比"}},[s._v("#")]),s._v(" 存储过程与SQL语句对比")]),s._v(" "),a("p",[a("strong",[s._v("优势:")])]),s._v(" "),a("p",[s._v("1、提高性能\nSQL语句在创建过程时进行分析和编译。 存储过程是预编译的，在首次运行一个存储过程时，查询优化器对其进行分析、优化，并给出最终被存在系统表中的存储计划，这样，在执行过程时便可节省此开销。\n2、降低网络开销\n存储过程调用时只需用提供存储过程名和必要的参数信息，从而可降低网络的流量。\n3、便于进行代码移植\n数据库专业人员可以随时对存储过程进行修改，但对应用程序源代码却毫无影响，从而极大的提高了程序的可移植性。\n4、更强的安全性\n1）系统管理员可以对执行的某一个存储过程进行权限限制，避免非授权用户对数据的访问\n2）在通过网络调用过程时，只有对执行过程的调用是可见的。 因此，恶意用户无法看到表和数据库对象名称、嵌入自己的 Transact-SQL 语句或搜索关键数据。\n3）使用过程参数有助于避免 SQL 注入攻击。 因为参数输入被视作文字值而非可执行代码，所以，攻击者将命令插入过程内的 Transact-SQL 语句并损害安全性将更为困难。\n4）可以对过程进行加密，这有助于对源代码进行模糊处理。")]),s._v(" "),a("p",[a("strong",[s._v("劣势：")])]),s._v(" "),a("p",[s._v("1、存储过程需要专门的数据库开发人员进行维护，但实际情况是，往往由程序开发员人员兼职")]),s._v(" "),a("p",[s._v("2、设计逻辑变更，修改存储过程没有SQL灵活")]),s._v(" "),a("h2",{attrs:{id:"为什么在实际应用中-存储过程用到相对较少呢"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为什么在实际应用中-存储过程用到相对较少呢"}},[s._v("#")]),s._v(" "),a("strong",[s._v("为什么在实际应用中，存储过程用到相对较少呢？")])]),s._v(" "),a("p",[s._v("在通常的项目研发中，用存储过程却相对较少，这是为什么呢？\n分析原因如下：\n1）没有特定的数据库开发人员，普通程序员兼职进行数据库操作\n2）程序员往往只需操作程序，即可完成数据访问，无需再在数据库上进行开发\n3）项目需求变动比较频繁，修改SQL语句比较方便，特别是涉及逻辑变更")]),s._v(" "),a("h2",{attrs:{id:"存储过程与sql语句如何抉择"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#存储过程与sql语句如何抉择"}},[s._v("#")]),s._v(" "),a("strong",[s._v("存储过程与SQL语句如何抉择？")])]),s._v(" "),a("p",[s._v("基于实际应用的经验，给予如下建议：")]),s._v(" "),a("p",[s._v("1、在一些高效率或者规范性要求比较高的项目，建议采用存储过程\n2、对于一般项目建议采用参数化命令方式，是存储过程与SQL语句一种折中的方式\n3、对于一些算法要求比较高，涉及多条数据逻辑，建议采用存储过程")]),s._v(" "),a("h2",{attrs:{id:"存储过程的具体应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#存储过程的具体应用"}},[s._v("#")]),s._v(" 存储过程的具体应用")]),s._v(" "),a("h3",{attrs:{id:"一、基础查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、基础查询"}},[s._v("#")]),s._v(" 一、基础查询")]),s._v(" "),a("h3",{attrs:{id:"_1、创建不带参数的存储过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、创建不带参数的存储过程"}},[s._v("#")]),s._v(" 1、创建不带参数的存储过程")]),s._v(" "),a("p",[s._v("例子：查询学生总数")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--查询存储过程")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" OBJECT_ID "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'PROC_SELECT_STUDENTS_COUNT'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'P'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("IS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" PROC_SELECT_STUDENTS_COUNT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nGO\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" PROC_SELECT_STUDENTS_COUNT\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("COUNT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" Students\nGO\n")])])]),a("p",[s._v("执行：")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXEC")]),s._v(" PROC_SELECT_STUDENTS_COUNT\n")])])]),a("h3",{attrs:{id:"_2、带参数的存储过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、带参数的存储过程"}},[s._v("#")]),s._v(" 2、带参数的存储过程")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--查询存储过程，根据城市查询总数")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" OBJECT_ID "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'PROC_SELECT_STUDENTS_BY_CITY_COUNT'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'P'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("IS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" PROC_SELECT_STUDENTS_BY_CITY_COUNT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nGO\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" PROC_SELECT_STUDENTS_BY_CITY_COUNT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@city")]),s._v(" nvarchar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("COUNT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" Students "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" City"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@city")]),s._v("\nGO\n")])])]),a("p",[s._v("执行语句：")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXEC")]),s._v(" PROC_SELECT_STUDENTS_BY_CITY_COUNT N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Beijing'")]),s._v("\n")])])]),a("h3",{attrs:{id:"_3、带有通配符"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、带有通配符"}},[s._v("#")]),s._v(" 3、带有通配符")]),s._v(" "),a("p",[s._v("通配符，在参数值赋值时，加上相应的通配符")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--3、查询姓氏为李的学生信息，含通配符")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" OBJECT_ID "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'PROC_SELECT_STUDENTS_BY_SURNNAME'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'P'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("IS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" PROC_SELECT_STUDENTS_BY_SURNNAME"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nGO\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" PROC_SELECT_STUDENTS_BY_SURNNAME\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@surnName")]),s._v(" nvarchar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'李%'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--默认值")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" ID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("Name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("Age "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" Students "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" Name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("like")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@surnName")]),s._v("\nGO\n")])])]),a("p",[s._v("执行：")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXEC")]),s._v(" PROC_SELECT_STUDENTS_BY_SURNNAME\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXEC")]),s._v(" PROC_SELECT_STUDENTS_BY_SURNNAME N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'李%'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXEC")]),s._v(" PROC_SELECT_STUDENTS_BY_SURNNAME N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%李%'")]),s._v("\n")])])]),a("h3",{attrs:{id:"_4、带有输出参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、带有输出参数"}},[s._v("#")]),s._v(" 4、带有输出参数")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--根据姓名查询的学生信息，返回学生的城市及年龄")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" OBJECT_ID "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'PROC_SELECT_STUDENTS_BY_NAME'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'P'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("IS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" PROC_SELECT_STUDENTS_BY_NAME"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nGO\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" PROC_SELECT_STUDENTS_BY_NAME\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@name")]),s._v(" nvarchar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--输入参数")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@city")]),s._v(" nvarchar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("out")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--输出参数")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@age")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" output        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--输入输出参数")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@city")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("City"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@age")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Age "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" Students "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" Name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@name")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("AND")]),s._v(" Age"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@age")]),s._v("\nGO\n")])])]),a("p",[s._v("执行：")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--执行")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("declare")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@name")]),s._v(" nvarchar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@city")]),s._v(" nvarchar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@age")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@name")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'李明'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@age")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exec")]),s._v(" PROC_SELECT_STUDENTS_BY_NAME "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@city")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("out")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@age")]),s._v(" output"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@city")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@age")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("h2",{attrs:{id:"二、使用存储过程进行增删改"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、使用存储过程进行增删改"}},[s._v("#")]),s._v(" 二、使用存储过程进行增删改")]),s._v(" "),a("h3",{attrs:{id:"_1、新增"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、新增"}},[s._v("#")]),s._v(" 1、新增")]),s._v(" "),a("p",[s._v("新增学生信息")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--1、存储过程：新增学生信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" OBJECT_ID "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'PROC_INSERT_STUDENT'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'P'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("IS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" PROC_INSERT_STUDENT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nGO\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" PROC_INSERT_STUDENT\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@id")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@name")]),s._v(" nvarchar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@age")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@city")]),s._v(" nvarchar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" Students"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("Name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("Age"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("City"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VALUES")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@id")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@age")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@city")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nGO\n")])])]),a("p",[s._v("执行：")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXEC")]),s._v(" PROC_INSERT_STUDENT "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'张三'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ShangHai'")]),s._v("\n")])])]),a("h3",{attrs:{id:"_2、修改"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、修改"}},[s._v("#")]),s._v(" 2、修改")]),s._v(" "),a("p",[s._v("根据学生ID，更新学生信息")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" OBJECT_ID "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'PROC_UPDATE_STUDENT'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'P'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("IS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" PROC_UPDATE_STUDENT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nGO\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" PROC_UPDATE_STUDENT\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@id")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@name")]),s._v(" nvarchar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@age")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@city")]),s._v(" nvarchar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UPDATE")]),s._v(" Students "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" Name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("Age"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@age")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("City"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@city")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@id")]),s._v("\nGO\n")])])]),a("p",[s._v("执行：")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXEC")]),s._v(" PROC_UPDATE_STUDENT "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'张思'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ShangHai'")]),s._v("\n")])])]),a("h3",{attrs:{id:"_3、删除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、删除"}},[s._v("#")]),s._v(" 3、删除")]),s._v(" "),a("p",[s._v("根据ID，删除某学生记录")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--3、存储过程：删除学生信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" OBJECT_ID "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'PROC_DELETE_STUDENT_BY_ID'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'P'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("IS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" PROC_DELETE_STUDENT_BY_ID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nGO\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" PROC_DELETE_STUDENT_BY_ID\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@id")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DELETE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("  Students "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@id")]),s._v("\nGO\n")])])]),a("p",[s._v("执行：")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXEC")]),s._v(" PROC_DELETE_STUDENT_BY_ID "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),s._v("\n")])])]),a("h2",{attrs:{id:"三、存储过程实现分页查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、存储过程实现分页查询"}},[s._v("#")]),s._v(" 三、存储过程实现分页查询")]),s._v(" "),a("h3",{attrs:{id:"_1、使用row-number函数分页"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、使用row-number函数分页"}},[s._v("#")]),s._v(" 1、使用row_number函数分页")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--分页查询")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" OBJECT_ID "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'PROC_SELECT_BY_PAGE'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'P'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("IS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" PROC_SELECT_BY_PAGE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nGO\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" PROC_SELECT_BY_PAGE\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@startIndex")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@endIndex")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" ID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("Name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("Age"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("City"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("ROW_NUMBER"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("OVER")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ORDER")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" ID "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DESC")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" RowNumber "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" Students"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Temp")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Temp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("RowNumber "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("BETWEEN")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@startIndex")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("AND")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@endIndex")]),s._v("\nGO\n")])])]),a("p",[s._v("执行：")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXEC")]),s._v(" PROC_SELECT_BY_PAGE "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n")])])]),a("h3",{attrs:{id:"_2、使用传统的top分页"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、使用传统的top分页"}},[s._v("#")]),s._v(" 2、使用传统的top分页")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--使用TOP分页")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" OBJECT_ID "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'PROC_SELECT_BY_PAGE_WITH_TOP'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'P'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("IS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" PROC_SELECT_BY_PAGE_WITH_TOP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nGO\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" PROC_SELECT_BY_PAGE_WITH_TOP\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@pageIndex")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@pageSize")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TOP")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@pageSize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" Students \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" ID "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("MAX")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TOP")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@pageSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@pageIndex")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ID "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" Students "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ORDER")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" ID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Temp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("    \nGO\n")])])]),a("p",[s._v("执行：")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXEC")]),s._v(" PROC_SELECT_BY_PAGE_WITH_TOP "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n")])])]),a("h2",{attrs:{id:"四、其他功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、其他功能"}},[s._v("#")]),s._v(" 四、其他功能：")]),s._v(" "),a("h3",{attrs:{id:"_1、存储过程-每次执行都进行重新编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、存储过程-每次执行都进行重新编译"}},[s._v("#")]),s._v(" 1、存储过程，每次执行都进行重新编译")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--1、存储过程，重复编译")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" OBJECT_ID "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'PROC_SELECT_STUDENTS_WITH_RECOMPILE'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'P'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("IS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" PROC_SELECT_STUDENTS_WITH_RECOMPILE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nGO\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" PROC_SELECT_STUDENTS_WITH_RECOMPILE\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v(" recompile "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--重复编译")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" Students\nGO\n")])])]),a("h3",{attrs:{id:"_2、对存储过程进行加密"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、对存储过程进行加密"}},[s._v("#")]),s._v(" 2、对存储过程进行加密")]),s._v(" "),a("p",[s._v("加密后，不能查看和修改源脚本")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--2、查询存储过程，进行加密")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" OBJECT_ID "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'PROC_SELECT_STUDENTS_WITH_ENCRYPTION'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" N"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'P'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("IS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" PROC_SELECT_STUDENTS_WITH_ENCRYPTION"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nGO\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("procedure")]),s._v(" PROC_SELECT_STUDENTS_WITH_ENCRYPTION\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v(" encryption "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--加密")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" Students\nGO\n")])])]),a("p",[s._v("执行：")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXEC")]),s._v(" PROC_SELECT_STUDENTS_WITH_ENCRYPTION\n")])])]),a("p",[s._v("效果，无法查看脚本或者导出创建脚本")]),s._v(" "),a("img",{staticClass:"zoom-custom-imgs",attrs:{src:s.$withBase("/assets/img/db/comsql/pro-1.png"),alt:"wxmp"}}),s._v(" "),a("h2",{attrs:{id:"参考文章"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[s._v("#")]),s._v(" 参考文章")]),s._v(" "),a("ul",[a("li",[s._v("https://www.cnblogs.com/yank/p/4235609.html")])])])}),[],!1,null,null,null);t.default=n.exports}}]);