(window.webpackJsonp=window.webpackJsonp||[]).push([[334],{849:function(a,s,t){"use strict";t.r(s);var e=t(53),n=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),t("p",[a._v("本文主要是介绍 Kafka-数据采集简单案例 。")])]),a._v(" "),t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#整合flume与kafka完成实时数据采集"}},[a._v("整合Flume与Kafka完成实时数据采集")])]),t("li",[t("a",{attrs:{href:"#_1-架构"}},[a._v("1.架构")])]),t("li",[t("a",{attrs:{href:"#_2-flume"}},[a._v("2.Flume")])]),t("li",[t("a",{attrs:{href:"#参考文章"}},[a._v("参考文章")])])])]),t("p"),a._v(" "),t("h2",{attrs:{id:"整合flume与kafka完成实时数据采集"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#整合flume与kafka完成实时数据采集"}},[a._v("#")]),a._v(" 整合Flume与Kafka完成实时数据采集")]),a._v(" "),t("h2",{attrs:{id:"_1-架构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-架构"}},[a._v("#")]),a._v(" 1.架构")]),a._v(" "),t("img",{staticClass:"zoom-custom-imgs",attrs:{src:a.$withBase("/assets/img/dc/kafka/intro-1.png"),alt:"wxmp"}}),a._v(" "),t("h2",{attrs:{id:"_2-flume"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-flume"}},[a._v("#")]),a._v(" 2.Flume")]),a._v(" "),t("p",[a._v("第一个Agent配置 -> exec-memory-avro.conf：")]),a._v(" "),t("div",{staticClass:"language-ini extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("exec-memory-avro.sources")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" exec-source")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("exec-memory-avro.sinks")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" avro-sink")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("exec-memory-avro.channels")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" memory-channel")]),a._v("\n \n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("exec-memory-avro.sources.exec-source.type")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" exec")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("exec-memory-avro.sources.exec-source.command")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" tail -F /home/hadoop/data/data.log")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("exec-memory-avro.sources.exec-source.shell")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" /bin/sh -c")]),a._v("\n \n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("exec-memory-avro.sinks.avro-sink.type")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" avro")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("exec-memory-avro.sinks.avro-sink.hostname")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" hadoop000")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("exec-memory-avro.sinks.avro-sink.port")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" 44444")]),a._v("\n \n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("exec-memory-avro.channels.memory-channel.type")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" memory")]),a._v("\n \n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("exec-memory-avro.sources.exec-source.channels")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" memory-channel")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("exec-memory-avro.sinks.avro-sink.channel")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" memory-channel")]),a._v("\n")])])]),t("p",[a._v("第二个Agent配置 -> avro-memory-kafka.conf：")]),a._v(" "),t("div",{staticClass:"language-ini extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("avro-memory-kafka.sources")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" avro-source")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("avro-memory-kafka.sinks")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" kafka-sink")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("avro-memory-kafka.channels")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" memory-channel")]),a._v("\n \n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("avro-memory-kafka.sources.avro-source.type")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" avro")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("avro-memory-kafka.sources.avro-source.bind")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" hadoop000")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("avro-memory-kafka.sources.avro-source.port")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" 44444")]),a._v("\n \n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("avro-memory-kafka.sinks.kafka-sink.type")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" org.apache.flume.sink.kafka.KafkaSink")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("avro-memory-kafka.sinks.kafka-sink.brokerList")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" hadoop000:9092")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("avro-memory-kafka.sinks.kafka-sink.topic")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" hello_topic")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("avro-memory-kafka.sinks.kafka-sink.batchSize")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" 5")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("avro-memory-kafka.sinks.kafka-sink.requiredAcks")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v("1 ")]),a._v("\n \n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("avro-memory-kafka.channels.memory-channel.type")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" memory")]),a._v("\n \n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("avro-memory-kafka.sources.avro-source.channels")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" memory-channel")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("avro-memory-kafka.sinks.kafka-sink.channel")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" memory-channel")]),a._v("\n")])])]),t("h1",{attrs:{id:"_3-启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-启动"}},[a._v("#")]),a._v(" 3.启动")]),a._v(" "),t("p",[a._v("Zookeeper：")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("zkServer.sh start\n")])])]),t("p",[a._v("Kafka：")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("kafka-server-start.sh /home/hadoop/app/kafka_2.11-0.9.0.0/config/server.properties \n")])])]),t("p",[a._v("Flume-Agent2：")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("flume-ng agent "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n--name avro-memory-kafka "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n--conf "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$FLUME_HOME")]),a._v("/conf "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n--conf-file "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$FLUME_HOME")]),a._v("/conf/avro-memory-kafka.conf "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n-Dflume.root.logger"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("INFO,console\n")])])]),t("p",[a._v("Flume-Agent1：")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("flume-ng agent "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n--name exec-memory-avro "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n--conf "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$FLUME_HOME")]),a._v("/conf "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n--conf-file "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$FLUME_HOME")]),a._v("/conf/exec-memory-avro.conf "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n-Dflume.root.logger"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("INFO,console\n")])])]),t("p",[a._v("检查一下：")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("hadoop@hadoop000 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("$ jps -m\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("18371")]),a._v(" Application --name exec-memory-avro --conf-file /home/hadoop/app/apache-flume-1.6.0-cdh5.7.0-bin/conf/exec-memory-avro.conf\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("17546")]),a._v(" Application --name avro-memory-kafka --conf-file /home/hadoop/app/apache-flume-1.6.0-cdh5.7.0-bin/conf/avro-memory-kafka.conf\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("16619")]),a._v(" Kafka /home/hadoop/app/kafka_2.11-0.9.0.0/config/server.properties\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("16317")]),a._v(" QuorumPeerMain /home/hadoop/app/zookeeper-3.4.5-cdh5.7.0/bin/"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("/conf/zoo.cfg\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("19198")]),a._v(" Jps -m\n")])])]),t("p",[a._v("启动Kafka Consumer：")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("kafka-console-consumer.sh --zookeeper hadoop000:2181 --topic hello_topic\n")])])]),t("p",[a._v("测试：")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" Its a "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("test")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">>")]),a._v(" data.log\n")])])]),t("img",{staticClass:"zoom-custom-imgs",attrs:{src:a.$withBase("/assets/img/dc/kafka/intro-2.png"),alt:"wxmp"}}),a._v(" "),t("h2",{attrs:{id:"参考文章"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[a._v("#")]),a._v(" 参考文章")]),a._v(" "),t("ul",[t("li",[a._v("https://blog.csdn.net/qq_36329973/article/details/104629923")])])])}),[],!1,null,null,null);s.default=n.exports}}]);