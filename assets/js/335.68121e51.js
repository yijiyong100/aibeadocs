(window.webpackJsonp=window.webpackJsonp||[]).push([[335],{850:function(a,t,s){"use strict";s.r(t);var e=s(53),n=Object(e.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),s("p",[a._v("本文主要是介绍 Kafka-数据采集案例原理 。")])]),a._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#flume-kafka整合采集数据案例"}},[a._v("flume+kafka整合采集数据案例")])]),s("li",[s("a",{attrs:{href:"#一、flume简介"}},[a._v("一、flume简介")]),s("ul",[s("li",[s("a",{attrs:{href:"#_1-1-1-概述"}},[a._v("1.1.1 概述")])]),s("li",[s("a",{attrs:{href:"#_1-1-2-运行机制"}},[a._v("1.1.2 运行机制")])]),s("li",[s("a",{attrs:{href:"#_1-1-3-flume采集系统结构图"}},[a._v("1.1.3 Flume采集系统结构图")])])])]),s("li",[s("a",{attrs:{href:"#二、kafka简介"}},[a._v("二、kafka简介")])]),s("li",[s("a",{attrs:{href:"#_2-1-简介"}},[a._v("2.1 简介")])]),s("li",[s("a",{attrs:{href:"#_2-2-支持的语言"}},[a._v("2.2 支持的语言")])]),s("li",[s("a",{attrs:{href:"#_2-3、-apache-kafka-是一个分布式发布-订阅消息系统"}},[a._v("2.3、apache kafka是一个分布式发布-订阅消息系统")])]),s("li",[s("a",{attrs:{href:"#_2-4-其他的消息队列"}},[a._v("2.4 其他的消息队列")])]),s("li",[s("a",{attrs:{href:"#_2-5-kafka-的好处"}},[a._v("2.5 kafka的好处")])]),s("li",[s("a",{attrs:{href:"#三、数据采集案例"}},[a._v("三、数据采集案例")]),s("ul",[s("li",[s("a",{attrs:{href:"#_3-1-整体数据流程"}},[a._v("3.1 整体数据流程")])]),s("li",[s("a",{attrs:{href:"#_3-2-flume的采集配置文件"}},[a._v("3.2 flume的采集配置文件")])]),s("li",[s("a",{attrs:{href:"#_3-3-采集结果图"}},[a._v("3.3 采集结果图")])])])]),s("li",[s("a",{attrs:{href:"#参考文章"}},[a._v("参考文章")])])])]),s("p"),a._v(" "),s("h2",{attrs:{id:"flume-kafka整合采集数据案例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#flume-kafka整合采集数据案例"}},[a._v("#")]),a._v(" flume+kafka整合采集数据案例")]),a._v(" "),s("h2",{attrs:{id:"一、flume简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、flume简介"}},[a._v("#")]),a._v(" 一、flume简介")]),a._v(" "),s("h3",{attrs:{id:"_1-1-1-概述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-1-概述"}},[a._v("#")]),a._v(" 1.1.1 概述")]),a._v(" "),s("ul",[s("li",[s("ol",[s("li",[a._v("Flume是一个分布式、可靠、和高可用的海量日志采集、聚合和传输的系统。")])])]),a._v(" "),s("li",[s("ol",{attrs:{start:"2"}},[s("li",[a._v("Flume可以采集文件，socket数据包、文件、文件夹、kafka等各种形式源数据，又可以将采集到的数据(下沉sink)输出到HDFS、hbase、hive、kafka等众多外部存储系统中")])])]),a._v(" "),s("li",[s("ol",{attrs:{start:"3"}},[s("li",[a._v("一般的采集需求，通过对flume的简单配置即可实现")])])]),a._v(" "),s("li",[s("ol",{attrs:{start:"4"}},[s("li",[a._v("Flume针对特殊场景也具备良好的自定义扩展能力，")])])])]),a._v(" "),s("p",[a._v("因此，flume可以适用于大部分的日常数据采集场景")]),a._v(" "),s("h3",{attrs:{id:"_1-1-2-运行机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-2-运行机制"}},[a._v("#")]),a._v(" 1.1.2 运行机制")]),a._v(" "),s("ol",[s("li",[s("p",[a._v("Flume分布式系统中最核心的角色是agent，flume采集系统就是由一个个agent所连接起来形成")])]),a._v(" "),s("li",[s("p",[s("strong",[a._v("每一个agent相当于一个数据传递员")])]),a._v(" "),s("p",[s("strong",[a._v("内部有三个组件")]),a._v("：")]),a._v(" "),s("ol",[s("li",[s("ol",[s("li",[a._v("Source：采集组件，用于跟数据源对接，以获取数据")]),a._v(" "),s("li",[a._v("Sink：下沉组件，用于往下一级agent传递数据或者往最终存储系统传递数据")]),a._v(" "),s("li",[a._v("Channel：传输通道组件，用于从source将数据传递到sink")])])])])])]),a._v(" "),s("img",{staticClass:"zoom-custom-imgs",attrs:{src:a.$withBase("/assets/img/dc/kafka/prin-1.png"),alt:"wxmp"}}),a._v(" "),s("h3",{attrs:{id:"_1-1-3-flume采集系统结构图"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-3-flume采集系统结构图"}},[a._v("#")]),a._v(" 1.1.3 Flume采集系统结构图")]),a._v(" "),s("ol",[s("li",[a._v("简单结构")])]),a._v(" "),s("p",[a._v("单个agent采集数据")]),a._v(" "),s("img",{staticClass:"zoom-custom-imgs",attrs:{src:a.$withBase("/assets/img/dc/kafka/prin-2.png"),alt:"wxmp"}}),a._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[a._v("复杂结构")])]),a._v(" "),s("p",[a._v("多级agent之间串联")]),a._v(" "),s("img",{staticClass:"zoom-custom-imgs",attrs:{src:a.$withBase("/assets/img/dc/kafka/prin-3.png"),alt:"wxmp"}}),a._v(" "),s("h2",{attrs:{id:"二、kafka简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、kafka简介"}},[a._v("#")]),a._v(" 二、kafka简介")]),a._v(" "),s("h2",{attrs:{id:"_2-1-简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-简介"}},[a._v("#")]),a._v(" 2.1 简介")]),a._v(" "),s("p",[a._v("kafka是最初由linkedin公司开发的，使用scala语言编写，kafka是一个分布式，分区的，多副本的，多订阅者的日志系统（分布式MQ系统），可以用于搜索日志，监控日志，访问日志等。")]),a._v(" "),s("h2",{attrs:{id:"_2-2-支持的语言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-支持的语言"}},[a._v("#")]),a._v(" 2.2 支持的语言")]),a._v(" "),s("p",[a._v("kafka目前支持多种客户端的语言：java、python、c++、php等")]),a._v(" "),s("h2",{attrs:{id:"_2-3、apache-kafka是一个分布式发布-订阅消息系统"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-3、apache-kafka是一个分布式发布-订阅消息系统"}},[a._v("#")]),a._v(" 2.3、"),s("strong",[a._v("apache kafka")]),a._v("是一个分布式发布-订阅消息系统")]),a._v(" "),s("p",[a._v("apache kafka是一个分布式发布-订阅消息系统和一个强大的队列，可以处理大量的数据，并使能够将消息从一个端点传递到另一个端点，kafka适合离线和在线消息消费。kafka消息保留在磁盘上，并在集群内复制以防止数据丢失。kafka构建在zookeeper同步服务之上。它与apache和spark非常好的集成，应用于实时流式数据分析。")]),a._v(" "),s("h2",{attrs:{id:"_2-4-其他的消息队列"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-其他的消息队列"}},[a._v("#")]),a._v(" 2.4 其他的消息队列")]),a._v(" "),s("p",[a._v("RabbitMQ")]),a._v(" "),s("p",[a._v("Redis")]),a._v(" "),s("p",[a._v("ZeroMQ")]),a._v(" "),s("p",[a._v("ActiveMQ")]),a._v(" "),s("h2",{attrs:{id:"_2-5-kafka的好处"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-kafka的好处"}},[a._v("#")]),a._v(" 2.5 "),s("strong",[a._v("kafka")]),a._v("的好处")]),a._v(" "),s("p",[a._v("可靠性：分布式的，分区，复制和容错的。")]),a._v(" "),s("p",[a._v("可扩展性：kafka消息传递系统轻松缩放，无需停机。")]),a._v(" "),s("p",[a._v("耐用性：kafka使用分布式提交日志，这意味着消息会尽可能快速的保存在磁盘上，因此它是持久的。")]),a._v(" "),s("p",[a._v("性能：kafka对于发布和定于消息都具有高吞吐量。即使存储了许多TB的消息，他也爆出稳定的性能。")]),a._v(" "),s("p",[a._v("kafka非常快：保证零停机和零数据丢失。")]),a._v(" "),s("h2",{attrs:{id:"三、数据采集案例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、数据采集案例"}},[a._v("#")]),a._v(" 三、数据采集案例")]),a._v(" "),s("h3",{attrs:{id:"_3-1-整体数据流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-整体数据流程"}},[a._v("#")]),a._v(" 3.1 整体数据流程")]),a._v(" "),s("p",[a._v("使用flume监控源头文件夹下的文件，当有新的文件时，自动采集文件数据到kafka。")]),a._v(" "),s("h3",{attrs:{id:"_3-2-flume的采集配置文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-flume的采集配置文件"}},[a._v("#")]),a._v(" 3.2 flume的采集配置文件")]),a._v(" "),s("div",{staticClass:"language-ini extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ini"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#为我们的source channel  sink起名")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[a._v("a1.sources")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" r1")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[a._v("a1.channels")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" c1")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[a._v("a1.sinks")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" k1")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#指定我们的source收集到的数据发送到哪个管道")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[a._v("a1.sources.r1.channels")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" c1")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#指定我们的source数据收集策略")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[a._v("a1.sources.r1.type")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" spooldir")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[a._v("a1.sources.r1.spoolDir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" /export/servers/flumedata")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[a._v("a1.sources.r1.deletePolicy")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" never")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[a._v("a1.sources.r1.fileSuffix")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" .COMPLETED")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[a._v("a1.sources.r1.ignorePattern")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" ^(.)*\\\\.tmp$")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[a._v("a1.sources.r1.inputCharset")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" GBK")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#指定我们的channel为memory,即表示所有的数据都装进memory当中")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[a._v("a1.channels.c1.type")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" memory")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#指定我们的sink为kafka  sink，并指定我们的sink从哪个channel当中读取数据")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[a._v("a1.sinks.k1.channel")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" c1")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[a._v("a1.sinks.k1.type")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" org.apache.flume.sink.kafka.KafkaSink")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[a._v("a1.sinks.k1.kafka.topic")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" test")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[a._v("a1.sinks.k1.kafka.bootstrap.servers")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" node01:9092,node02:9092,node03:9092")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[a._v("a1.sinks.k1.kafka.flumeBatchSize")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" 20")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[a._v("a1.sinks.k1.kafka.producer.acks")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" 1")]),a._v("\n")])])]),s("h3",{attrs:{id:"_3-3-采集结果图"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-采集结果图"}},[a._v("#")]),a._v(" 3.3 采集结果图")]),a._v(" "),s("p",[a._v("采集完成后，源头文件会自动加上completed后缀")]),a._v(" "),s("img",{staticClass:"zoom-custom-imgs",attrs:{src:a.$withBase("/assets/img/dc/kafka/prin-4.png"),alt:"wxmp"}}),a._v(" "),s("p",[a._v("flume日志图")]),a._v(" "),s("img",{staticClass:"zoom-custom-imgs",attrs:{src:a.$withBase("/assets/img/dc/kafka/prin-5.png"),alt:"wxmp"}}),a._v(" "),s("p",[a._v("kafka消费端接收到的数据")]),a._v(" "),s("img",{staticClass:"zoom-custom-imgs",attrs:{src:a.$withBase("/assets/img/dc/kafka/prin-6.png"),alt:"wxmp"}}),a._v(" "),s("p",[a._v("四、总结")]),a._v(" "),s("p",[a._v("主要核心就是flume采集配置文件的开发，配置好source.channel.sink三个组件。")]),a._v(" "),s("h2",{attrs:{id:"参考文章"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[a._v("#")]),a._v(" 参考文章")]),a._v(" "),s("ul",[s("li",[a._v("https://blog.csdn.net/fa124607857/article/details/107085371/")])])])}),[],!1,null,null,null);t.default=n.exports}}]);