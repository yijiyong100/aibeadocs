(window.webpackJsonp=window.webpackJsonp||[]).push([[417],{932:function(a,t,s){"use strict";s.r(t);var n=s(53),r=Object(n.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),s("p",[a._v("本文主要是介绍 Spark-综合精华总结(一) 。")])]),a._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#spark基础知识总结"}},[a._v("spark基础知识总结")])]),s("li",[s("a",{attrs:{href:"#_1-概述"}},[a._v("1. 概述")]),s("ul",[s("li",[s("a",{attrs:{href:"#_1-1-简介"}},[a._v("1.1. 简介")])]),s("li",[s("a",{attrs:{href:"#_1-2-mapreduce和spark"}},[a._v("1.2. Mapreduce和Spark")])]),s("li",[s("a",{attrs:{href:"#_1-3-hadoop为什么慢"}},[a._v("1.3. Hadoop为什么慢")])]),s("li",[s("a",{attrs:{href:"#_1-4-mapreduce和spark对比"}},[a._v("1.4. mapreduce和spark对比")])]),s("li",[s("a",{attrs:{href:"#_1-5-spark的其他特性"}},[a._v("1.5. spark的其他特性")])])])]),s("li",[s("a",{attrs:{href:"#_2-spark生态系统"}},[a._v("2. Spark生态系统")]),s("ul",[s("li",[s("a",{attrs:{href:"#_2-1-spark-streaming"}},[a._v("2.1. Spark Streaming:")])]),s("li",[s("a",{attrs:{href:"#_2-2-spark-sql"}},[a._v("2.2. Spark SQL:")])]),s("li",[s("a",{attrs:{href:"#_2-3-spark-mllib"}},[a._v("2.3. Spark MLlib:")])]),s("li",[s("a",{attrs:{href:"#_2-4-spark-graphx"}},[a._v("2.4. Spark GraphX:")])]),s("li",[s("a",{attrs:{href:"#_2-5-bdas"}},[a._v("2.5. BDAS")])])])]),s("li",[s("a",{attrs:{href:"#_3-spark体系架构"}},[a._v("3. Spark体系架构")]),s("ul",[s("li",[s("a",{attrs:{href:"#_3-1-资源管理"}},[a._v("3.1. 资源管理：")])]),s("li",[s("a",{attrs:{href:"#_3-2-spark-api"}},[a._v("3.2. Spark API：")])]),s("li",[s("a",{attrs:{href:"#_3-3-数据存储"}},[a._v("3.3. 数据存储：")])])])]),s("li",[s("a",{attrs:{href:"#_4-rdd"}},[a._v("4.RDD")]),s("ul",[s("li",[s("a",{attrs:{href:"#_4-1-rdd-弹性分布式数据集-核心"}},[a._v("4.1. RDD----弹性分布式数据集：核心")])]),s("li",[s("a",{attrs:{href:"#_4-2-rdd创建的三种方式"}},[a._v("4.2. RDD创建的三种方式")])]),s("li",[s("a",{attrs:{href:"#_4-3-rdd-弹性分布式数据集"}},[a._v("4.3. RDD----弹性分布式数据集")])]),s("li",[s("a",{attrs:{href:"#_4-4-rdd操作流程示意"}},[a._v("4.4. RDD操作流程示意")])]),s("li",[s("a",{attrs:{href:"#_4-5-rdd的转换与操作"}},[a._v("4.5. RDD的转换与操作")])]),s("li",[s("a",{attrs:{href:"#_4-6-rdd-源码中的注释"}},[a._v("4.6. RDD ---- 源码中的注释")])]),s("li",[s("a",{attrs:{href:"#_4-7-安装spark集群-standalone"}},[a._v("4.7. 安装spark集群（Standalone）")])]),s("li",[s("a",{attrs:{href:"#_4-8-spark交互式shell"}},[a._v("4.8. spark交互式shell")])])])]),s("li",[s("a",{attrs:{href:"#_5-spark命令"}},[a._v("5. spark命令")]),s("ul",[s("li",[s("a",{attrs:{href:"#_5-1-查看spark的文档常见操作"}},[a._v("5.1. 查看spark的文档常见操作")])]),s("li",[s("a",{attrs:{href:"#_5-2-spark-shell"}},[a._v("5.2. spark shell")])]),s("li",[s("a",{attrs:{href:"#_5-3-spark的演示"}},[a._v("5.3. spark的演示")])])])]),s("li",[s("a",{attrs:{href:"#_6-spark-api-wordcount"}},[a._v("6. spark api wordcount")]),s("ul",[s("li",[s("a",{attrs:{href:"#_6-1-创建项目"}},[a._v("6.1. 创建项目")])]),s("li",[s("a",{attrs:{href:"#_6-2-导包"}},[a._v("6.2. 导包")])]),s("li",[s("a",{attrs:{href:"#_6-3-写wordcount"}},[a._v("6.3. 写wordcount")])]),s("li",[s("a",{attrs:{href:"#_6-4-打jar包"}},[a._v("6.4. 打jar包")])]),s("li",[s("a",{attrs:{href:"#_6-5-提交"}},[a._v("6.5. 提交")])])])]),s("li",[s("a",{attrs:{href:"#_7-spark源码分析"}},[a._v("7. spark源码分析")])]),s("li",[s("a",{attrs:{href:"#参考文章"}},[a._v("参考文章")])])])]),s("p"),a._v(" "),s("h2",{attrs:{id:"spark基础知识总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#spark基础知识总结"}},[a._v("#")]),a._v(" spark基础知识总结")]),a._v(" "),s("h2",{attrs:{id:"_1-概述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-概述"}},[a._v("#")]),a._v(" 1. 概述")]),a._v(" "),s("h3",{attrs:{id:"_1-1-简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-简介"}},[a._v("#")]),a._v(" 1.1. 简介")]),a._v(" "),s("p",[a._v("Apache Spark是一个围绕速度、易用性和复杂分析构建的大数据处理框架。最初在2009年由加州大学伯克利分校的AMPLab开发，并于2010年成为Apache的开源项目之一。")]),a._v(" "),s("p",[a._v("Spark为我们提供了一个全面、统一的框架用于管理各种有着不同性质（文本数据、图表数据等）的数据集和数据源（批量数据或实时的流数据）的大数据处理的需求。")]),a._v(" "),s("p",[a._v("利用内存数据存储和接近实时的处理能力，Spark比其他的大数据处理技术的性能要快很多倍。")]),a._v(" "),s("h3",{attrs:{id:"_1-2-mapreduce和spark"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-mapreduce和spark"}},[a._v("#")]),a._v(" 1.2. Mapreduce和Spark")]),a._v(" "),s("p",[a._v("MapReduce是一路计算的优秀解决方案，不过对于需要多路计算和算法的用例来说，并非十分高效。")]),a._v(" "),s("p",[a._v("如果想要完成比较复杂的工作，就必须将一系列的MapReduce作业串联起来然后顺序执行这些作业。每一个作业都是高时延的，而且只有在前一个作业完成之后下一个作业才能开始启动。")]),a._v(" "),s("p",[a._v("在下一步开始之前，上一步的作业输出数据必须要存储到分布式文件系统中。因此，复制和磁盘存储会导致这种方式速度变慢。")]),a._v(" "),s("p",[a._v("而Spark则允许程序开发者使用有向无环图（DAG）开发复杂的多步数据管道。而且还支持跨作业的内存数据共享，以便不同的作业可以共同处理同一个数据。")]),a._v(" "),s("p",[a._v("Spark将中间结果保存在内存中而不是将其写入磁盘，当需要多次处理同一数据集时，这一点特别实用。")]),a._v(" "),s("p",[a._v("Spark会尝试在内存中存储尽可能多的数据然后将其写入磁盘。它可以将某个数据集的一部分存入内存而剩余部分存入磁盘。从而Spark可以用于处理大于集群内存容量总和的数据集。")]),a._v(" "),s("h3",{attrs:{id:"_1-3-hadoop为什么慢"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-hadoop为什么慢"}},[a._v("#")]),a._v(" 1.3. Hadoop为什么慢")]),a._v(" "),s("img",{staticClass:"zoom-custom-imgs",attrs:{src:a.$withBase("/assets/img/dp/spark/sum1-1.png"),alt:"wxmp"}}),a._v(" "),s("p",[a._v("spark_base_1_3.png")]),a._v(" "),s("p",[a._v("Spark因为其处理数据的方式不一样，会比MapReduce快上很多。MapReduce是分步对数据进行处理的: ”从集群中读取数据，进行一次处理，将结果写到集群，从集群中读取更新后的数据，进行下一次的处理，将结果写到集群，等等…“ Booz Allen Hamilton的数据科学家Kirk Borne如此解析。")]),a._v(" "),s("p",[a._v("反观Spark，它会在内存中以接近“实时”的时间完成所有的数据分析：“从集群中读取数据，完成所有必须的分析处理，将结果写回集群，完成，” Born说道。Spark的批处理速度比MapReduce快近10倍，内存中的数据分析速度则快近100倍。")]),a._v(" "),s("p",[a._v("如果需要处理的数据和结果需求大部分情况下是静态的，且你也有耐心等待批处理的完成的话，MapReduce的处理方式也是完全可以接受的。")]),a._v(" "),s("p",[a._v("但如果你需要对流数据进行分析，比如那些来自于工厂的传感器收集回来的数据，又或者说你的应用是需要多重数据处理的，那么你也许更应该使用Spark进行处理。")]),a._v(" "),s("p",[a._v("大部分机器学习算法都是需要多重数据处理的。此外，通常会用到Spark的应用场景有以下方面：实时的市场活动，在线产品推荐，网络安全分析，机器日记监控等。")]),a._v(" "),s("h3",{attrs:{id:"_1-4-mapreduce和spark对比"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-mapreduce和spark对比"}},[a._v("#")]),a._v(" 1.4. mapreduce和spark对比")]),a._v(" "),s("img",{staticClass:"zoom-custom-imgs",attrs:{src:a.$withBase("/assets/img/dp/spark/sum1-2.png"),alt:"wxmp"}}),a._v(" "),s("p",[a._v("spark_base_1_4_1.png")]),a._v(" "),s("img",{staticClass:"zoom-custom-imgs",attrs:{src:a.$withBase("/assets/img/dp/spark/sum1-3.png"),alt:"wxmp"}}),a._v(" "),s("p",[a._v("spark_base_1_4_2.png")]),a._v(" "),s("h3",{attrs:{id:"_1-5-spark的其他特性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-spark的其他特性"}},[a._v("#")]),a._v(" 1.5. spark的其他特性")]),a._v(" "),s("ul",[s("li",[a._v("1、支持比Map和Reduce更多的函数。")]),a._v(" "),s("li",[a._v("2、可以通过延迟计算帮助优化整体数据处理流程。")]),a._v(" "),s("li",[a._v("3、提供简明、一致的Scala，Java和Python API。")]),a._v(" "),s("li",[a._v("4、提供交互式Scala和Python Shell。帮助进行原型验证和逻辑测试\n（目前暂不支持Java）")])]),a._v(" "),s("h2",{attrs:{id:"_2-spark生态系统"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-spark生态系统"}},[a._v("#")]),a._v(" 2. Spark生态系统")]),a._v(" "),s("blockquote",[s("p",[a._v("除了Spark核心API之外，Spark生态系统中还包括其他附加库，可以在大数据分析和机器学习领域提供更多的能力。")])]),a._v(" "),s("img",{staticClass:"zoom-custom-imgs",attrs:{src:a.$withBase("/assets/img/dp/spark/sum1-4.png"),alt:"wxmp"}}),a._v(" "),s("p",[a._v("spark_base_2.png")]),a._v(" "),s("h3",{attrs:{id:"_2-1-spark-streaming"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-spark-streaming"}},[a._v("#")]),a._v(" 2.1. Spark Streaming:")]),a._v(" "),s("p",[a._v("Spark Streaming基于微批量方式的计算和处理，可以用于处理实时的流数据。它使用DStream，简单来说就是一个弹性分布式数据集（RDD）系列，处理实时数据。")]),a._v(" "),s("h3",{attrs:{id:"_2-2-spark-sql"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-spark-sql"}},[a._v("#")]),a._v(" 2.2. Spark SQL:")]),a._v(" "),s("p",[a._v("Spark SQL可以通过JDBC API将Spark数据集暴露出去，而且还可以用传统的BI和可视化工具在Spark数据上执行类似SQL的查询。用户还可以用Spark SQL对不同格式的数据（如JSON，Parquet以及数据库等）执行ETL，将其转化，然后暴露给特定的查询。")]),a._v(" "),s("h3",{attrs:{id:"_2-3-spark-mllib"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-spark-mllib"}},[a._v("#")]),a._v(" 2.3. Spark MLlib:")]),a._v(" "),s("p",[a._v("MLlib是一个可扩展的Spark机器学习库，由通用的学习算法和工具组成，包括二元分类、线性回归、聚类、协同过滤、梯度下降以及底层优化原语。")]),a._v(" "),s("h3",{attrs:{id:"_2-4-spark-graphx"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-spark-graphx"}},[a._v("#")]),a._v(" 2.4. Spark GraphX:")]),a._v(" "),s("p",[a._v("GraphX是用于图计算和并行图计算的新的（alpha）Spark API。通过引入弹性分布式属性图（Resilient Distributed Property Graph），一种顶点和边都带有属性的有向多重图，扩展了Spark RDD。")]),a._v(" "),s("p",[a._v("Tachyon是一个以内存为中心的分布式文件系统，能够提供内存级别速度的跨集群框架（如Spark和MapReduce）的可信文件共享。它将工作集文件缓存在内存中，从而避免到磁盘中加载需要经常读取的数据集。通过这一机制，不同的作业/查询和框架可以以内存级的速度访问缓存的文件。")]),a._v(" "),s("p",[a._v("BlinkDB是一个近似查询引擎，用于在海量数据上执行交互式SQL查询。BlinkDB可以通过牺牲数据精度来提升查询响应时间。通过在数据样本上执行查询并展示包含有意义的错误线注解的结果，操作大数据集合。")]),a._v(" "),s("h3",{attrs:{id:"_2-5-bdas"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-bdas"}},[a._v("#")]),a._v(" 2.5. BDAS")]),a._v(" "),s("img",{staticClass:"zoom-custom-imgs",attrs:{src:a.$withBase("/assets/img/dp/spark/sum1-5.png"),alt:"wxmp"}}),a._v(" "),s("p",[a._v("spark_base_2_5.png")]),a._v(" "),s("h2",{attrs:{id:"_3-spark体系架构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-spark体系架构"}},[a._v("#")]),a._v(" 3. Spark体系架构")]),a._v(" "),s("p",[a._v("Spark体系架构包括如下三个主要组件：")]),a._v(" "),s("ul",[s("li",[a._v("数据存储")]),a._v(" "),s("li",[a._v("API")]),a._v(" "),s("li",[a._v("资源管理框架")])]),a._v(" "),s("h3",{attrs:{id:"_3-1-资源管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-资源管理"}},[a._v("#")]),a._v(" 3.1. 资源管理：")]),a._v(" "),s("p",[a._v("Spark既可以部署在一个单独的服务器集群上（Standalone）")]),a._v(" "),s("p",[a._v("也可以部署在像Mesos或YARN这样的分布式计算框架之上。")]),a._v(" "),s("h3",{attrs:{id:"_3-2-spark-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-spark-api"}},[a._v("#")]),a._v(" 3.2. Spark API：")]),a._v(" "),s("p",[a._v("应用开发者可以用标准的API接口创建基于Spark的应用")]),a._v(" "),s("p",[a._v("Spark提供三种程序设计语言的API：")]),a._v(" "),s("ul",[s("li",[a._v("Scala")]),a._v(" "),s("li",[a._v("Java")]),a._v(" "),s("li",[a._v("Python")])]),a._v(" "),s("h3",{attrs:{id:"_3-3-数据存储"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-数据存储"}},[a._v("#")]),a._v(" 3.3. 数据存储：")]),a._v(" "),s("p",[a._v("Spark用HDFS文件系统存储数据。它可用于存储任何兼容于Hadoop的数据源，包括HDFS，HBase，Cassandra等。")]),a._v(" "),s("p",[a._v("Spark在对数据的处理过程中，会将数据封装成RDD数据结构")]),a._v(" "),s("h2",{attrs:{id:"_4-rdd"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-rdd"}},[a._v("#")]),a._v(" 4.RDD")]),a._v(" "),s("ul",[s("li",[a._v("RDD(Resilient Distributed Datasets)，弹性分布式数据集， 是分布式内存的一个抽象概念")]),a._v(" "),s("li",[a._v("RDD作为数据结构，本质上是一个只读的分区记录集合。一个RDD可以包含多个分区，每个分区就是一个dataset片段")]),a._v(" "),s("li",[a._v("RDD并不保存真正的数据，仅保存元数据信息")]),a._v(" "),s("li",[a._v("RDD之间可以存在依赖关系")])]),a._v(" "),s("h3",{attrs:{id:"_4-1-rdd-弹性分布式数据集-核心"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-rdd-弹性分布式数据集-核心"}},[a._v("#")]),a._v(" 4.1. RDD----弹性分布式数据集：核心")]),a._v(" "),s("ul",[s("li",[a._v("RDD是Spark框架中的核心概念。")]),a._v(" "),s("li",[a._v("可以将RDD视作数据库中的一张表。其中可以保存任何类型的数据，可以通过API来处理RDD及RDD中的数据")]),a._v(" "),s("li",[a._v("类似于Mapreduce，RDD也有分区的概念")]),a._v(" "),s("li",[a._v("RDD是不可变的，可以用变换（Transformation）操作RDD，但是这个变换所返回的是一个全新的RDD，而原有的RDD仍然保持不变")])]),a._v(" "),s("h3",{attrs:{id:"_4-2-rdd创建的三种方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-rdd创建的三种方式"}},[a._v("#")]),a._v(" 4.2. RDD创建的三种方式")]),a._v(" "),s("ul",[s("li",[a._v("集合并行化")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("val arr "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Array")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nval rdd1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("parallelize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//2代表分区数量")]),a._v("\n")])])]),s("ul",[s("li",[a._v("从外部文件系统")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("分布式文件系统：如hdfs文件系统，S3"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v("\nval rdd2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("textFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"hdfs://node1:9000/words.txt"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("ul",[s("li",[a._v("从父RDD转换成新的子RDD")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("通过"),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Transformation")]),a._v("操作\n")])])]),s("h3",{attrs:{id:"_4-3-rdd-弹性分布式数据集"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-rdd-弹性分布式数据集"}},[a._v("#")]),a._v(" 4.3. RDD----弹性分布式数据集")]),a._v(" "),s("p",[a._v("RDD支持两种类型的操作：")]),a._v(" "),s("ul",[s("li",[a._v("变换（Transformation）\n变换：变换的返回值是一个新的RDD集合，而不是单个值。调用一个变换方法，不会有任何求值计算，它只获取一个RDD作为参数，然后返回一个新的RDD。Transformation是lazy模式，延迟执行")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("变换函数包括：map，filter，flatMap，groupByKey，reduceByKey，aggregateByKey，pipe和coalesce。\n")])])]),s("ul",[s("li",[a._v("行动（Action）\n行动：行动操作计算并返回一个新的值。当在一个RDD对象上调用行动函数时，会在这一时刻计算全部的数据处理查询并返回结果值。")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("行动操作包括：reduce，collect，count，first，take，countByKey以及foreach。\n")])])]),s("h3",{attrs:{id:"_4-4-rdd操作流程示意"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-rdd操作流程示意"}},[a._v("#")]),a._v(" 4.4. RDD操作流程示意")]),a._v(" "),s("img",{staticClass:"zoom-custom-imgs",attrs:{src:a.$withBase("/assets/img/dp/spark/sum1-6.png"),alt:"wxmp"}}),a._v(" "),s("p",[a._v("spark_base_4_4.png")]),a._v(" "),s("h3",{attrs:{id:"_4-5-rdd的转换与操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-rdd的转换与操作"}},[a._v("#")]),a._v(" 4.5. RDD的转换与操作")]),a._v(" "),s("img",{staticClass:"zoom-custom-imgs",attrs:{src:a.$withBase("/assets/img/dp/spark/sum1-7.png"),alt:"wxmp"}}),a._v(" "),s("p",[a._v("spark_base_4_5.png")]),a._v(" "),s("h3",{attrs:{id:"_4-6-rdd-源码中的注释"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-6-rdd-源码中的注释"}},[a._v("#")]),a._v(" 4.6. RDD ---- 源码中的注释")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("Internally, each RDD is characterized by five main properties:\nA list of partitions\nA "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("function")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" computing each "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("split")]),a._v("\nA list of dependencies on other RDDs\nOptionally, a Partitioner "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" key-value RDDs "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("e.g. to say that the RDD is hash-partitioned"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nOptionally, a list of preferred locations to compute each "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("split")]),a._v(" on "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("e.g. block locations "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" an HDFS "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("h3",{attrs:{id:"_4-7-安装spark集群-standalone"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-7-安装spark集群-standalone"}},[a._v("#")]),a._v(" 4.7. 安装spark集群（Standalone）")]),a._v(" "),s("p",[a._v("见文档")]),a._v(" "),s("h3",{attrs:{id:"_4-8-spark交互式shell"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-8-spark交互式shell"}},[a._v("#")]),a._v(" 4.8. spark交互式shell")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("spark提供一个scala-shell提供交互式操作\n启动spark-shell\nbin/spark-shell --master "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("spark://masterip:port"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("spark://masterip:port"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("（7077） 集群运行模式\nbin/spark-shell --master "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("local")]),a._v(" local运行模式\nwordcount示例\nscala"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("sc.textFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"[hdfs://namenode:port/data](hdfs://namenode:port/data)"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(".flatMap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("*.split"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"'),s("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[a._v("\\t")]),a._v('"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("))")]),a._v(".map"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("((")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("))")])]),a._v(".reduceByKey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(".collect\n")])])]),s("h2",{attrs:{id:"_5-spark命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-spark命令"}},[a._v("#")]),a._v(" 5. spark命令")]),a._v(" "),s("h3",{attrs:{id:"_5-1-查看spark的文档常见操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-查看spark的文档常见操作"}},[a._v("#")]),a._v(" 5.1. 查看spark的文档常见操作")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://spark.apache.org/docs/latest/rdd-programming-guide.html#transformations",target:"_blank",rel:"noopener noreferrer"}},[a._v("官网链接"),s("OutboundLink")],1)]),a._v(" "),s("ul",[s("li",[a._v("action操作")])]),a._v(" "),s("img",{staticClass:"zoom-custom-imgs",attrs:{src:a.$withBase("/assets/img/dp/spark/sum1-8.png"),alt:"wxmp"}}),a._v(" "),s("p",[a._v("spark_base_action.png")]),a._v(" "),s("ul",[s("li",[a._v("transformation操作")])]),a._v(" "),s("img",{staticClass:"zoom-custom-imgs",attrs:{src:a.$withBase("/assets/img/dp/spark/sum1-9.png"),alt:"wxmp"}}),a._v(" "),s("p",[a._v("spark_base_transformation.png")]),a._v(" "),s("ul",[s("li",[a._v("通过并行化scala集合创建RDD")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("val rdd1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("parallelize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Array")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("ul",[s("li",[a._v("查看该rdd的分区数量")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("rdd1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("partitions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("length\n")])])]),s("ul",[s("li",[a._v("更改分区，因为rdd是只读的，所以重新分区后会生成新的rdd来使用新的分区")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("val rdd2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("parallelize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Array")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("val rdd3 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" rdd2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("repartition")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("rdd3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("partitions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("length\n")])])]),s("ul",[s("li",[a._v("union求并集，注意类型要一致")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("val rdd6 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("parallelize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("List")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("val rdd7 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("parallelize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("List")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("val rdd8 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" rdd6"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("union")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("rdd7"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("rdd8"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("distinct"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sortBy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("collect\n")])])]),s("ul",[s("li",[a._v("intersection求交集")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("val rdd9 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" rdd6"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("intersection")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("rdd7"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("ul",[s("li",[a._v("join：keyvalue形式的值，key相同join出来")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("val rdd1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("parallelize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("List")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"tom"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jerry"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"kitty"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("val rdd2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("parallelize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("List")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jerry"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"tom"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"shuke"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("val rdd3 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" rdd1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("join")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("rdd2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("ul",[s("li",[a._v("groupByKey")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("val rdd3 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" rdd1 union rdd2rdd3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("groupByKeyrdd3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("groupByKey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("_1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("_2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("sum"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("ul",[s("li",[a._v("WordCount")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("textFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/root/words.txt"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("flatMap")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("split")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('" "')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("reduceByKey")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sortBy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("_2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("collectsc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("textFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/root/words.txt"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("flatMap")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("split")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('" "')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("groupByKey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("t"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("_1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("_2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("sum"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("collect\n")])])]),s("ul",[s("li",[a._v("cogroup：在自己的集合中分组，将分组的结果和其他集合中的结果取并集")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("val rdd1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("parallelize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("List")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"tom"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"tom"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jerry"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"kitty"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("val rdd2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("parallelize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("List")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jerry"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"tom"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"shuke"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("val rdd3 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" rdd1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cogroup")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("rdd2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("val rdd4 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" rdd3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("t"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("_1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("_2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("_1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("sum "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("_2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("_2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("sum"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("ul",[s("li",[a._v("cartesian笛卡尔积")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("val rdd1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("parallelize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("List")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"tom"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jerry"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nval rdd2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("parallelize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("List")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"tom"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"kitty"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"shuke"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nval rdd3 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" rdd1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cartesian")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("rdd2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("blockquote",[s("p",[a._v("spark action操作")])]),a._v(" "),s("ul",[s("li",[a._v("并行化创建rdd")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("val rdd1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("parallelize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("List")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("ul",[s("li",[a._v("collect：将rdd的数据计算，转换成scala的集合打印控制台，数据量小时用。")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("rdd1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("collect\n")])])]),s("ul",[s("li",[a._v("reduce：将元素进行reduce计算，直接显示结果")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("val rdd2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" rdd1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("reduce")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("ul",[s("li",[a._v("count：求个数")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("rdd1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("count\n")])])]),s("ul",[s("li",[a._v("top：取rdd中的最大的前两个")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("rdd1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("top")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("ul",[s("li",[a._v("take：取前几个")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("rdd1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("take")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("ul",[s("li",[a._v("first：取集合的第一个元素，相当于take（1）")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("rdd1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("first\n")])])]),s("ul",[s("li",[a._v("takeOrdered：取排序的前几个")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("rdd1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("takeOrdered")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("ul",[s("li",[a._v("将结果保存成文本文件")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("saveAsTextFile（“路径 or hdfs”）\n")])])]),s("h3",{attrs:{id:"_5-2-spark-shell"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-spark-shell"}},[a._v("#")]),a._v(" 5.2. spark shell")]),a._v(" "),s("ul",[s("li",[a._v("启动local模式的spark shell")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("/bin"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("spark"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("shell\n")])])]),s("ul",[s("li",[a._v("启动集群的spark shell")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("/bin"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("spark"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("shell "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),a._v("master spark"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("master1"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7077")]),a._v("\n")])])]),s("ul",[s("li",[a._v("启动集群的spark shell，配置参数")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("/bin"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("spark"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("shell "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),a._v("master spark"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("master1"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7077")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),a._v("executor"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("memory "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("512")]),a._v("m "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),a._v("total"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("executor"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("cores "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v("\n参数解释：\nspark"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("master1"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7077")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" 指定主机\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),a._v("executor"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("memory "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("512")]),a._v("m：每个work使用多大内存\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),a._v("total"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("executor"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("cores "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v("：指定work总共使用的核数\n")])])]),s("h3",{attrs:{id:"_5-3-spark的演示"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-spark的演示"}},[a._v("#")]),a._v(" 5.3. spark的演示")]),a._v(" "),s("ul",[s("li",[a._v("sc: spark context,启动spark会自动创建的对象，客户端和spark交互的桥梁")]),a._v(" "),s("li",[a._v("创建RDD：")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("val rdd1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("parallelize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Array")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("ul",[s("li",[a._v("查看RDD的分区:")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("rdd1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("partitions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("length\n")])])]),s("ul",[s("li",[a._v("转换：")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("rdd1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("filter")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("%")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("ul",[s("li",[a._v("执行：")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("res1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("collect\n")])])]),s("ul",[s("li",[a._v("map：")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("rdd1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("filter")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("%")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("collect\n")])])]),s("ul",[s("li",[a._v("sortby:")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("rdd1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("filter")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("%")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sortBy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("collect\n")])])]),s("h2",{attrs:{id:"_6-spark-api-wordcount"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-spark-api-wordcount"}},[a._v("#")]),a._v(" 6. spark api wordcount")]),a._v(" "),s("h3",{attrs:{id:"_6-1-创建项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-创建项目"}},[a._v("#")]),a._v(" 6.1. 创建项目")]),a._v(" "),s("h3",{attrs:{id:"_6-2-导包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-导包"}},[a._v("#")]),a._v(" 6.2. 导包")]),a._v(" "),s("h3",{attrs:{id:"_6-3-写wordcount"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-写wordcount"}},[a._v("#")]),a._v(" 6.3. 写wordcount")]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[a._v("org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("apache"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("spark"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("SparkConf")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[a._v("org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("apache"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("spark"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("SparkContext")]),a._v(" \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("WordCount")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\nobject "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("WordCount")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("  \n    def "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("args"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Array")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("    \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//创建配置，设置app的name     ")]),a._v("\n    val conf "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("SparkConf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("setAppName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"WordCount"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("     \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//创建sparkcontext，将conf传进来     ")]),a._v("\n    val sc "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("SparkContext")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("conf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("     \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//从文件中读取数据，做wordcount，写到文件系统")]),a._v("\n    sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("textFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("args")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("flatMap")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("split")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('" "')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("reduceByKey")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("saveAsTextFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("args")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("     \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//停止     ")]),a._v("\n    sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("stop")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("  \n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),s("h3",{attrs:{id:"_6-4-打jar包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-4-打jar包"}},[a._v("#")]),a._v(" 6.4. 打jar包")]),a._v(" "),s("p",[a._v("使用maven打包")]),a._v(" "),s("h3",{attrs:{id:"_6-5-提交"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-提交"}},[a._v("#")]),a._v(" 6.5. 提交")]),a._v(" "),s("p",[a._v("注意提交的时候，涉及到ip的地方尽量用域名，否则报错")]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("spark"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("submit "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("WordCount")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),a._v("master spark"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("master1"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7077")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),a._v("executor"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("memory "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("512")]),a._v("m "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),a._v("total"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("executor"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("cores "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("home"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("hadoop"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("wordcount"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("jar hdfs"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("master1ha"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("9000")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("core"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("site"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("xml hdfs"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("master1ha"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("9000")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("out1\n")])])]),s("h2",{attrs:{id:"_7-spark源码分析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-spark源码分析"}},[a._v("#")]),a._v(" 7. spark源码分析")]),a._v(" "),s("p",[a._v("待更新")]),a._v(" "),s("h2",{attrs:{id:"参考文章"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[a._v("#")]),a._v(" 参考文章")]),a._v(" "),s("ul",[s("li",[a._v("https://www.jianshu.com/p/8e4981f231b2")])])])}),[],!1,null,null,null);t.default=r.exports}}]);