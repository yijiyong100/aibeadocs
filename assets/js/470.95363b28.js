(window.webpackJsonp=window.webpackJsonp||[]).push([[470],{985:function(a,t,s){"use strict";s.r(t);var r=s(53),n=Object(r.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),s("p",[a._v("本文主要是介绍 Hive-介绍和安装 。")])]),a._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#ambari介绍及安装"}},[a._v("ambari介绍及安装")])]),s("li",[s("a",{attrs:{href:"#ambari简介"}},[a._v("Ambari简介")]),s("ul",[s("li",[s("a",{attrs:{href:"#ambari概述"}},[a._v("Ambari概述")])])])]),s("li",[s("a",{attrs:{href:"#ambari体系结构"}},[a._v("Ambari体系结构")])]),s("li",[s("a",{attrs:{href:"#ambari安装"}},[a._v("Ambari安装")])]),s("li",[s("a",{attrs:{href:"#安装准备阶段"}},[a._v("安装准备阶段：")]),s("ul",[s("li",[s("a",{attrs:{href:"#hdp版本兼容性"}},[a._v("HDP版本兼容性")])]),s("li",[s("a",{attrs:{href:"#系统初始化"}},[a._v("系统初始化")])]),s("li",[s("a",{attrs:{href:"#关闭防火墙和selinux"}},[a._v("关闭防火墙和selinux")])])])]),s("li",[s("a",{attrs:{href:"#安装"}},[a._v("安装")]),s("ul",[s("li",[s("a",{attrs:{href:"#在线安装"}},[a._v("在线安装")])]),s("li",[s("a",{attrs:{href:"#离线安装"}},[a._v("离线安装")])]),s("li",[s("a",{attrs:{href:"#安装ambari-server"}},[a._v("安装Ambari-server")])])])]),s("li",[s("a",{attrs:{href:"#安装数据库"}},[a._v("安装数据库")])]),s("li",[s("a",{attrs:{href:"#程序安装目录"}},[a._v("程序安装目录")]),s("ul",[s("li",[s("a",{attrs:{href:"#删除服务"}},[a._v("删除服务")])])])]),s("li",[s("a",{attrs:{href:"#ambari安装默认用户和用户组"}},[a._v("ambari安装默认用户和用户组")])]),s("li",[s("a",{attrs:{href:"#常见问题"}},[a._v("常见问题")]),s("ul",[s("li",[s("a",{attrs:{href:"#参考文章"}},[a._v("参考文章")])])])])])]),s("p"),a._v(" "),s("h2",{attrs:{id:"ambari介绍及安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ambari介绍及安装"}},[a._v("#")]),a._v(" ambari介绍及安装")]),a._v(" "),s("h2",{attrs:{id:"ambari简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ambari简介"}},[a._v("#")]),a._v(" Ambari简介")]),a._v(" "),s("h3",{attrs:{id:"ambari概述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ambari概述"}},[a._v("#")]),a._v(" Ambari概述")]),a._v(" "),s("p",[a._v("Apache Ambari是一种基于Web的工具，支持Apache Hadoop集群的创建、管理和监控。Ambari已支持大多数Hadoop组件，包括HDFS、MapReduce、Hive、Pig、 Hbase、Zookeeper、Sqoop和Hcatalog等；除此之外，Ambari还支持Spark、Storm等计算框架及资源调度平台YARN。")]),a._v(" "),s("p",[a._v("Apache Ambari 从集群节点和服务收集大量信息，并把它们表现为容易使用的，集中化的接口：Ambari Web.")]),a._v(" "),s("p",[a._v("Ambari Web显示诸如服务特定的摘要、图表以及警报信息。可通过Ambari Web对Hadoop集群进行创建、管理、监视、添加主机、更新服务配置等；也可以利用Ambari Web执行集群管理任务，例如启用 Kerberos 安全以及执行Stack升级。任何用户都可以查看Ambari Web特性。拥有administrator-level 角色的用户可以访问比 operator-level 或 view-only 的用户能访问的更多选项。例如，Ambari administrator 可以管理集群安全，一个 operator 用户可以监控集群，而 view-only 用户只能访问系统管理员授予他的必要的权限。")]),a._v(" "),s("h2",{attrs:{id:"ambari体系结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ambari体系结构"}},[a._v("#")]),a._v(" Ambari体系结构")]),a._v(" "),s("p",[a._v("Ambari 自身也是一个分布式架构的软件，主要由两部分组成：Ambari Server 和 Ambari Agent。简单来说，用户通过Ambari Server通知 Ambari Agent 安装对应的软件；Agent 会定时地发送各个机器每个软件模块的状态给 Ambari Server，最终这些状态信息会呈现在 Ambari 的 GUI，方便用户了解到集群的各种状态，并进行相应的维护。")]),a._v(" "),s("p",[a._v("Ambari Server 从整个集群上收集信息。每个主机上都有 Ambari Agent, Ambari Server 通过 Ambari Agent 控制每部主机。")]),a._v(" "),s("h2",{attrs:{id:"ambari安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ambari安装"}},[a._v("#")]),a._v(" Ambari安装")]),a._v(" "),s("p",[s("a",{attrs:{href:"http://doc.ailinux.net/docs/data/data-1ardi0l817b5q%5B%5B1%5D%5D%5B1%5D",target:"_blank",rel:"noopener noreferrer"}},[a._v("http://doc.ailinux.net/docs/data/data-1ardi0l817b5q"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("#Ambari操作指南\nhttps://docs.hortonworks.com/HDPDocuments/Ambari-2.6.1.5/bk_ambari-operations/content/ch_Overview_hdp-ambari-user-guide.html")]),a._v(" "),s("h2",{attrs:{id:"安装准备阶段"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装准备阶段"}},[a._v("#")]),a._v(" 安装准备阶段：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("本文介绍ambari安装及常用大数据组件安装配置等\n")])])]),s("h3",{attrs:{id:"hdp版本兼容性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hdp版本兼容性"}},[a._v("#")]),a._v(" HDP版本兼容性")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("CentOS "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7")]),a._v("\nPython "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2.7")]),a._v(".x\nJDK1.8+\nMariadb "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5.5")]),a._v("\nAmbari2.6.1.5 \nHDP "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2.6")]),a._v(".4\n")])])]),s("p",[a._v("查看一下地址获取软件版本兼容性支持\nhttps://supportmatrix.hortonworks.com/\n由于严格依赖版本，所以要先确定安装的版本。")]),a._v(" "),s("h3",{attrs:{id:"系统初始化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#系统初始化"}},[a._v("#")]),a._v(" 系统初始化")]),a._v(" "),s("h4",{attrs:{id:"更新yum源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#更新yum源"}},[a._v("#")]),a._v(" 更新yum源")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("yum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" -y "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo\nyum clean all\nyum makecache\n")])])]),s("h4",{attrs:{id:"修改主机名"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#修改主机名"}},[a._v("#")]),a._v(" 修改主机名")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" hostnamectl set-hostname test-bg-xx\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("hostname")]),a._v(" test-bg-xx\n")])])]),s("h4",{attrs:{id:"修改时区"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#修改时区"}},[a._v("#")]),a._v(" 修改时区：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n")])])]),s("h4",{attrs:{id:"同步集群时间"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#同步集群时间"}},[a._v("#")]),a._v(" 同步集群时间")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("yum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" –y ntp\nntpdate -u cn.pool.ntp.org\n或：\nntpdate time1.aliyun.com\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#### 硬件时间和系统时间同步:")]),a._v("\nclock -w\n配置自动同步:/etc/crontab写入 \n*/1 * * * * root ntpdate -u cn.pool.ntp.org "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">>")]),a._v(" /dev/null "),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[a._v("2")]),a._v(">")]),s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[a._v("&1")]),a._v("\n")])])]),s("h3",{attrs:{id:"关闭防火墙和selinux"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#关闭防火墙和selinux"}},[a._v("#")]),a._v(" 关闭防火墙和selinux")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#关闭防火墙")]),a._v("\nsystemctl stop firewalld\nsystemctl disable firewalld\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#关闭selinux")]),a._v("\n修改配置 \n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sed")]),a._v(" -i "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'s#SELINUX=enforcing#SELINUX=disabled#g'")]),a._v(" /etc/sysconfig/selinux\n临时关闭\nsetenforce "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("\n")])])]),s("h4",{attrs:{id:"配置免密钥登录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置免密钥登录"}},[a._v("#")]),a._v(" 配置免密钥登录")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("为了让Ambari服务器在所有集群主机上自动安装Ambari代理，您必须在Ambari服务器主机和集群中的所有其他主机之间设置无密码SSH连接。Ambari服务器主机使用SSH公钥认证来远程访问和安装Ambari代理\nssh-keygen -t rsa\nssh-copy-id -i ~/.ssh/id_rsa.pub root@node1\nssh-copy-id -i ~/.ssh/id_rsa.pub root@node2\nssh-copy-id -i ~/.ssh/id_rsa.pub root@node3\n注意：您可以选择在每个集群主机上手动安装Ambari代理。在这种情况下，您不需要生成和分发SSH密钥\n可以使用非root SSH帐户，如果该帐户可以执行sudo而不输入密码\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#如果ssh端口不是默认，可以在.ssh下创建config文件,修改文件权限 配置如下:")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("touch")]),a._v(" config\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("600")]),a._v(" config\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("jt_ops@test-bg-m01 .ssh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" config \nHost test-bg-m01\nHostName test-bg-m01\nUser jt_ops\nPort xx\n\nHost test-bg-w01\nHostName test-bg-w01\nUser jt_ops\nPort xx\n也可以修改/etc/sshd/ssh_config配置文件中的端口\n")])])]),s("h4",{attrs:{id:"系统初始化参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#系统初始化参数"}},[a._v("#")]),a._v(" 系统初始化参数")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">>")]),a._v(" /etc/sysctl.conf "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("EOF\nfs.file-max=1000000\nnet.ipv4.tcp_max_tw_buckets = 6000\nnet.ipv4.tcp_sack = 1\nnet.ipv4.tcp_window_scaling = 1\nnet.ipv4.tcp_rmem = 4096 87380 4194304\nnet.ipv4.tcp_wmem = 4096 16384 4194304\nnet.ipv4.tcp_max_syn_backlog = 16384\nnet.core.netdev_max_backlog = 32768\nnet.core.somaxconn = 32768\nnet.core.wmem_default = 8388608\nnet.core.rmem_default = 8388608\nnet.core.rmem_max = 16777216\nnet.core.wmem_max = 16777216\nnet.ipv4.tcp_timestamps = 1\nnet.ipv4.tcp_fin_timeout = 20\nnet.ipv4.tcp_synack_retries = 2\nnet.ipv4.tcp_syn_retries = 2\nnet.ipv4.tcp_syncookies = 1\n#net.ipv4.tcp_tw_len = 1\nnet.ipv4.tcp_tw_reuse = 1\nnet.ipv4.tcp_mem = 94500000 915000000 927000000\nnet.ipv4.tcp_max_orphans = 3276800\nnet.ipv4.ip_local_port_range = 1024 65000\nnet.nf_conntrack_max = 6553500\nnet.netfilter.nf_conntrack_max = 6553500\nnet.netfilter.nf_conntrack_tcp_timeout_close_wait = 60\nnet.netfilter.nf_conntrack_tcp_timeout_fin_wait = 120\nnet.netfilter.nf_conntrack_tcp_timeout_time_wait = 120\nnet.netfilter.nf_conntrack_tcp_timeout_established = 3600\nnet.ipv6.conf.all.disable_ipv6 = 1\nnet.ipv6.conf.default.disable_ipv6 = 1\nkernel.numa_balancing = 0\nkernel.shmmax = 68719476736\nkernel.printk = 5\nkernel.sysrq = 1\nvm.overcommit_memory = 0\nvm.swappiness = 0\nEOF")]),a._v("\n")])])]),s("h4",{attrs:{id:"文件描述符和用户最大进程数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#文件描述符和用户最大进程数"}},[a._v("#")]),a._v(" 文件描述符和用户最大进程数")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#### 调整文件描述符")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">>")]),a._v(" /etc/security/limits.conf "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("EOF\n* soft nproc 65535 \n* hard nproc 65535 \n* soft nofile 65535 \n* hard nofile 65535 \nEOF")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("##用户进程限制")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">>")]),a._v(" /etc/security/limits.d/20-nproc.conf "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("EOF\n* soft nproc 8192\nroot soft nproc unlimited\nEOF")]),a._v("\n")])])]),s("h2",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[a._v("#")]),a._v(" 安装")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v(" 安装有两种方法：\n      在线安装和搭建本地yum源仓库安装\n")])])]),s("h3",{attrs:{id:"在线安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在线安装"}},[a._v("#")]),a._v(" 在线安装")]),a._v(" "),s("h4",{attrs:{id:"下载yum源配置文件repo"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#下载yum源配置文件repo"}},[a._v("#")]),a._v(" 下载yum源配置文件repo")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("#如果做了免秘钥登陆，则只需要在主节点下载yum源\n\nsudo wget -nv http://public-repo-1.hortonworks.com/ambari/centos7/2.x/updates/2.6.1.5/ambari.repo -O /etc/yum.repos.d/ambari.repo\n\nsudo wget –nv http://public-repo-1.hortonworks.com/HDP/centos7/2.x/updates/2.6.4.0/hdp.repo -O /etc/yum.repos.d/hdp.repo\n\nsudo wget -nv http://public-repo-1.hortonworks.com/HDP-GPL/centos7/2.x/updates/2.6.4.0/hdp.gpl.repo -O /etc/yum.repos.d/hdp.gpl.repo\n")])])]),s("h3",{attrs:{id:"离线安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#离线安装"}},[a._v("#")]),a._v(" 离线安装")]),a._v(" "),s("h4",{attrs:{id:"制作本地源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#制作本地源"}},[a._v("#")]),a._v(" 制作本地源")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("制作本地镜像源安装HDP，可以在主节点或者单独的一台服务器（建议）\n选择一台可以访问internet的服务器配置本地源\napache httpd\n提供离线仓库的下载服务\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#安装apache")]),a._v("\nyum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" httpd –y\n\n下载软件源\n\n在httpd网站根目录,默认是即/var/www/html/，创建目录ambari， \n并且将下载的压缩包解压到/var/www/html/ambari目录\n\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /var/www/html/\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" ambari\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /var/www/html/ambari/\nhttp://public-repo-1.hortonworks.com/ambari/centos7/2.x/updates/2.6.1.5/ambari-2.6.1.5-centos7.tar.gz\nhttp://public-repo-1.hortonworks.com/HDP/centos6/2.x/updates/2.6.4.0/HDP-2.6.4.0-centos6-rpm.tar.gz\nhttp://public-repo-1.hortonworks.com/HDP-UTILS-1.1.0.22/repos/centos6/HDP-UTILS-1.1.0.22-centos6.tar.gz\n\nhttp://public-repo-1.hortonworks.com/HDP-GPL/centos6/2.x/updates/2.6.4.0/HDP-GPL-2.6.4.0-centos6-rpm.tar.gz\n\n解压下载的tar包\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@dev-bg-m01 html"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## cd /var/www/html/")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@dev-bg-m01 html"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## pwd")]),a._v("\n/var/www/html\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@dev-bg-m01 html"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@dev-bg-m01 html"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## tree -L 2 ambari/")]),a._v("\nambari/\n├── ambari\n│   └── centos7\n├── HDP\n│   └── centos7\n├── HDP-GPL\n│   └── centos7\n└── HDP-UTILS-1.1.0.22\n    ├── hdp-utils.repo\n    ├── openblas\n    ├── repodata\n    ├── RPM-GPG-KEY\n    └── snappy\n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("11")]),a._v(" directories, "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("file")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@dev-bg-m01 html"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#")]),a._v("\n")])])]),s("h4",{attrs:{id:"编辑ambari-yum源文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#编辑ambari-yum源文件"}},[a._v("#")]),a._v(" 编辑ambari yum源文件")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@dev-bg-m01 yum.repos.d"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## cat ambari.repo")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#VERSION_NUMBER=2.6.1.5-3")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("ambari-2.6.1.5"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("ambari Version - ambari-2.6.1.5\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("baseurl")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://192.168.103.3/ambari/ambari/centos7/2.6.1.5-3/\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("gpgcheck")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("gpgkey")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://192.168.103.3/ambari/ambari/centos7/2.6.1.5-3/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("enabled")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("priority")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@dev-bg-m01 yum.repos.d"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@dev-bg-m01 yum.repos.d"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## cat hdp.repo")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#VERSION_NUMBER=2.6.4.0-91")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("HDP-2.6.4.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("HDP Version - HDP-2.6.4.0\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("baseurl")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://192.168.103.3/ambari/HDP/centos7/2.6.4.0-91/\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("gpgcheck")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("gpgkey")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://192.168.103.3/ambari/HDP/centos7/2.6.4.0-91/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("enabled")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("priority")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("HDP-UTILS-1.1.0.22"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("HDP-UTILS Version - HDP-UTILS-1.1.0.22\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("baseurl")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://192.168.103.3/ambari/HDP-UTILS-1.1.0.22/\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("gpgcheck")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("gpgkey")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://192.168.103.3/ambari/HDP-UTILS-1.1.0.22/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("enabled")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("priority")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@dev-bg-m01 yum.repos.d"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@dev-bg-m01 yum.repos.d"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## cat hdp.gpl.repo")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("HDP-2.6-GPL-repo-1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("HDP-2.6-GPL-repo-1\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("baseurl")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://192.168.103.3/ambari/HDP-GPL/centos7/2.6.4.0-91/\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("gpgkey")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://192.168.103.3/ambari/HDP-GPL/centos7/2.6.4.0-91/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("path")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("enabled")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("gpgcheck")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@dev-bg-m01 yum.repos.d"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#")]),a._v("\n\n更新yum 元数据\nyum clean all\nyum makecache\nyum repolist\n")])])]),s("h3",{attrs:{id:"安装ambari-server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装ambari-server"}},[a._v("#")]),a._v(" 安装Ambari-server")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("在主节点安装ambari-server\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" yum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" -y ambari-server\n")])])]),s("h4",{attrs:{id:"配置ambari-server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置ambari-server"}},[a._v("#")]),a._v(" 配置Ambari-server")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("配置mysql连接器\n由于ambari要访问数据库，所以要添加lib包，请自行去mysql官网下载\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" -p /usr/share/java\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" /opt/mysql-connector-java-5.1.47/mysql-connector-java-5.1.47-bin.jar /usr/share/java/\n\n在ambari-server配置文件中添加mysql lib包路径地址\n\n执行一下命令配置jdbc环境\n\nambari-server setup --jdbc-db"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql --jdbc-driver"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/share/java/mysql-connector-java-5.1.47-bin.jar\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" /etc/ambari-server/conf/ambari.properties\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("###在jdbc区下面找个位置添加如下如下语句")]),a._v("\nserver.jdbc.driver.path"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/share/java/mysql-connector-java-5.1.47-bin.jar\n\n\n检查环境并配置\n执行以下命令\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" ambari-server setup\n按提示操作\n\n会检查selinux，是否自定义用户，检查防火墙，设置JDK路径，数据库配置等，按提示操作即可\n\n具体操作如下：\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@dev-bg-m01 opt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## vim /etc/ambari-server/conf/ambari.properties ")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@dev-bg-m01 opt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## ambari-server setup --jdbc-db=mysql --jdbc-driver=/usr/share/java/mysql-connector-java-5.1.47-bin.jar")]),a._v("\nUsing python /usr/bin/python\nSetup ambari-server\nCopying /usr/share/java/mysql-connector-java-5.1.47-bin.jar to /var/lib/ambari-server/resources\nIf you are updating existing jdbc driver jar "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" mysql with mysql-connector-java-5.1.47-bin.jar. Please remove the old driver jar, from all hosts. Restarting services that need the driver, will automatically copy the new jar to the hosts.\nJDBC driver was successfully initialized.\nAmbari Server "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'setup'")]),a._v(" completed successfully.\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@dev-bg-m01 opt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## vim /etc/ambari-server/conf/ambari.properties ")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@dev-bg-m01 opt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## ambari-server setup")]),a._v("\nUsing python /usr/bin/python\nSetup ambari-server\nChecking SELinux"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\nSELinux status is "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'disabled'")]),a._v("\nCustomize user account "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" ambari-server daemon "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("y/n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("? y\nEnter user account "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" ambari-server daemon "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("root"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(":ambari\nAdjusting ambari-server permissions and ownership"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\nChecking firewall status"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\nChecking JDK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\nDo you want to change Oracle JDK "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("y/n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("? y \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" Oracle JDK "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.8")]),a._v(" + Java Cryptography Extension "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("JCE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" Policy Files "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" Oracle JDK "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.7")]),a._v(" + Java Cryptography Extension "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("JCE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" Policy Files "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" Custom JDK\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),a._v("\nEnter choice "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(": "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v("\nWARNING: JDK must be installed on all hosts and JAVA_HOME must be valid on all hosts.\nWARNING: JCE Policy files are required "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" configuring Kerberos security. If you plan to use Kerberos,please "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v(" sure JCE Unlimited Strength Jurisdiction Policy Files are valid on all hosts.\nPath to JAVA_HOME: /opt/jdk1.8.0_161\nValidating JDK on Ambari Server"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".done.\nChecking GPL software agreement"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\nCompleting setup"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\nConfiguring database"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\nEnter advanced database configuration "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("y/n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("? y\nConfiguring database"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),a._v("\nChoose one of the following options:\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" - PostgreSQL "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Embedded"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" - Oracle\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" - MySQL / MariaDB\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" - PostgreSQL\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" - Microsoft SQL Server "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Tech Preview"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" - SQL Anywhere\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" - BDB\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),a._v("\n\nEnter choice "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(": "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v("\nHostname "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("localhost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(": "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".103.3\nPort "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3306")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(": \nDatabase name "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("ambari"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(": \nUsername "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("ambari"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(": \nEnter Database Password "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("bigdata"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(": \nRe-enter password: \nConfiguring ambari database"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\nConfiguring remote database connection properties"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\nWARNING: Before starting Ambari Server, you must run the following DDL against the database to create the schema: /var/lib/ambari-server/resources/Ambari-DDL-MySQL-CREATE.sql\nProceed with configuring remote database connection properties "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("y/n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("y"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("? n\nWARNING: Remote database setup aborted.\nAmbari Server "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'setup'")]),a._v(" completed with warnings.\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@dev-bg-m01 opt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#")]),a._v("\n")])])]),s("h4",{attrs:{id:"将ambari数据库脚本导入到数据库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#将ambari数据库脚本导入到数据库"}},[a._v("#")]),a._v(" 将Ambari数据库脚本导入到数据库")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("mysql -uambari -pxxx\nuse ambari"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" /var/lib/ambari-server/resources/Ambari-DDL-MySQL-CREATE.sql\n\n启动ambari server\nambari-server start\n\n在浏览器中访问ip:8080，默认登录名：admin 密码:admin\n")])])]),s("p",[a._v("添加服务组件\nhttps://docs.hortonworks.com/HDPDocuments/Ambari-2.6.1.5/bk_ambari-administration/content/ambari_admin_overview.html")]),a._v(" "),s("h4",{attrs:{id:"spark配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#spark配置"}},[a._v("#")]),a._v(" spark配置")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("由于spark要访问数据库，所以要添加mysql lib包\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" /opt/mysql-connector-java-5.1.47/mysql-connector-java-5.1.47-bin.jar /usr/hdp/2.6.4.0-91/spark/lib/\n")])])]),s("h2",{attrs:{id:"安装数据库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装数据库"}},[a._v("#")]),a._v(" 安装数据库")]),a._v(" "),s("p",[a._v("使用现有数据库或者自己安装")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("创建ambari和hive库\ncreate database ambari character "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" utf8 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n添加权限\nGRANT ALL PRIVILEGES ON keystone.* TO "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'keystone'")]),a._v("@"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'%'")]),a._v(" IDENTIFIED BY "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'ambari'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nFLUSH PRIVILEGES"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n删除权限：\nrevoke all privileges on ambari.* from ambari@"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'%'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),s("h2",{attrs:{id:"程序安装目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#程序安装目录"}},[a._v("#")]),a._v(" 程序安装目录")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("程序默认安装目录\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@test-bg-m01 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2.6")]),a._v(".4.0-91"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## pwd")]),a._v("\n/usr/hdp/2.6.4.0-91\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@test-bg-m01 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2.6")]),a._v(".4.0-91"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## ls")]),a._v("\natlas hadoop hadoop-mapreduce hbase hive2 kafka pig ranger-hdfs-plugin ranger-kafka-plugin ranger-yarn-plugin spark storm tez usr\netc hadoop-hdfs hadoop-yarn hive hive-hcatalog livy ranger-hbase-plugin ranger-hive-plugin ranger-storm-plugin slider spark2 storm-slider-client tez_hive2 zookeeper\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@test-bg-m01 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2.6")]),a._v(".4.0-91"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#")]),a._v("\n\n\nPID目录\n\n/var/run/\n\n日志目录\n/var/logs/\n\n一般修改log目录，在安装大数据组件的时候，修改配置文件即可。\n")])])]),s("h3",{attrs:{id:"删除服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#删除服务"}},[a._v("#")]),a._v(" 删除服务")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("先停止服务\nService Actions "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" Delete Service\nyum remove xx\nhttps://docs.hortonworks.com/HDPDocuments/Ambari-2.6.1.5/bk_ambari-administration/content/ambari_admin_overview.html\n")])])]),s("p",[a._v("ambari监控")]),a._v(" "),s("h2",{attrs:{id:"ambari安装默认用户和用户组"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ambari安装默认用户和用户组"}},[a._v("#")]),a._v(" ambari安装默认用户和用户组")]),a._v(" "),s("p",[a._v("https://docs.hortonworks.com/HDPDocuments/Ambari-2.6.1.5/bk_ambari-administration/content/defining_service_users_and_groups_for_a_hdp_2x_stack.html")]),a._v(" "),s("h2",{attrs:{id:"常见问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常见问题"}},[a._v("#")]),a._v(" 常见问题")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("问题1：Centos "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7")]),a._v("安装 ambari-agent报错NetUtil.py-"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("SSL: CERTIFICATE_VERIFY_FAILED"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\nCentos "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7")]),a._v("安装 ambari通过Ambari部署系统时，ambari-agent注册失败，在/var/log/ambari-agent的log中可以看到日志显示：\nERROR "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2018")]),a._v("-03-08 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("15")]),a._v(":02:25,223 NetUtil.py:88 - "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("SSL: CERTIFICATE_VERIFY_FAILED"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" certificate verify failed "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_ssl.c:579"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" \nERROR "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2018")]),a._v("-03-08 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("15")]),a._v(":02:25,223 NetUtil.py:89 - SSLError: Failed to connect. Please check openssl library versions.\n\n解决方法：\n\n修改/etc/python/cert-verification.cfg配置文件： \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## vim /etc/python/cert-verification.cfg")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("https"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("verify")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("platform_default "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("###(这是默认配置)")]),a._v("\n修改为verify"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("disable\n\n编辑 /etc/ambari-agent/conf/ambari-agent.ini 配置文件，在 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("security"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" 节部分，确保设置如下两个值，其它值保持不变：\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@ambari ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## vim /etc/ambari-agent/conf/ambari-agent.ini")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("security"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ssl_verify_cert")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("force_https_protocol")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("PROTOCOL_TLSv1_2\n以上配置修改完后，重试即可通过ambari-agent注册，执行即可下一步\n")])])]),s("p",[a._v("参考文档\n官方文档安装文档")]),a._v(" "),s("p",[a._v("https://docs.hortonworks.com/HDPDocuments/Ambari-2.6.1.5/bk_ambari-installation/content/determine_product_interop.html")]),a._v(" "),s("h3",{attrs:{id:"参考文章"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[a._v("#")]),a._v(" 参考文章")]),a._v(" "),s("ul",[s("li",[a._v("https://www.cnblogs.com/xuliang666/p/11381225.html")])])])}),[],!1,null,null,null);t.default=n.exports}}]);