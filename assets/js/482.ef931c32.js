(window.webpackJsonp=window.webpackJsonp||[]).push([[482],{997:function(t,s,a){"use strict";a.r(s);var e=a(53),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("本文主要是介绍 Hive-存储和压缩")])]),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#大数据之hive-五-存储与压缩"}},[t._v("大数据之Hive（五）：存储与压缩")]),a("ul",[a("li",[a("a",{attrs:{href:"#_5-1-hive存储格式"}},[t._v("5.1 Hive存储格式")])]),a("li",[a("a",{attrs:{href:"#_5-2-hive压缩格式"}},[t._v("5.2 Hive压缩格式")])]),a("li",[a("a",{attrs:{href:"#_5-3-存储和压缩相结合"}},[t._v("5.3  存储和压缩相结合")])]),a("li",[a("a",{attrs:{href:"#_5-4-主流存储文件性能对比"}},[t._v("5.4 主流存储文件性能对比")])])])]),a("li",[a("a",{attrs:{href:"#参考文章"}},[t._v("参考文章")])])])]),a("p"),t._v(" "),a("h2",{attrs:{id:"大数据之hive-五-存储与压缩"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#大数据之hive-五-存储与压缩"}},[t._v("#")]),t._v(" 大数据之Hive（五）：存储与压缩")]),t._v(" "),a("h3",{attrs:{id:"_5-1-hive存储格式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-hive存储格式"}},[t._v("#")]),t._v(" 5.1 Hive存储格式")]),t._v(" "),a("p",[t._v("Hive支持的存储数的格式主要有：TEXTFILE（行式存储） 、SEQUENCEFILE(行式存储)、ORC（列式存储）、PARQUET（列式存储）。")]),t._v(" "),a("p",[t._v("5.1.1 行式存储和列式存储")]),t._v(" "),a("img",{staticClass:"zoom-custom-imgs",attrs:{src:t.$withBase("/assets/img/dw/hive/lianzai12-1.png"),alt:"wxmp"}}),t._v(" "),a("p",[t._v("上图左边为逻辑表，右边第一个为行式存储，第二个为列式存储。")]),t._v(" "),a("p",[a("strong",[t._v("行存储的特点：")]),t._v(" 查询满足条件的一整行数据的时候，列存储则需要去每个聚集的字段找到对应的每个列的值，行存储只需要找到其中一个值，其余的值都在相邻地方，所以此时行存储查询的速度更快。select  *")]),t._v(" "),a("p",[a("strong",[t._v("列存储的特点：")]),t._v(" 因为每个字段的数据聚集存储，在查询只需要少数几个字段的时候，能大大减少读取的数据量；每个字段的数据类型一定是相同的，列式存储可以针对性的设计更好的设计压缩算法。select  某些字段效率更高。")]),t._v(" "),a("p",[t._v("5.1.2 TEXTFILE")]),t._v(" "),a("p",[t._v("默认格式，数据不做压缩，磁盘开销大，数据解析开销大。可结合Gzip、Bzip2使用(系统自动检查，执行查询时自动解压)，但使用这种方式，hive不会对数据进行切分，从而无法对数据进行并行操作。")]),t._v(" "),a("p",[t._v("5.1.3 ORC格式")]),t._v(" "),a("p",[t._v("Orc (Optimized Row Columnar)是hive 0.11版里引入的新的存储格式。")]),t._v(" "),a("p",[t._v("可以看到每个Orc文件由1个或多个stripe组成，每个stripe250MB大小，这个Stripe实际相当于RowGroup概念，不过大小由4MB->250MB，这样能提升顺序读的吞吐率。每个Stripe里有三部分组成，分别是Index Data,Row Data,Stripe Footer：")]),t._v(" "),a("img",{staticClass:"zoom-custom-imgs",attrs:{src:t.$withBase("/assets/img/dw/hive/lianzai12-2.png"),alt:"wxmp"}}),t._v(" "),a("ul",[a("li",[a("ol",[a("li",[t._v("Index Data：一个轻量级的index，默认是每隔1W行做一个索引。这里做的索引只是记录某行的各字段在Row Data中的offset。")])])]),t._v(" "),a("li",[a("ol",{attrs:{start:"2"}},[a("li",[t._v("Row Data：存的是具体的数据，先取部分行，然后对这些行按列进行存储。对每个列进行了编码，分成多个Stream来存储。")])])]),t._v(" "),a("li",[a("ol",{attrs:{start:"3"}},[a("li",[t._v("Stripe Footer：存的是各个stripe的元数据信息")])])])]),t._v(" "),a("p",[t._v("每个文件有一个File Footer，这里面存的是每个Stripe的行数，每个Column的数据类型信息等；每个文件的尾部是一个PostScript，这里面记录了整个文件的压缩类型以及FileFooter的长度信息等。在读取文件时，会seek到文件尾部读PostScript，从里面解析到File Footer长度，再读FileFooter，从里面解析到各个Stripe信息，再读各个Stripe，即从后往前读。")]),t._v(" "),a("p",[t._v("5.1.4 PARQUET格式")]),t._v(" "),a("p",[t._v("Parquet是面向分析型业务的列式存储格式，由Twitter和Cloudera合作开发，2015年5月从Apache的孵化器里毕业成为Apache顶级项目。")]),t._v(" "),a("p",[t._v("Parquet文件是以二进制方式存储的，所以是不可以直接读取的，文件中包括该文件的数据和元数据，因此Parquet格式文件是自解析的。")]),t._v(" "),a("p",[t._v("通常情况下，在存储Parquet数据的时候会按照Block大小设置行组的大小，由于一般情况下每一个Mapper任务处理数据的最小单位是一个Block，这样可以把每一个行组由一个Mapper任务处理，增大任务执行并行度。Parquet文件的格式如下图所示。")]),t._v(" "),a("img",{staticClass:"zoom-custom-imgs",attrs:{src:t.$withBase("/assets/img/dw/hive/lianzai12-3.png"),alt:"wxmp"}}),t._v(" "),a("p",[t._v("上图展示了一个Parquet文件的内容，一个文件中可以存储多个行组，文件的首位都是该文件的Magic Code，用于校验它是否是一个Parquet文件，Footer length记录了文件元数据的大小，通过该值和文件长度可以计算出元数据的偏移量，文件的元数据中包括每一个行组的元数据信息和该文件存储数据的Schema信息。除了文件中每一个行组的元数据，每一页的开始都会存储该页的元数据，在Parquet中，有三种类型的页：数据页、字典页和索引页。数据页用于存储当前行组中该列的值，字典页存储该列值的编码字典，每一个列块中最多包含一个字典页，索引页用来存储当前行组下该列的索引，目前Parquet中还不支持索引页。")]),t._v(" "),a("h3",{attrs:{id:"_5-2-hive压缩格式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-hive压缩格式"}},[t._v("#")]),t._v(" 5.2 Hive压缩格式")]),t._v(" "),a("p",[t._v("在实际工作当中，hive当中处理的数据，一般都需要经过压缩，前期我们在学习hadoop的时候，已经配置过hadoop的压缩，我们这里的hive也是一样的可以使用压缩来节省我们的MR处理的网络带宽")]),t._v(" "),a("p",[t._v("mr支持的压缩格式:")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("压缩格式")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("工具")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("算法")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("文件扩展名")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("是否可切分")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("DEFAULT")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("无")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("DEFAULT")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v(".deflate")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("否")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("Gzip")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("gzip")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("DEFAULT")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v(".gz")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("否")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("bzip2")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("bzip2")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("bzip2")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v(".bz2")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("LZO")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("lzop")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("LZO")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v(".lzo")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("否")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("LZ4")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("无")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("LZ4")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v(".lz4")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("否")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("Snappy")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("无")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("Snappy")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v(".snappy")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("否")])])])]),t._v(" "),a("p",[t._v("hadoop支持的解压缩的类：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("压缩格式")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("对应的编码/解码器")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("DEFLATE")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("org.apache.hadoop.io.compress.DefaultCodec")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("gzip")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("org.apache.hadoop.io.compress.GzipCodec")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("bzip2")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("org.apache.hadoop.io.compress.BZip2Codec")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("LZO")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("com.hadoop.compression.lzo.LzopCodec")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("LZ4")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("org.apache.hadoop.io.compress.Lz4Codec")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("Snappy")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("org.apache.hadoop.io.compress.SnappyCodec")])])])]),t._v(" "),a("p",[t._v("压缩性能的比较：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("压缩算法")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("原始文件大小")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("压缩文件大小")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("压缩速度")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("解压速度")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("gzip")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("8.3GB")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("1.8GB")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("17.5MB/s")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("58MB/s")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("bzip2")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("8.3GB")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("1.1GB")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("2.4MB/s")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("9.5MB/s")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("LZO")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("8.3GB")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("2.9GB")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("49.3MB/s")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("74.6MB/s")])])])]),t._v(" "),a("p",[t._v("Snappy生成的压缩文件要大20%到100%。在64位模式下的core i7处理器的单内核上，Snappy以250 MB/秒或更多的速度压缩，并以500 MB/秒或更多的速度解压。")]),t._v(" "),a("p",[t._v("实现压缩hadoop需要配置的压缩参数:")]),t._v(" "),a("img",{staticClass:"zoom-custom-imgs",attrs:{src:t.$withBase("/assets/img/dw/hive/lianzai12-4.png"),alt:"wxmp"}}),t._v(" "),a("p",[t._v("hive配置压缩的方式:")]),t._v(" "),a("ol",[a("li",[t._v("开启map端的压缩方式:")])]),t._v(" "),a("div",{staticClass:"language-ini extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[t._v("1.1）开启hive中间传输数据压缩功能\n hive (default)>set hive.exec.compress.intermediate"),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("true;")]),t._v("\n1.2）开启mapreduce中map输出压缩功能\n hive (default)>set mapreduce.map.output.compress"),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("true;")]),t._v("\n1.3）设置mapreduce中map输出数据的压缩方式\n hive (default)>set mapreduce.map.output.compress.codec"),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" org.apache.hadoop.io.compress.SnappyCodec;")]),t._v("\n1.4）执行查询语句\n select count(1) from score;\n")])])]),a("ol",[a("li",[t._v("开启reduce端的压缩方式")])]),t._v(" "),a("div",{staticClass:"language-ini extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[t._v("1）开启hive最终输出数据压缩功能\n hive (default)>set hive.exec.compress.output"),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("true;")]),t._v("\n2）开启mapreduce最终输出数据压缩\n hive (default)>set mapreduce.output.fileoutputformat.compress"),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("true;")]),t._v("\n3）设置mapreduce最终数据输出压缩方式\n hive (default)> set mapreduce.output.fileoutputformat.compress.codec "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" org.apache.hadoop.io.compress.SnappyCodec;")]),t._v("\n4）设置mapreduce最终数据输出压缩为块压缩\n hive (default)>set mapreduce.output.fileoutputformat.compress.type"),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("BLOCK;")]),t._v("\n5）测试一下输出结果是否是压缩文件\n insert overwrite local directory '/export/servers/snappy' select * from score distribute by s_id sort by s_id desc;\n")])])]),a("h3",{attrs:{id:"_5-3-存储和压缩相结合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-存储和压缩相结合"}},[t._v("#")]),t._v(" 5.3  存储和压缩相结合")]),t._v(" "),a("p",[t._v("ORC存储方式的压缩：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("Key")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("Default")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("Notes")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("orc.compress")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("ZLIB")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("高级压缩(可选: NONE, ZLIB, SNAPPY)")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("orc.compress.size")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("262,144")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("每个压缩块中的字节数")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("orc.stripe.size")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("67,108,864")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("每条stripe中的字节数")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("orc.row.index.stride")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("10,000")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("索引条目之间的行数(必须是>= 1000)")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("orc.create.index")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("true")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("是否创建行索引")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("orc.bloom.filter.columns")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v('""')]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("逗号分隔的列名列表，应该为其创建bloom过滤器")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("orc.bloom.filter.fpp")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("0.05")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("bloom过滤器的假阳性概率(必须是>0.0和<1.0)")])])])]),t._v(" "),a("p",[t._v("创建一个非压缩的ORC存储方式：")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("）建表语句\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" log_orc_none"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    track_time string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    url string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    session_id string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    referer string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ip string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    end_user_id string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    city_id string\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v(" STORED "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" orc tblproperties "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"orc.compress"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"NONE"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("）插入数据\n "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" log_orc_none "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" log_text "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("）查看插入后数据\n dfs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("du "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("h "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("warehouse"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("myhive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("db"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log_orc_none"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n 结果显示:\n "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("7.7")]),t._v(" M  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("warehouse"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log_orc_none"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("123456")]),t._v("_0\n")])])]),a("p",[t._v("创建一个SNAPPY压缩的ORC存储方式：")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("）建表语句\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" log_orc_snappy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    track_time string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    url string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    session_id string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    referer string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ip string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    end_user_id string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    city_id string\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v(" STORED "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" orc tblproperties "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"orc.compress"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SNAPPY"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("）插入数据\n "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" log_orc_snappy "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" log_text "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("）查看插入后数据\n dfs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("du "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("h "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("warehouse"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("myhive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("db"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log_orc_snappy "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n 结果显示: \n "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.8")]),t._v(" M  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("warehouse"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log_orc_snappy"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("123456")]),t._v("_0\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("）上一节中默认创建的ORC存储方式，导入数据后的大小为\n "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.8")]),t._v(" M  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("warehouse"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log_orc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("123456")]),t._v("_0\n 比Snappy压缩的还小。原因是orc存储文件默认采用ZLIB压缩。比snappy压缩的小。\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("）存储方式和压缩总结：\n 在实际的项目开发当中，hive表的数据存储格式一般选择：orc或parquet。压缩方式一般选择snappy。\n")])])]),a("h3",{attrs:{id:"_5-4-主流存储文件性能对比"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-主流存储文件性能对比"}},[t._v("#")]),t._v(" 5.4 主流存储文件性能对比")]),t._v(" "),a("p",[t._v("从存储文件的压缩比和查询速度两个角度对比。")]),t._v(" "),a("p",[t._v("压缩比比较：")]),t._v(" "),a("ul",[a("li",[t._v("TextFile")])]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("（"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("）创建表，存储数据格式为TEXTFILE\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" log_text "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    track_time string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    url string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    session_id string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    referer string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ip string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    end_user_id string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    city_id string\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v(" STORED "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TEXTFILE "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n（"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("）向表中加载数据\n "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("load")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("local")]),t._v(" inpath "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/export/servers/hivedatas/log.data'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" log_text "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n（"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("）查看表中数据大小，大小为"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("18.1")]),t._v("M\n dfs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("du "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("h "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("warehouse"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("myhive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("db"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log_text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n 结果显示: \n "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("18.1")]),t._v(" M  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("warehouse"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log_text"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("data")]),t._v("\n")])])]),a("ul",[a("li",[t._v("ORC")])]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("（"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("）创建表，存储数据格式为ORC\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" log_orc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    track_time string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    url string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    session_id string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    referer string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ip string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    end_user_id string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    city_id string\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v(" STORED "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" orc "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n（"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("）向表中加载数据\n "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" log_orc "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" log_text "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n（"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("）查看表中数据大小\n dfs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("du "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("h "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("warehouse"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("myhive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("db"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log_orc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n 结果显示:\n "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.8")]),t._v(" M  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("warehouse"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log_orc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("123456")]),t._v("_0\n")])])]),a("ul",[a("li",[t._v("Parquet")])]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("）创建表，存储数据格式为parquet\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("create")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" log_parquet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    track_time string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    url string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    session_id string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    referer string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ip string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    end_user_id string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    city_id string\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROW")]),t._v(" FORMAT DELIMITED "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FIELDS")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\t'")]),t._v(" STORED "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" PARQUET "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n \n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("）向表中加载数据\n "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("table")]),t._v(" log_parquet "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" log_text "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("）查看表中数据大小\n dfs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("du "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("h "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("warehouse"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("myhive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("db"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log_parquet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n 结果显示:\n "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("13.1")]),t._v(" M  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hive"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("warehouse"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log_parquet"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("123456")]),t._v("_0\n")])])]),a("p",[t._v("数据压缩比结论:")]),t._v(" "),a("p",[a("strong",[t._v("ORC >  Parquet >  textFile")])]),t._v(" "),a("p",[t._v("存储文件的查询效率测试")]),t._v(" "),a("ul",[a("li",[t._v("textFile")])]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("hive "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" log_text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n_c0\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100000")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Time")]),t._v(" taken: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21.54")]),t._v(" seconds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Fetched: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("row")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n")])])]),a("ul",[a("li",[t._v("ORC")])]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("hive "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" log_orc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n_c0\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100000")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Time")]),t._v(" taken: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20.867")]),t._v(" seconds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Fetched: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("row")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n")])])]),a("ul",[a("li",[t._v("Parquet")])]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("hive "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" log_parquet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n_c0\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100000")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Time")]),t._v(" taken: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("22.922")]),t._v(" seconds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Fetched: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("row")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("存储文件的查询效率比较:")]),t._v(" "),a("p",[a("strong",[t._v("ORC > TextFile > Parquet")])]),t._v(" "),a("h2",{attrs:{id:"参考文章"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[t._v("#")]),t._v(" 参考文章")]),t._v(" "),a("ul",[a("li",[t._v("https://blog.csdn.net/weixin_44291548/article/details/119764835")])])])}),[],!1,null,null,null);s.default=r.exports}}]);