(window.webpackJsonp=window.webpackJsonp||[]).push([[499],{1015:function(_,v,t){"use strict";t.r(v);var a=t(53),r=Object(a.a)({},(function(){var _=this,v=_.$createElement,t=_._self._c||v;return t("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[_._v("TIP")]),_._v(" "),t("p",[_._v("æœ¬æ–‡ä¸»è¦æ˜¯ä»‹ç» Pig-åŸºç¡€çŸ¥è¯†æ€»ç»“ ã€‚")])]),_._v(" "),t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#pig-åŸºç¡€çŸ¥è¯†æ€»ç»“"}},[_._v("Pig-åŸºç¡€çŸ¥è¯†æ€»ç»“")])]),t("li",[t("a",{attrs:{href:"#_1-å¸¸ç”¨æ“ä½œ"}},[_._v("1. å¸¸ç”¨æ“ä½œ")])]),t("li",[t("a",{attrs:{href:"#_2-pig-latinæ•°æ®ç±»å‹"}},[_._v("2. Pig Latinæ•°æ®ç±»å‹")])]),t("li",[t("a",{attrs:{href:"#_3-å¸¸ç”¨å‡½æ•°"}},[_._v("3. å¸¸ç”¨å‡½æ•°")])]),t("li",[t("a",{attrs:{href:"#ã€-ã€‘"}},[_._v("ã€----------------------------ã€‘")])]),t("li",[t("a",{attrs:{href:"#å‡†å¤‡ä¸¤ä¸ªæ•°æ®æ–‡ä»¶"}},[_._v("å‡†å¤‡ä¸¤ä¸ªæ•°æ®æ–‡ä»¶ï¼š")])]),t("li",[t("a",{attrs:{href:"#åŠ è½½å’Œå­˜å‚¨-load-store"}},[_._v("åŠ è½½å’Œå­˜å‚¨ï¼ˆLoadï¼ŒStoreï¼‰")])]),t("li",[t("a",{attrs:{href:"#ç­›é€‰-filter"}},[_._v("ç­›é€‰ï¼ˆFilterï¼‰")])]),t("li",[t("a",{attrs:{href:"#foreach-generate"}},[_._v("Foreach Generate")])]),t("li",[t("a",{attrs:{href:"#åˆ†ç»„-group"}},[_._v("åˆ†ç»„ï¼ˆgroupï¼‰")])]),t("li",[t("a",{attrs:{href:"#streamæ“ä½œ"}},[_._v("Streamæ“ä½œ")])]),t("li",[t("a",{attrs:{href:"#join"}},[_._v("Join")])]),t("li",[t("a",{attrs:{href:"#cogroup"}},[_._v("COGROUP")])]),t("li",[t("a",{attrs:{href:"#cross"}},[_._v("Cross")])]),t("li",[t("a",{attrs:{href:"#æ’åº-order"}},[_._v("æ’åºï¼ˆOrderï¼‰")])]),t("li",[t("a",{attrs:{href:"#è”åˆ-union"}},[_._v("è”åˆï¼ˆUnionï¼‰")])]),t("li",[t("a",{attrs:{href:"#å‚è€ƒæ–‡ç« "}},[_._v("å‚è€ƒæ–‡ç« ")])])])]),t("p"),_._v(" "),t("h2",{attrs:{id:"pig-åŸºç¡€çŸ¥è¯†æ€»ç»“"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pig-åŸºç¡€çŸ¥è¯†æ€»ç»“"}},[_._v("#")]),_._v(" Pig-åŸºç¡€çŸ¥è¯†æ€»ç»“")]),_._v(" "),t("p",[_._v("PigæŸ¥è¯¢è¯­è¨€æ˜¯åŸºäºPig Latin,ç¨‹åºç”±ä¸€ç³»åˆ—è¯­å¥æ„æˆï¼Œæ“ä½œå’Œå‘½ä»¤ä¸åŒºåˆ†å¤§å°å†™ï¼Œåˆ«åå’Œå‡½æ•°ååŒºåˆ†å¤§å°å†™ã€‚ä¸‹é¢ï¼Œå°†ä»‹ç»Pig Latinçš„å¸¸ç”¨è¯­æ³•ã€‚")]),_._v(" "),t("h2",{attrs:{id:"_1-å¸¸ç”¨æ“ä½œ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-å¸¸ç”¨æ“ä½œ"}},[_._v("#")]),_._v(" 1. å¸¸ç”¨æ“ä½œ")]),_._v(" "),t("ul",[t("li",[_._v("åŠ è½½ä¸å­˜å‚¨")])]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("LOAD")]),_._v(" "),t("th",[_._v("å¯¼å…¥å¤–éƒ¨æ–‡ä»¶ä¸­çš„æ•°æ®ï¼Œå­˜å…¥å…³ç³»")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("STORE")]),_._v(" "),t("td",[_._v("å°†ä¸€ä¸ªå…³ç³»å­˜å‚¨åˆ°æ–‡ä»¶ç³»ç»Ÿä¸­")])]),_._v(" "),t("tr",[t("td",[_._v("DUMP")]),_._v(" "),t("td",[_._v("å°†å…³ç³»æ‰“å°åˆ°æ§åˆ¶å°")])])])]),_._v(" "),t("ul",[t("li",[_._v("è¿‡æ»¤")])]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("FILTER")]),_._v(" "),t("th",[_._v("æŒ‰æ¡ä»¶ç­›é€‰å…³ç³»ä¸­çš„è¡Œ")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("DISTINCT")]),_._v(" "),t("td",[_._v("å»é™¤å…³ç³»ä¸­çš„é‡å¤è¡Œ")])]),_._v(" "),t("tr",[t("td",[t("em",[_._v("FOREACH")]),_._v("*...*"),t("em",[_._v("GENERATE")])]),_._v(" "),t("td",[_._v("å¯¹äºé›†åˆçš„æ¯ä¸ªå…ƒç´ ï¼Œç”Ÿæˆæˆ–åˆ é™¤å­—æ®µ")])]),_._v(" "),t("tr",[t("td",[_._v("STREAM")]),_._v(" "),t("td",[_._v("ä½¿ç”¨å¤–éƒ¨ç¨‹åºå¯¹å…³ç³»è¿›è¡Œå˜æ¢(ä¾‹å¦‚ï¼Œå°†Pythonç¨‹åºåµŒå…¥åˆ°Pigä¸­ä½¿ç”¨)")])]),_._v(" "),t("tr",[t("td",[_._v("SAMPLE")]),_._v(" "),t("td",[_._v("ä»å…³ç³»ä¸­éšæœºå–æ ·")])])])]),_._v(" "),t("ul",[t("li",[_._v("åˆ†ç»„ä¸è¿æ¥")])]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("JOIN")]),_._v(" "),t("th",[_._v("è¿æ¥ä¸¤ä¸ªæˆ–å¤šä¸ªå…³ç³»")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("COGROUP")]),_._v(" "),t("td",[_._v("åœ¨ä¸¤ä¸ªæˆ–å¤šä¸ªå…³ç³»ä¸­åˆ†ç»„")])]),_._v(" "),t("tr",[t("td",[_._v("GROUP")]),_._v(" "),t("td",[_._v("åœ¨ä¸€ä¸ªå…³ç³»ä¸­å¯¹æ•°æ®åˆ†ç»„")])]),_._v(" "),t("tr",[t("td",[_._v("CROSS")]),_._v(" "),t("td",[_._v("è·å–ä¸¤ä¸ªæˆ–æ›´å¤šå…³ç³»çš„ä¹˜ç§¯ï¼ˆå‰ä¹˜ï¼‰")])])])]),_._v(" "),t("ul",[t("li",[_._v("æ’åº")])]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("ORDER")]),_._v(" "),t("th",[_._v("æ ¹æ®ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µå¯¹æŸä¸ªå…³ç³»è¿›è¡Œæ’åº")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("LIMIT")]),_._v(" "),t("td",[_._v("é™åˆ¶å…³ç³»çš„å…ƒç»„ä¸ªæ•°")])])])]),_._v(" "),t("ul",[t("li",[_._v("åˆå¹¶ä¸åˆ†å‰²")])]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("UNION")]),_._v(" "),t("th",[_._v("åˆå¹¶ä¸¤ä¸ªæˆ–å¤šä¸ªå…³ç³»")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("SPLIT")]),_._v(" "),t("td",[_._v("æŠŠæŸä¸ªå…³ç³»åˆ‡åˆ†æˆä¸¤ä¸ªæˆ–å¤šä¸ªå…³ç³»")])])])]),_._v(" "),t("ul",[t("li",[_._v("è¯Šæ–­æ“ä½œ")])]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("DESCRIBE")]),_._v(" "),t("th",[_._v("æ‰“å°å…³ç³»çš„æ¨¡å¼")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("EXPLAIN")]),_._v(" "),t("td",[_._v("æ‰“å°é€»è¾‘å’Œç‰©ç†è®¡åˆ’")])]),_._v(" "),t("tr",[t("td",[_._v("ILLUSTRATE")]),_._v(" "),t("td",[_._v("ä½¿ç”¨ç”Ÿæˆçš„è¾“å…¥å­é›†æ˜¾ç¤ºé€»è¾‘è®¡åˆ’çš„è¯•è¿è¡Œç»“æœ")])])])]),_._v(" "),t("ul",[t("li",[t("em",[_._v("UDF**æ“ä½œ")])])]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("REGISTER")]),_._v(" "),t("th",[_._v("åœ¨"),t("em",[_._v("Pig")]),_._v("è¿è¡Œæ—¶ç¯å¢ƒä¸­æ³¨å†Œä¸€ä¸ª"),t("em",[_._v("JAR")]),_._v("æ–‡ä»¶")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("DEFINE")]),_._v(" "),t("td",[_._v("ä¸º"),t("em",[_._v("UDF")]),_._v("ã€æµå¼è„šæœ¬æˆ–å‘½ä»¤è§„èŒƒæ–°å»ºåˆ«å")])])])]),_._v(" "),t("ul",[t("li",[t("em",[_._v("Pig Latin")]),_._v("å‘½ä»¤æ“ä½œ")])]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("kill")]),_._v(" "),t("th",[_._v("ä¸­æ­¢æŸä¸ª"),t("em",[_._v("MapReduce")]),_._v("ä»»åŠ¡")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("exec")]),_._v(" "),t("td",[_._v("åœ¨ä¸€ä¸ªæ–°çš„"),t("em",[_._v("Grunt shell")]),_._v("ç¨‹åºä¸­ä»¥æ‰¹å¤„ç†æ¨¡å¼è¿è¡Œä¸€ä¸ªè„šæœ¬")])]),_._v(" "),t("tr",[t("td",[_._v("run")]),_._v(" "),t("td",[_._v("åœ¨å½“å‰"),t("em",[_._v("Grunt")]),_._v("å¤–å£³ç¨‹åºä¸­è¿è¡Œç¨‹åº")])]),_._v(" "),t("tr",[t("td",[_._v("quit")]),_._v(" "),t("td",[_._v("é€€å‡ºè§£é‡Šå™¨")])]),_._v(" "),t("tr",[t("td",[_._v("set")]),_._v(" "),t("td",[_._v("è®¾ç½®"),t("em",[_._v("Pig")]),_._v("é€‰é¡¹")])])])]),_._v(" "),t("ul",[t("li",[t("em",[_._v("Pig Latin")]),_._v("è¡¨è¾¾å¼")])]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("ç±»å‹")]),_._v(" "),t("th",[_._v("è¡¨è¾¾å¼")]),_._v(" "),t("th",[_._v("æè¿°")]),_._v(" "),t("th",[_._v("ç¤ºä¾‹")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("å­—æ®µ")]),_._v(" "),t("td",[_._v("$n")]),_._v(" "),t("td",[_._v("ç¬¬"),t("em",[_._v("n")]),_._v("ä¸ªå­—æ®µ")]),_._v(" "),t("td",[_._v("$0")])]),_._v(" "),t("tr",[t("td",[_._v("å­—æ®µ")]),_._v(" "),t("td",[_._v("d")]),_._v(" "),t("td",[_._v("å­—æ®µåd")]),_._v(" "),t("td",[_._v("year")])]),_._v(" "),t("tr",[t("td",[_._v("æŠ•å½±")]),_._v(" "),t("td",[_._v("c.$n, c.f")]),_._v(" "),t("td",[t("em",[_._v("c.f")]),_._v(" åœ¨å…³ç³»ã€åŒ…æˆ–å…ƒç»„ä¸­çš„å­—æ®µ")]),_._v(" "),t("td",[_._v("user.$0, user.year")])]),_._v(" "),t("tr",[t("td",[t("em",[_._v("Map")]),_._v("æŸ¥æ‰¾")]),_._v(" "),t("td",[_._v("m#k")]),_._v(" "),t("td",[_._v("åœ¨æ˜ å°„"),t("em",[_._v("m")]),_._v("ä¸­é”®"),t("em",[_._v("k")]),_._v("å¯¹åº”çš„å€¼")]),_._v(" "),t("td",[t("em",[_._v("items")]),_._v("*'"),t("strong",[_._v("Coat")]),_._v("'*")])]),_._v(" "),t("tr",[t("td",[_._v("ç±»å‹è½¬æ¢")]),_._v(" "),t("td",[_._v("(t)f")]),_._v(" "),t("td",[_._v("å°†å­—æ®µ"),t("em",[_._v("t")]),_._v("è½¬æ¢æˆ"),t("em",[_._v("f")]),_._v("ç±»å‹")]),_._v(" "),t("td",[_._v("(int)age")])]),_._v(" "),t("tr",[t("td",[_._v("å‡½æ•°å‹å¹³é¢åŒ–")]),_._v(" "),t("td",[t("em",[_._v("fn(f1, f2,")]),_._v(" â€¦"),t("em",[_._v(")")])]),_._v(" "),t("td",[_._v("åœ¨å­—æ®µä¸Šåº”ç”¨å‡½æ•°")]),_._v(" "),t("td",[_._v("fn isGood(quality)")])]),_._v(" "),t("tr",[t("td",[_._v("å‡½æ•°å‹å¹³é¢åŒ–")]),_._v(" "),t("td",[_._v("FLATTEN(f)")]),_._v(" "),t("td",[_._v("ä»åŒ…å’Œå…ƒç»„ä¸­å»é™¤åµŒå¥—")]),_._v(" "),t("td",[_._v("flatten(group)")])])])]),_._v(" "),t("h2",{attrs:{id:"_2-pig-latinæ•°æ®ç±»å‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-pig-latinæ•°æ®ç±»å‹"}},[_._v("#")]),_._v(" 2. Pig Latinæ•°æ®ç±»å‹")]),_._v(" "),t("p",[_._v("æ•°æ®ç±»å‹ï¼š")]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("int")]),_._v(" (32ä½æœ‰ç¬¦å·æ•´æ•°)")]),_._v(" "),t("li",[t("strong",[_._v("long")]),_._v("(64ä½æœ‰ç¬¦å·æ•´æ•°)")]),_._v(" "),t("li",[t("strong",[_._v("float")]),_._v("(32ä½æµ®ç‚¹æ•°)")]),_._v(" "),t("li",[t("strong",[_._v("double")]),_._v("(64ä½æµ®ç‚¹æ•°)")]),_._v(" "),t("li",[t("strong",[_._v("chararray")]),_._v("(UTF16æ ¼å¼çš„å­—ç¬¦æ•°ç»„)")]),_._v(" "),t("li",[t("strong",[_._v("bytearray")]),_._v("(å­—èŠ‚æ•°ç»„)")]),_._v(" "),t("li",[_._v("**tuple(å…ƒç»„) : tuple: (1, "),t("strong",[_._v("world")]),_._v(")        //ä»»ä½•ç±»å‹çš„å­—æ®µåºåˆ—")]),_._v(" "),t("li",[_._v("**bag(åŒ…) :bag: {(1, "),t("strong",[_._v("world")]),_._v("), (2)}    //å…ƒç»„çš„æ— åºå¤šé‡é›†åˆï¼ˆå…è®¸é‡å¤å…ƒç»„ï¼‰")]),_._v(" "),t("li",[t("strong",[_._v("map(é”®å€¼å¯¹)")]),_._v(" : map: ['a' 'world']          //ä¸€ç»„é”®å€¼å¯¹ï¼Œé”®å¿…é¡»æ˜¯å­—ç¬¦æ•°ç»„")])]),_._v(" "),t("h2",{attrs:{id:"_3-å¸¸ç”¨å‡½æ•°"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-å¸¸ç”¨å‡½æ•°"}},[_._v("#")]),_._v(" 3. å¸¸ç”¨å‡½æ•°")]),_._v(" "),t("p",[_._v("è®¡ç®—å‡½æ•°ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("AVG ï¼š æ‰€æœ‰å€¼å¹³å‡å€¼")]),_._v(" "),t("li",[_._v("COUNT ï¼š è·å–åŒ…ä¸­çš„å…ƒç´ æ•°é‡")]),_._v(" "),t("li",[_._v("CONCATï¼šå°†ä¸¤åˆ—åˆå¹¶ä¸ºä¸€åˆ—")]),_._v(" "),t("li",[_._v("COUNT_STARï¼šè·å–åŒ…ä¸­çš„å…ƒç´ æ•°é‡ã€‚åœ¨è®¡æ•°å…ƒç´ æ—¶ï¼ŒCOUNT_STAR() å‡½æ•°åŒ…å«NULLå€¼")]),_._v(" "),t("li",[_._v("DIFFï¼šæ¯”è¾ƒå…ƒç»„ä¸­çš„ä¸¤ä¸ªåŒ…")]),_._v(" "),t("li",[_._v("MAXï¼šè®¡ç®—å•åˆ—åŒ…ä¸­çš„åˆ—ï¼ˆæ•°å€¼æˆ–å­—ç¬¦ï¼‰çš„æœ€å¤§å€¼")]),_._v(" "),t("li",[_._v("MINï¼šè®¡ç®—å•åˆ—åŒ…ä¸­çš„åˆ—ï¼ˆæ•°å€¼æˆ–å­—ç¬¦ï¼‰çš„æœ€å°å€¼")]),_._v(" "),t("li",[_._v("SIZEï¼šåŸºäºä»»ä½•Pigæ•°æ®ç±»å‹è®¡ç®—å…ƒç´ çš„æ•°é‡")]),_._v(" "),t("li",[_._v("SUMï¼šè·å–å•åˆ—åŒ…ä¸­åˆ—çš„æ€»æ•°å€¼")]),_._v(" "),t("li",[_._v("TOKENIZEï¼šç”¨äºåœ¨å•ä¸ªå…ƒç»„ä¸­åˆ†å‰²å­—ç¬¦ä¸²ï¼ˆå…¶ä¸­åŒ…å«ä¸€ç»„å­—ï¼‰ï¼Œå¹¶è¿”å›åŒ…å«æ‹†åˆ†æ“ä½œè¾“å‡ºçš„åŒ…")])]),_._v(" "),t("p",[_._v("è¿‡æ»¤å‡½æ•°ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("IsEmptyï¼šæ£€æŸ¥åŒ…æˆ–æ˜ å°„æ˜¯å¦ä¸ºç©º")])]),_._v(" "),t("p",[_._v("åŠ è½½*/*å­˜å‚¨å‡½æ•°ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("PigStorageï¼šå°†æ•°æ®åŠ è½½å¹¶å­˜å‚¨ä¸ºç»“æ„åŒ–æ–‡æœ¬æ–‡ä»¶")]),_._v(" "),t("li",[_._v("BinStorageï¼šä½¿ç”¨æœºå™¨å¯è¯»æ ¼å¼å°†æ•°æ®åŠ è½½å¹¶å­˜å‚¨åˆ°Pigä¸­")]),_._v(" "),t("li",[_._v("TextLoaderï¼šç”¨äºä»¥UTF-8æ ¼å¼åŠ è½½éç»“æ„åŒ–æ•°æ®")])]),_._v(" "),t("h2",{attrs:{id:"ã€-ã€‘"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ã€-ã€‘"}},[_._v("#")]),_._v(" ã€----------------------------ã€‘")]),_._v(" "),t("p",[_._v("æ‰€æœ‰å‘½ä»¤å’Œè„šæœ¬éƒ½åœ¨Pig 0.12.0 & Hadoop 2.2.0ä¸‹æµ‹è¯•é€šè¿‡ã€‚")]),_._v(" "),t("h2",{attrs:{id:"å‡†å¤‡ä¸¤ä¸ªæ•°æ®æ–‡ä»¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å‡†å¤‡ä¸¤ä¸ªæ•°æ®æ–‡ä»¶"}},[_._v("#")]),_._v(" å‡†å¤‡ä¸¤ä¸ªæ•°æ®æ–‡ä»¶ï¼š")]),_._v(" "),t("p",[_._v("1ï¼‰student.txt ç»“æ„ä¸ºï¼ˆç­çº§å·ï¼Œå­¦å·ï¼Œæˆç»©ï¼‰,å­—æ®µé—´é€—å·åˆ†éš”ã€‚")]),_._v(" "),t("p",[_._v("C01,N0101,82")]),_._v(" "),t("p",[_._v("C01,N0102,59")]),_._v(" "),t("p",[_._v("C01,N0103,65")]),_._v(" "),t("p",[_._v("C02,N0201,81")]),_._v(" "),t("p",[_._v("C02,N0202,82")]),_._v(" "),t("p",[_._v("C02,N0203,79")]),_._v(" "),t("p",[_._v("C03,N0301,56")]),_._v(" "),t("p",[_._v("C03,N0302,92")]),_._v(" "),t("p",[_._v("C03,N0306,72")]),_._v(" "),t("p",[_._v("2ï¼‰teacher.txt ç»“æ„ä¸ºï¼ˆç­çº§å·ï¼Œæ•™å¸ˆï¼‰,å­—æ®µé—´é€—å·åˆ†éš”ã€‚")]),_._v(" "),t("p",[_._v("C01,Zhang")]),_._v(" "),t("p",[_._v("C02,Sun")]),_._v(" "),t("p",[_._v("C03,Wang")]),_._v(" "),t("p",[_._v("C04,Dong")]),_._v(" "),t("h2",{attrs:{id:"åŠ è½½å’Œå­˜å‚¨-load-store"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åŠ è½½å’Œå­˜å‚¨-load-store"}},[_._v("#")]),_._v(" åŠ è½½å’Œå­˜å‚¨ï¼ˆLoadï¼ŒStoreï¼‰")]),_._v(" "),t("p",[_._v("æ‰§è¡Œä»¥ä¸‹å‘½ä»¤")]),_._v(" "),t("p",[t("em",[_._v("records = load'hdfs://localhost:9000/input/student.txt' using PigStorage(',') as(classNo:chararray, studNo:chararray, score:int);")])]),_._v(" "),t("p",[t("em",[_._v("dump records;")])]),_._v(" "),t("p",[t("em",[_._v("store records into ' hdfs://localhost:9000/input/student_out' using PigStorage('ğŸ˜‚;")])]),_._v(" "),t("p",[_._v("ç„¶åæŸ¥çœ‹hdfs://localhost:9000/input/student_outç›®å½•ä¸‹çš„part-m-00000æ–‡ä»¶ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š")]),_._v(" "),t("p",[_._v("C01:N0101:82")]),_._v(" "),t("p",[_._v("C01:N0102:59")]),_._v(" "),t("p",[_._v("C01:N0103:65")]),_._v(" "),t("p",[_._v("C02:N0201:81")]),_._v(" "),t("p",[_._v("C02:N0202:82")]),_._v(" "),t("p",[_._v("C02:N0203:79")]),_._v(" "),t("p",[_._v("C03:N0301:56")]),_._v(" "),t("p",[_._v("C03:N0302:92")]),_._v(" "),t("p",[_._v("C03:N0306:72")]),_._v(" "),t("p",[_._v("å…¶ä¸­çš„loadæ˜¯åŠ è½½æ“ä½œï¼Œstoreæ˜¯å­˜å‚¨æ“ä½œã€‚ä»–ä»¬åˆ†åˆ«å¯ä»¥æŒ‡å®šå…¶åˆ†éš”ç¬¦ï¼Œæ¯”å¦‚ä¸Šä¾‹ä¸­çš„é€—å·å’Œåˆ†å·ã€‚")]),_._v(" "),t("h2",{attrs:{id:"ç­›é€‰-filter"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç­›é€‰-filter"}},[_._v("#")]),_._v(" ç­›é€‰ï¼ˆFilterï¼‰")]),_._v(" "),t("p",[_._v("æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š")]),_._v(" "),t("p",[t("em",[_._v("records_c01 = filter records byclassNo=='C01';")])]),_._v(" "),t("p",[t("em",[_._v("dump records_c01;")])]),_._v(" "),t("p",[_._v("ç»“æœå¦‚ä¸‹ï¼š")]),_._v(" "),t("p",[_._v("(C01,N0101,82)")]),_._v(" "),t("p",[_._v("(C01,N0102,59)")]),_._v(" "),t("p",[_._v("(C01,N0103,65)")]),_._v(" "),t("p",[_._v("æ³¨æ„ï¼šåˆ¤æ–­æ˜¯å¦ç›¸ç­‰è¦ç”¨ä¸¤ä¸ªç­‰å·ã€‚")]),_._v(" "),t("h2",{attrs:{id:"foreach-generate"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#foreach-generate"}},[_._v("#")]),_._v(" Foreach Generate")]),_._v(" "),t("p",[_._v("Foreachå¯¹å…³ç³»ä¸­çš„æ¯ä¸€ä¸ªè®°å½•å¾ªç¯ï¼Œç„¶åæŒ‰æŒ‡å®šæ¨¡å¼ç”Ÿæˆä¸€ä¸ªæ–°çš„å…³ç³»ã€‚")]),_._v(" "),t("p",[_._v("æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š")]),_._v(" "),t("p",[t("em",[_._v("score_c01 = foreach records_c01generate 'Teacher',$1,score;")])]),_._v(" "),t("p",[t("em",[_._v("dump score_c01;")])]),_._v(" "),t("p",[_._v("ç»“æœå¦‚ä¸‹ï¼š")]),_._v(" "),t("p",[_._v("(Teacher,N0101,82)")]),_._v(" "),t("p",[_._v("(Teacher,N0102,59)")]),_._v(" "),t("p",[_._v("(Teacher,N0103,65)")]),_._v(" "),t("p",[_._v("ç”Ÿæˆçš„æ–°çš„å…³ç³»ä¸­åŒ…æ‹¬ä¸‰ä¸ªå­—æ®µï¼Œç¬¬ä¸€ä¸ªå­—æ®µæ˜¯å¸¸é‡ï¼Œç¬¬äºŒä¸ªå­—æ®µæ˜¯å­¦å·ï¼ˆæˆ‘ä»¬æ˜¯é€šè¿‡ç´¢å¼•å·å¼•ç”¨çš„ï¼‰ï¼Œç¬¬ä¸‰ä¸ªå­—æ®µæ˜¯åˆ†æ•°ï¼ˆæˆ‘ä»¬é€šè¿‡å­—æ®µåå¼•ç”¨çš„ï¼‰ã€‚")]),_._v(" "),t("h2",{attrs:{id:"åˆ†ç»„-group"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åˆ†ç»„-group"}},[_._v("#")]),_._v(" åˆ†ç»„ï¼ˆgroupï¼‰")]),_._v(" "),t("p",[_._v("æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š")]),_._v(" "),t("p",[t("em",[_._v("grouped_records = group recordsby classNo parallel 2;")])]),_._v(" "),t("p",[t("em",[_._v("dump grouped_records;")])]),_._v(" "),t("p",[_._v("ç»“æœå¦‚ä¸‹ï¼š")]),_._v(" "),t("p",[_._v("(C02,{(C02,N0203,79),(C02,N0202,82),(C02,N0201,81)})")]),_._v(" "),t("p",[_._v("(C01,{(C01,N0103,65),(C01,N0102,59),(C01,N0101,82)})")]),_._v(" "),t("p",[_._v("(C03,{(C03,N0306,72),(C03,N0302,92),(C03,N0301,56)})")]),_._v(" "),t("p",[_._v("å…¶ä¸­çš„Paraller 2è¡¨ç¤ºå¯ç”¨2ä¸ªReduceæ“ä½œã€‚")]),_._v(" "),t("p",[_._v("å¦‚ä½•ç»Ÿè®¡æ¯ä¸ªç­çº§åŠæ ¼å’Œä¼˜ç§€çš„å­¦ç”Ÿäººæ•°å‘¢ï¼Ÿæ‰§è¡Œä»¥ä¸‹ä¸¤ä¸ªå‘½ä»¤ï¼š")]),_._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[_._v("\n*result "),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v("=")]),_._v(" foreach grouped_records "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("*\n\nâ€‹     *fail "),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v("=")]),_._v("filter records by score "),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v("<")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("60")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(";")]),_._v("*\n\nâ€‹     *excellent "),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v("=")]),_._v("filter records by score "),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(">")]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("90")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(";")]),_._v("*\n\nâ€‹     *generategroup, COUNT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("(")]),_._v("fail"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(")")]),_._v(" as fail, COUNT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("(")]),_._v("excellent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(")")]),_._v(" as excellent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(";")]),_._v("*\n\n*"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(";")]),_._v("*\n")])])]),t("p",[t("em",[_._v("dump result;")])]),_._v(" "),t("p",[_._v("ç»“æœå¦‚ä¸‹ï¼š")]),_._v(" "),t("p",[_._v("(C01,1,0)")]),_._v(" "),t("p",[_._v("(C02,0,0)")]),_._v(" "),t("p",[_._v("(C03,1,1)")]),_._v(" "),t("p",[_._v("é¢˜å¤–è¯ï¼š")]),_._v(" "),t("p",[_._v("flattenæ“ä½œï¼Œå¯ä»¥å°†æ•°æ®æ ¼å¼æ‰å¹³åŒ–ã€‚æˆ‘ä»¬åˆ†åˆ«é€šè¿‡tupleå’Œbagæ¥çœ‹çœ‹flattençš„ä½œç”¨ï¼š")]),_._v(" "),t("p",[_._v("1ï¼‰ Flattenå¯¹tupleçš„ä½œç”¨")]),_._v(" "),t("p",[_._v("æ‰§è¡Œä»¥ä¸‹å‘½ä»¤:")]),_._v(" "),t("p",[t("em",[_._v("a= foreach records generate $0,($1,$2);")])]),_._v(" "),t("p",[t("em",[_._v("dumpa;")])]),_._v(" "),t("p",[_._v("è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š")]),_._v(" "),t("p",[_._v("(C01,(N0101,82))")]),_._v(" "),t("p",[_._v("(C01,(N0102,59))")]),_._v(" "),t("p",[_._v("(C01,(N0103,65))")]),_._v(" "),t("p",[_._v("(C02,(N0201,81))")]),_._v(" "),t("p",[_._v("(C02,(N0202,82))")]),_._v(" "),t("p",[_._v("(C02,(N0203,79))")]),_._v(" "),t("p",[_._v("(C03,(N0301,56))")]),_._v(" "),t("p",[_._v("(C03,(N0302,92))")]),_._v(" "),t("p",[_._v("(C03,(N0306,72))")]),_._v(" "),t("p",[_._v("ç„¶åï¼Œæ‰§è¡Œ:")]),_._v(" "),t("p",[t("em",[_._v("b = foreach a generate $0,flatten($1);")])]),_._v(" "),t("p",[t("em",[_._v("dump b;")])]),_._v(" "),t("p",[_._v("ç»“æœå¦‚ä¸‹ï¼š")]),_._v(" "),t("p",[_._v("(C01,N0101,82)")]),_._v(" "),t("p",[_._v("(C01,N0102,59)")]),_._v(" "),t("p",[_._v("(C01,N0103,65)")]),_._v(" "),t("p",[_._v("(C02,N0201,81)")]),_._v(" "),t("p",[_._v("(C02,N0202,82)")]),_._v(" "),t("p",[_._v("(C02,N0203,79)")]),_._v(" "),t("p",[_._v("(C03,N0301,56)")]),_._v(" "),t("p",[_._v("(C03,N0302,92)")]),_._v(" "),t("p",[_._v("(C03,N0306,72)")]),_._v(" "),t("p",[_._v("ç”±æ­¤çœ‹è§ï¼Œflattenä½œç”¨äºtupleæ—¶ï¼Œå°†flattenå¯¹åº”çš„å­—æ®µï¼ˆtupleï¼‰ä¸­çš„å­—æ®µæ‰å¹³åŒ–ä¸ºå…³ç³»ä¸­çš„å­—æ®µã€‚ï¼ˆä¸çŸ¥é“è¯¥å¦‚ä½•è§£é‡Šæ¯”è¾ƒå¥½ï¼‰")]),_._v(" "),t("p",[_._v("2ï¼‰ Flattenå¯¹bagçš„ä½œç”¨")]),_._v(" "),t("p",[_._v("æ‰§è¡Œä»¥ä¸‹å‘½ä»¤")]),_._v(" "),t("p",[t("em",[_._v("c = foreach records generate $0,{($1),($1,$2)};")])]),_._v(" "),t("p",[t("em",[_._v("dump c;")])]),_._v(" "),t("p",[_._v("ç»“æœå¦‚ä¸‹ï¼š")]),_._v(" "),t("p",[_._v("(C01,{(N0101),(N0101,82)})")]),_._v(" "),t("p",[_._v("(C01,{(N0102),(N0102,59)})")]),_._v(" "),t("p",[_._v("(C01,{(N0103),(N0103,65)})")]),_._v(" "),t("p",[_._v("(C02,{(N0201),(N0201,81)})")]),_._v(" "),t("p",[_._v("(C02,{(N0202),(N0202,82)})")]),_._v(" "),t("p",[_._v("(C02,{(N0203),(N0203,79)})")]),_._v(" "),t("p",[_._v("(C03,{(N0301),(N0301,56)})")]),_._v(" "),t("p",[_._v("(C03,{(N0302),(N0302,92)})")]),_._v(" "),t("p",[_._v("(C03,{(N0306),(N0306,72)})")]),_._v(" "),t("p",[_._v("æ¥ä¸‹æ¥æ‰§è¡Œï¼š")]),_._v(" "),t("p",[t("em",[_._v("d = foreach c generate $0,flatten($1);")])]),_._v(" "),t("p",[t("em",[_._v("dump d;")])]),_._v(" "),t("p",[_._v("ç»“æœå¦‚ä¸‹ï¼š")]),_._v(" "),t("p",[_._v("(C01,N0101)")]),_._v(" "),t("p",[_._v("(C01,N0101,82)")]),_._v(" "),t("p",[_._v("(C01,N0102)")]),_._v(" "),t("p",[_._v("(C01,N0102,59)")]),_._v(" "),t("p",[_._v("(C01,N0103)")]),_._v(" "),t("p",[_._v("(C01,N0103,65)")]),_._v(" "),t("p",[_._v("(C02,N0201)")]),_._v(" "),t("p",[_._v("(C02,N0201,81)")]),_._v(" "),t("p",[_._v("(C02,N0202)")]),_._v(" "),t("p",[_._v("(C02,N0202,82)")]),_._v(" "),t("p",[_._v("(C02,N0203)")]),_._v(" "),t("p",[_._v("(C02,N0203,79)")]),_._v(" "),t("p",[_._v("(C03,N0301)")]),_._v(" "),t("p",[_._v("(C03,N0301,56)")]),_._v(" "),t("p",[_._v("(C03,N0302)")]),_._v(" "),t("p",[_._v("(C03,N0302,92)")]),_._v(" "),t("p",[_._v("(C03,N0306)")]),_._v(" "),t("p",[_._v("(C03,N0306,72)")]),_._v(" "),t("p",[_._v("å¯ä»¥çœ‹å‡ºï¼Œflattenä½œç”¨äºbagæ—¶ï¼Œä¼šæ¶ˆé™¤åµŒå¥—å…³ç³»ï¼Œç”Ÿæˆç±»ä¼¼äºç¬›å¡å°”ä¹˜ç§¯çš„ç»“æœã€‚ï¼ˆä¸å¥½è¡¨è¾¾ï¼Œè¯»è€…å¯ä»¥ç»†ç»†ä½“ä¼šï¼‰ã€‚")]),_._v(" "),t("h2",{attrs:{id:"streamæ“ä½œ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#streamæ“ä½œ"}},[_._v("#")]),_._v(" Streamæ“ä½œ")]),_._v(" "),t("p",[_._v("å¯ä»¥å°†Pythonç¨‹åºåµŒå…¥åˆ°Pigä¸­ä½¿ç”¨ã€‚")]),_._v(" "),t("p",[_._v("å»ºç«‹ä¸€ä¸ªPythonæ–‡ä»¶pass.pyï¼Œå†…å®¹å¦‚ä¸‹ï¼š")]),_._v(" "),t("div",{staticClass:"language-python extra-class"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[_._v("\n\\#! "),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v("/")]),_._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v("/")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[_._v("bin")]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v("/")]),_._v("envpython\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("import")]),_._v(" sys\n\n \n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("for")]),_._v(" line insys"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(".")]),_._v("stdin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(":")]),_._v("\n\nâ€‹     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("(")]),_._v("c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(")")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v("=")]),_._v(" line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(".")]),_._v("split"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(")")]),_._v(" \n\nâ€‹     "),t("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("if")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[_._v("int")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("(")]),_._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(")")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(">=")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("60")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(":")]),_._v("\n\nâ€‹          "),t("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("print")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"%s\\t%s\\t%s"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v("%")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("(")]),_._v("c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(")")]),_._v("\n\n")])])]),t("p",[_._v("æ‰§è¡Œä»¥ä¸‹å‘½ä»¤:")]),_._v(" "),t("p",[t("em",[_._v("define pass "),t("code",[_._v("pass.py")]),_._v(" SHIP('/home/user/pass.py');")])]),_._v(" "),t("p",[t("em",[_._v("records_pass = stream records through pass as(classNo:chararray, studNo:chararray, score:int);")])]),_._v(" "),t("p",[t("em",[_._v("dump records_pass;")])]),_._v(" "),t("p",[_._v("ç»“æœå¦‚ä¸‹ï¼š")]),_._v(" "),t("p",[_._v("(C01,N0101,82)")]),_._v(" "),t("p",[_._v("(C01,N0103,65)")]),_._v(" "),t("p",[_._v("(C02,N0201,81)")]),_._v(" "),t("p",[_._v("(C02,N0202,82)")]),_._v(" "),t("p",[_._v("(C02,N0203,79)")]),_._v(" "),t("p",[_._v("(C03,N0302,92)")]),_._v(" "),t("p",[_._v("(C03,N0306,72)")]),_._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[_._v("\nå¯ä»¥çœ‹å‡ºï¼Œç»Ÿè®¡ç»“æœä¸ºæ‰€æœ‰åŠæ ¼çš„è®°å½•ï¼ˆ"),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(">")]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("60")]),_._v("ï¼‰ã€‚\n\nå…¶ä¸­ï¼Œshipç”¨äºå°†pythonç¨‹åºæäº¤åˆ°Hadoopé›†ç¾¤ä¸­å»ã€‚\n\nè¯·æ³¨æ„ç¬¬ä¸€ä¸ªå‘½ä»¤ä¸­çš„*"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[_._v("`")]),_._v("pass.py"),t("span",{pre:!0,attrs:{class:"token variable"}},[_._v("`")])]),_._v("*ï¼Œä¸æ˜¯ç”¨å•å¼•å·æ‹¬èµ·æ¥çš„ï¼Œæ˜¯ç”¨é”®ç›˜1å·¦è¾¹çš„é‚£ä¸ªé”®ä¸Šçš„å­—ç¬¦æ‹¬èµ·æ¥çš„ã€‚ï¼ˆä¸çŸ¥é“è¿™ä¸ªå­—ç¬¦æ€ä¹ˆç§°å‘¼ï¼ŒåªçŸ¥é“æ˜¯ä¸€ç§æ ‡æ³¨ç¬¦å·ï¼‰\n\n")])])]),t("h2",{attrs:{id:"join"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#join"}},[_._v("#")]),_._v(" Join")]),_._v(" "),t("p",[_._v("å…ˆæ‰§è¡Œä»¥ä¸‹ä¸¤æ¡å‘½ä»¤ï¼š")]),_._v(" "),t("p",[t("em",[_._v("r_student = load'hdfs://localhost:9000/input/student.txt' using PigStorage(',') as (classNo:chararray, studNo: chararray, score: int);")])]),_._v(" "),t("p",[t("em",[_._v("r_teacher2 = load'hdfs://localhost:9000/input/teacher.txt' using PigStorage(',') as (classNo:chararray, teacher: chararray);")])]),_._v(" "),t("p",[_._v("å›åˆ°æœ¬æ–‡å¼€å¤´ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªæ•°æ®æ–‡ä»¶ï¼Œåˆ†åˆ«ä¸ºå­¦ç”Ÿï¼ˆç­çº§ï¼Œå­¦å·ï¼Œæˆç»©ï¼‰ï¼›è€å¸ˆï¼ˆç­çº§ï¼Œå§“åï¼‰ã€‚")]),_._v(" "),t("p",[_._v("æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š")]),_._v(" "),t("p",[t("em",[_._v("r_joined = join r_student by classNo,r_teacher by classNo;")])]),_._v(" "),t("p",[t("em",[_._v("dump r_joined;")])]),_._v(" "),t("p",[_._v("(C01,N0103,65,C01,Zhang)")]),_._v(" "),t("p",[_._v("(C01,N0102,59,C01,Zhang)")]),_._v(" "),t("p",[_._v("(C01,N0101,82,C01,Zhang)")]),_._v(" "),t("p",[_._v("(C02,N0203,79,C02,Sun)")]),_._v(" "),t("p",[_._v("(C02,N0202,82,C02,Sun)")]),_._v(" "),t("p",[_._v("(C02,N0201,81,C02,Sun)")]),_._v(" "),t("p",[_._v("(C03,N0306,72,C03,Wang)")]),_._v(" "),t("p",[_._v("(C03,N0302,92,C03,Wang)")]),_._v(" "),t("p",[_._v("(C03,N0301,56,C03,Wang)")]),_._v(" "),t("p",[_._v("ç±»ä¼¼äºSQLä¸­çš„å†…è¿æ¥Inner Joinã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å¤–è¿æ¥ï¼Œæ¯”å¦‚ï¼š")]),_._v(" "),t("p",[t("em",[_._v("r_joined = join r_student by classNo left outer,r_teacher by classNo;")])]),_._v(" "),t("p",[t("em",[_._v("dump r_joined;")])]),_._v(" "),t("p",[_._v("æ³¨æ„ï¼šleft outer/right outerè¦å†™åœ¨ç¬¬ä¸€ä¸ªå…³ç³»åçš„åé¢ã€‚ä»¥ä¸‹è¯­æ³•æ˜¯é”™è¯¯çš„ï¼š")]),_._v(" "),t("p",[t("em",[_._v("r_joined = join r_student by classNo, r_teacher by classNo leftouter; //é”™è¯¯")])]),_._v(" "),t("h2",{attrs:{id:"cogroup"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cogroup"}},[_._v("#")]),_._v(" COGROUP")]),_._v(" "),t("p",[_._v("Joinçš„æ“ä½œç»“æœæ˜¯å¹³é¢çš„ï¼ˆä¸€ç»„å…ƒç»„ï¼‰ï¼Œè€ŒCOGROUPçš„ç»“æœæ˜¯æœ‰åµŒå¥—ç»“æ„çš„ã€‚")]),_._v(" "),t("p",[_._v("è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š")]),_._v(" "),t("p",[t("em",[_._v("r1 = cogroup r_student by classNo,r_teacher by classNo;")])]),_._v(" "),t("p",[t("em",[_._v("dump r1;")])]),_._v(" "),t("p",[_._v("ç»“æœå¦‚ä¸‹ï¼š")]),_._v(" "),t("p",[_._v("(C01,{(C01,N0103,65),(C01,N0102,59),(C01,N0101,82)},{(C01,Zhang)})")]),_._v(" "),t("p",[_._v("(C02,{(C02,N0203,79),(C02,N0202,82),(C02,N0201,81)},{(C02,Sun)})")]),_._v(" "),t("p",[_._v("(C03,{(C03,N0306,72),(C03,N0302,92),(C03,N0301,56)},{(C03,Wang)})")]),_._v(" "),t("p",[_._v("(C04,{},{(C04,Dong)})")]),_._v(" "),t("p",[_._v("ç”±ç»“æœå¯ä»¥çœ‹å‡ºï¼š")]),_._v(" "),t("p",[_._v("1ï¼‰ cogroupå’Œjoinæ“ä½œç±»ä¼¼ã€‚")]),_._v(" "),t("p",[_._v("2ï¼‰ ç”Ÿæˆçš„å…³ç³»æœ‰3ä¸ªå­—æ®µã€‚ç¬¬ä¸€ä¸ªå­—æ®µä¸ºè¿æ¥å­—æ®µï¼›ç¬¬äºŒä¸ªå­—æ®µæ˜¯ä¸€ä¸ªåŒ…ï¼Œå€¼ä¸ºå…³ç³»1ä¸­çš„æ»¡è¶³åŒ¹é…å…³ç³»çš„æ‰€æœ‰å…ƒç»„ï¼›ç¬¬ä¸‰ä¸ªå­—æ®µä¹Ÿæ˜¯ä¸€ä¸ªåŒ…ï¼Œå€¼ä¸ºå…³ç³»2ä¸­çš„æ»¡è¶³åŒ¹é…å…³ç³»çš„æ‰€æœ‰å…ƒç»„ã€‚")]),_._v(" "),t("p",[_._v("3ï¼‰ ç±»ä¼¼äºJoinçš„å¤–è¿æ¥ã€‚æ¯”å¦‚ç»“æœä¸­çš„ç¬¬å››ä¸ªè®°å½•ï¼Œç¬¬äºŒä¸ªå­—æ®µå€¼ä¸ºç©ºåŒ…ï¼Œå› ä¸ºå…³ç³»1ä¸­æ²¡æœ‰æ»¡è¶³æ¡ä»¶çš„è®°å½•ã€‚å®é™…ä¸Šç¬¬ä¸€æ¡è¯­å¥å’Œä»¥ä¸‹è¯­å¥ç­‰åŒï¼š")]),_._v(" "),t("p",[t("em",[_._v("r1= cogroup r_student by classNo outer,r_teacher by classNo outer;")])]),_._v(" "),t("p",[_._v("å¦‚æœä½ å¸Œæœ›å…³ç³»1æˆ–2ä¸­æ²¡æœ‰åŒ¹é…è®°å½•æ—¶ä¸åœ¨ç»“æœä¸­å‡ºç°ï¼Œåˆ™å¯ä»¥åˆ†åˆ«åœ¨å…³ç³»ä¸­ä½¿ç”¨innerè€Œå…³é”®å­—è¿›è¡Œæ’é™¤ã€‚")]),_._v(" "),t("p",[_._v("æ‰§è¡Œä»¥ä¸‹è¯­å¥ï¼š")]),_._v(" "),t("p",[t("em",[_._v("r1 = cogroup r_student by classNo inner,r_teacher byclassNo outer;")])]),_._v(" "),t("p",[t("em",[_._v("dump r1;")])]),_._v(" "),t("p",[_._v("ç»“æœä¸ºï¼š")]),_._v(" "),t("p",[_._v("(C01,{(C01,N0103,65),(C01,N0102,59),(C01,N0101,82)},{(C01,Zhang)})")]),_._v(" "),t("p",[_._v("(C02,{(C02,N0203,79),(C02,N0202,82),(C02,N0201,81)},{(C02,Sun)})")]),_._v(" "),t("p",[_._v("(C03,{(C03,N0306,72),(C03,N0302,92),(C03,N0301,56)},{(C03,Wang)})")]),_._v(" "),t("p",[_._v("å¦‚å…ˆå‰æˆ‘ä»¬è®²åˆ°çš„flattenï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š")]),_._v(" "),t("p",[t("code",[_._v("r2 = foreach r1 generate flatten($1),flatten($2);")])]),_._v(" "),t("p",[t("code",[_._v("dump r2;")])]),_._v(" "),t("p",[_._v("ç»“æœå¦‚ä¸‹ï¼š")]),_._v(" "),t("p",[_._v("(C01,N0103,65,C01,Zhang)")]),_._v(" "),t("p",[_._v("(C01,N0102,59,C01,Zhang)")]),_._v(" "),t("p",[_._v("(C01,N0101,82,C01,Zhang)")]),_._v(" "),t("p",[_._v("(C02,N0203,79,C02,Sun)")]),_._v(" "),t("p",[_._v("(C02,N0202,82,C02,Sun)")]),_._v(" "),t("p",[_._v("(C02,N0201,81,C02,Sun)")]),_._v(" "),t("p",[_._v("(C03,N0306,72,C03,Wang)")]),_._v(" "),t("p",[_._v("(C03,N0302,92,C03,Wang)")]),_._v(" "),t("p",[_._v("(C03,N0301,56,C03,Wang)")]),_._v(" "),t("h2",{attrs:{id:"cross"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cross"}},[_._v("#")]),_._v(" Cross")]),_._v(" "),t("p",[_._v("æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š")]),_._v(" "),t("p",[t("em",[_._v("r = cross r_student,r_teacher;")])]),_._v(" "),t("p",[t("em",[_._v("dump r;")])]),_._v(" "),t("p",[_._v("ç»“æœå¦‚ä¸‹ï¼š")]),_._v(" "),t("p",[_._v("(C03,N0306,72,C04,Dong)")]),_._v(" "),t("p",[_._v("(C03,N0306,72,C03,Wang)")]),_._v(" "),t("p",[_._v("(C03,N0306,72,C02,Sun)")]),_._v(" "),t("p",[_._v("(C03,N0306,72,C01,Zhang)")]),_._v(" "),t("p",[_._v("(C03,N0302,92,C04,Dong)")]),_._v(" "),t("p",[_._v("(C03,N0302,92,C03,Wang)")]),_._v(" "),t("p",[_._v("(C03,N0302,92,C02,Sun)")]),_._v(" "),t("p",[_._v("(C03,N0302,92,C01,Zhang)")]),_._v(" "),t("p",[_._v("(C03,N0301,56,C04,Dong)")]),_._v(" "),t("p",[_._v("(C03,N0301,56,C03,Wang)")]),_._v(" "),t("p",[_._v("(C03,N0301,56,C02,Sun)")]),_._v(" "),t("p",[_._v("(C03,N0301,56,C01,Zhang)")]),_._v(" "),t("p",[_._v("(C02,N0203,79,C04,Dong)")]),_._v(" "),t("p",[_._v("(C02,N0203,79,C03,Wang)")]),_._v(" "),t("p",[_._v("(C02,N0203,79,C02,Sun)")]),_._v(" "),t("p",[_._v("(C02,N0203,79,C01,Zhang)")]),_._v(" "),t("p",[_._v("(C02,N0202,82,C04,Dong)")]),_._v(" "),t("p",[_._v("(C02,N0202,82,C03,Wang)")]),_._v(" "),t("p",[_._v("(C02,N0202,82,C02,Sun)")]),_._v(" "),t("p",[_._v("(C02,N0202,82,C01,Zhang)")]),_._v(" "),t("p",[_._v("(C02,N0201,81,C04,Dong)")]),_._v(" "),t("p",[_._v("(C02,N0201,81,C03,Wang)")]),_._v(" "),t("p",[_._v("(C02,N0201,81,C02,Sun)")]),_._v(" "),t("p",[_._v("(C02,N0201,81,C01,Zhang)")]),_._v(" "),t("p",[_._v("(C01,N0103,65,C04,Dong)")]),_._v(" "),t("p",[_._v("(C01,N0103,65,C03,Wang)")]),_._v(" "),t("p",[_._v("(C01,N0103,65,C02,Sun)")]),_._v(" "),t("p",[_._v("(C01,N0103,65,C01,Zhang)")]),_._v(" "),t("p",[_._v("(C01,N0102,59,C04,Dong)")]),_._v(" "),t("p",[_._v("(C01,N0102,59,C03,Wang)")]),_._v(" "),t("p",[_._v("(C01,N0102,59,C02,Sun)")]),_._v(" "),t("p",[_._v("(C01,N0102,59,C01,Zhang)")]),_._v(" "),t("p",[_._v("(C01,N0101,82,C04,Dong)")]),_._v(" "),t("p",[_._v("(C01,N0101,82,C03,Wang)")]),_._v(" "),t("p",[_._v("(C01,N0101,82,C02,Sun)")]),_._v(" "),t("p",[_._v("(C01,N0101,82,C01,Zhang)")]),_._v(" "),t("p",[_._v("ç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œcrossç±»ä¼¼äºç¬›å¡å°”ä¹˜ç§¯ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ä¸å»ºè®®ç›´æ¥ä½¿ç”¨crossï¼Œè€Œåº”è¯¥äº‹å‰å¯¹æ•°æ®é›†è¿›è¡Œç­›é€‰ï¼Œæé«˜æ•ˆç‡ã€‚")]),_._v(" "),t("h2",{attrs:{id:"æ’åº-order"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ’åº-order"}},[_._v("#")]),_._v(" æ’åºï¼ˆOrderï¼‰")]),_._v(" "),t("p",[_._v("æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š")]),_._v(" "),t("p",[t("em",[_._v("r = order r_student by score desc, classNo asc;")])]),_._v(" "),t("p",[t("em",[_._v("dump r;")])]),_._v(" "),t("p",[_._v("ç»“æœå¦‚ä¸‹ï¼š")]),_._v(" "),t("p",[_._v("(C03,N0302,92)")]),_._v(" "),t("p",[_._v("(C01,N0101,82)")]),_._v(" "),t("p",[_._v("(C02,N0202,82)")]),_._v(" "),t("p",[_._v("(C02,N0201,81)")]),_._v(" "),t("p",[_._v("(C02,N0203,79)")]),_._v(" "),t("p",[_._v("(C03,N0306,72)")]),_._v(" "),t("p",[_._v("(C01,N0103,65)")]),_._v(" "),t("p",[_._v("(C01,N0102,59)")]),_._v(" "),t("p",[_._v("(C03,N0301,56)")]),_._v(" "),t("h2",{attrs:{id:"è”åˆ-union"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#è”åˆ-union"}},[_._v("#")]),_._v(" è”åˆï¼ˆUnionï¼‰")]),_._v(" "),t("p",[_._v("æ‰§è¡Œä»¥ä¸‹è¯­å¥ï¼š")]),_._v(" "),t("p",[t("em",[_._v("r_union = union r_student, r_teacher;")])]),_._v(" "),t("p",[t("em",[_._v("dump r_union;")])]),_._v(" "),t("p",[_._v("ç»“æœå¦‚ä¸‹ï¼š")]),_._v(" "),t("p",[_._v("(C01,N0101,82)")]),_._v(" "),t("p",[_._v("(C01,N0102,59)")]),_._v(" "),t("p",[_._v("(C01,N0103,65)")]),_._v(" "),t("p",[_._v("(C02,N0201,81)")]),_._v(" "),t("p",[_._v("(C02,N0202,82)")]),_._v(" "),t("p",[_._v("(C02,N0203,79)")]),_._v(" "),t("p",[_._v("(C03,N0301,56)")]),_._v(" "),t("p",[_._v("(C03,N0302,92)")]),_._v(" "),t("p",[_._v("(C03,N0306,72)")]),_._v(" "),t("p",[_._v("(C01,Zhang)")]),_._v(" "),t("p",[_._v("(C02,Sun)")]),_._v(" "),t("p",[_._v("(C03,Wang)")]),_._v(" "),t("p",[_._v("(C04,Dong)")]),_._v(" "),t("p",[_._v("å¯ä»¥çœ‹å‡ºï¼š")]),_._v(" "),t("p",[_._v("1ï¼‰ unionæ˜¯å–ä¸¤ä¸ªè®°å½•é›†çš„å¹¶é›†ã€‚")]),_._v(" "),t("p",[_._v("2ï¼‰ å…³ç³»r_unionçš„schemaä¸ºæœªçŸ¥ï¼ˆunknownï¼‰ï¼Œè¿™æ˜¯å› ä¸ºè¢«unionçš„ä¸¤ä¸ªå…³ç³»çš„schemaæ˜¯ä¸ä¸€æ ·çš„ã€‚å¦‚æœä¸¤ä¸ªå…³ç³»çš„schemaæ˜¯ä¸€è‡´çš„ï¼Œåˆ™unionåçš„å…³ç³»å°†å’Œè¢«unionçš„å…³ç³»çš„schemaä¸€è‡´ã€‚")]),_._v(" "),t("h2",{attrs:{id:"å‚è€ƒæ–‡ç« "}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å‚è€ƒæ–‡ç« "}},[_._v("#")]),_._v(" å‚è€ƒæ–‡ç« ")]),_._v(" "),t("ul",[t("li",[_._v("https://blog.csdn.net/yz930618/article/details/80701617")]),_._v(" "),t("li",[_._v("https://blog.csdn.net/zythy/article/details/18426347")])])])}),[],!1,null,null,null);v.default=r.exports}}]);