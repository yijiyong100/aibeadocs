(window.webpackJsonp=window.webpackJsonp||[]).push([[509],{1025:function(a,s,t){"use strict";t.r(s);var n=t(53),e=Object(n.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),t("p",[a._v("本文主要是介绍 Kibana-入门介绍 。")])]),a._v(" "),t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#kibana快速介绍"}},[a._v("Kibana快速介绍")])]),t("li",[t("a",{attrs:{href:"#kibana介绍"}},[a._v("Kibana介绍")])]),t("li",[t("a",{attrs:{href:"#kibana安装"}},[a._v("Kibana安装")]),t("ul",[t("li",[t("a",{attrs:{href:"#_1、下载kibana安装包"}},[a._v("1、下载Kibana安装包：")])]),t("li",[t("a",{attrs:{href:"#_2、运行kibana"}},[a._v("2、运行Kibana")])]),t("li",[t("a",{attrs:{href:"#_3、配置文件"}},[a._v("3、配置文件")])])])]),t("li",[t("a",{attrs:{href:"#导入测试数据"}},[a._v("导入测试数据")])]),t("li",[t("a",{attrs:{href:"#参考文章"}},[a._v("参考文章")])])])]),t("p"),a._v(" "),t("h2",{attrs:{id:"kibana快速介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kibana快速介绍"}},[a._v("#")]),a._v(" Kibana快速介绍")]),a._v(" "),t("blockquote",[t("p",[a._v("本文作者：罗海鹏，叩丁狼高级讲师。原创文章，转载请注明出处。")])]),a._v(" "),t("h2",{attrs:{id:"kibana介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kibana介绍"}},[a._v("#")]),a._v(" Kibana介绍")]),a._v(" "),t("p",[a._v("Kibana是一个开源的分析与可视化平台，设计出来用于和Elasticsearch一起使用的。你可以用kibana搜索、查看存放在Elasticsearch中的数据。Kibana与Elasticsearch的交互方式是各种不同的图表、表格、地图等，直观的展示数据，从而达到高级的数据分析与可视化的目的。")]),a._v(" "),t("p",[a._v("Elasticsearch、Logstash和Kibana这三个技术就是我们常说的ELK技术栈，可以说这三个技术的组合是大数据领域中一个很巧妙的设计。一种很典型的MVC思想，模型持久层，视图层和控制层。Logstash担任控制层的角色，负责搜集和过滤数据。Elasticsearch担任数据持久层的角色，负责储存数据。而我们这章的主题Kibana担任视图层角色，拥有各种维度的查询和分析，并使用图形化的界面展示存放在Elasticsearch中的数据。")]),a._v(" "),t("h2",{attrs:{id:"kibana安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kibana安装"}},[a._v("#")]),a._v(" Kibana安装")]),a._v(" "),t("h3",{attrs:{id:"_1、下载kibana安装包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、下载kibana安装包"}},[a._v("#")]),a._v(" 1、下载Kibana安装包：")]),a._v(" "),t("blockquote",[t("p",[a._v("https://www.elastic.co/downloads/kibana")])]),a._v(" "),t("p",[a._v("以上地址为Kibana官网下载的地址，目前最新版为6.3.2，Kibana版本和Elasticsearch版本同步更新，所以我们最好使用一致的版本，而我们Elasticsearch使用的版本是6.2.4，所以我们Kibana也需要下载6.2.4。在下载页面点击"),t("strong",[a._v("past releases")]),a._v("连接，进入历史版本下载界面，选择6.2.4版本，我们下载tar格式的压缩包，包的全名为：kibana-6.2.4-linux-x86_64.tar.gz。")]),a._v(" "),t("h3",{attrs:{id:"_2、运行kibana"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、运行kibana"}},[a._v("#")]),a._v(" 2、运行Kibana")]),a._v(" "),t("p",[a._v("把Kibana的安装包上传到Linux并解压，进入bin目录可以看到有个名字为Kibana的脚本，该脚本就是启动Kibana的脚本程序，直接执行即可运行Kibana实例：")]),a._v(" "),t("p",[t("code",[a._v("$ ./kibana")])]),a._v(" "),t("p",[a._v("我们在执行kibana启动脚本后，看到控制台打印的信息，发现kibana启动就马上去连接Elasticsearch服务,打印信息如下：")]),a._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[a._v("log   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("17")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("40")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("27.350")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("warning"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("admin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("elasticsearch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Unable")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("to")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[a._v("revive")]),a._v(" connection"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" http"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("localhost"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("9200")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("\nlog   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("17")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("40")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("27.355")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("warning"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("admin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("elasticsearch"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("No")]),a._v(" living connections\n")])])]),t("p",[a._v("通过控制台的打印信息，我们可以知道，Kibana试图连接本机IP的Elasticsearch服务，但是连接不上，那是因为我们还没有把Elasticsearch启动起来。一旦我们把Elasticsearch服务启动起来了，就可以看到以下信息：")]),a._v(" "),t("div",{staticClass:"language-css extra-class"},[t("pre",{pre:!0,attrs:{class:"language-css"}},[t("code",[a._v("log   [17"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("45"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("06.851] [info][status]["),t("span",{pre:!0,attrs:{class:"token property"}},[a._v("plugin")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("elasticsearch@6.2.4] Status changed from red to green - Ready\n")])])]),t("p",[a._v("通过上面的信息我们知道，Kibana的状态是正常的，能连接上elasticsearch服务")]),a._v(" "),t("p",[a._v("kibana默认的端口是5601，给Linux防火墙打开5601的端口后，在另一台windows系统的主机中的浏览器访问Kibana，发现无法访问，原因是因为Kibana默认情况下只能给本机访问，不能远程访问，如果想要远程访问Kibana服务，则需要修改配置文件，那接下来我们看看Kibana有哪些关键的配置。")]),a._v(" "),t("h3",{attrs:{id:"_3、配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3、配置文件"}},[a._v("#")]),a._v(" 3、配置文件")]),a._v(" "),t("p",[a._v("Kibana的配置文件在kibana/config目录中，文件名为kibana.yml。我们使用vi编辑器打开后可以看到，该文件所有的配置都是注释掉的，说明所有的配置都是使用默认的，那如果我们需要修改这些默认的配置，就需要找到对应的配置属性，注释解开，然后填写我们自己想要的值。")]),a._v(" "),t("p",[t("strong",[a._v("1、服务的端口配置")]),a._v("：")]),a._v(" "),t("p",[a._v("属性名为："),t("code",[a._v("server.port")]),a._v("默认是5601")]),a._v(" "),t("p",[t("strong",[a._v("2、允许远程访问的地址配置")]),a._v("：")]),a._v(" "),t("p",[a._v("属性名为："),t("code",[a._v("server.host")]),a._v("默认为本机，如果我们需要把Kibana服务给远程主机访问，只需要在这个配置中填写远程的那台主机的ip地址，那如果我们希望所有的远程主机都能访问，那就填写"),t("code",[a._v("0.0.0.0")])]),a._v(" "),t("p",[t("strong",[a._v("3、连接Elasticsearch服务配置")])]),a._v(" "),t("p",[a._v("属性名为："),t("code",[a._v("elasticsearch.url")]),a._v("默认为连接到本机的elasticsearch，并且端口为9200，也就是为localhost:9200，如果我们Elasticsearch不是与Kibana安装在同一台主机上，或者Elasticsearch的端口号不是9200，就就需要修改这个配置了")]),a._v(" "),t("p",[t("strong",[a._v("4、Elasticsearch的用户名和密码")])]),a._v(" "),t("p",[a._v("属性名为："),t("code",[a._v("elasticsearch.username")]),a._v("和"),t("code",[a._v("elasticsearch.password")]),a._v("，默认是没有用户名和密码，如果elasticsearch是配置了用户名和密码的，那就需要配置这两行属性")]),a._v(" "),t("p",[t("strong",[a._v("5、访问Kibana服务")])]),a._v(" "),t("p",[a._v("相关的配置修改好了后，就可以使用浏览器访问kibana了，看到如下界面：")]),a._v(" "),t("img",{staticClass:"zoom-custom-imgs",attrs:{src:a.$withBase("/assets/img/es/kibana/intro-1.png"),alt:"wxmp"}}),a._v(" "),t("p",[a._v("Kibana界面")]),a._v(" "),t("h2",{attrs:{id:"导入测试数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#导入测试数据"}},[a._v("#")]),a._v(" 导入测试数据")]),a._v(" "),t("p",[a._v("由于当前我们的Elasticsearch数据量比较少，没办法充分发挥Kibana的作用，很多高级的数据分析和图形化界面都没法展示出来，所以我们需要导入一些测试数据到Elasticsearch中。")]),a._v(" "),t("p",[t("strong",[a._v("数据说明")])]),a._v(" "),t("p",[a._v("为了更好的学习Kibana各个功能的使用，我们导入3种不同类型的数据：")]),a._v(" "),t("ul",[t("li",[a._v("1、莎士比亚的所有著作")]),a._v(" "),t("li",[a._v("2、虚构的账号数据")]),a._v(" "),t("li",[a._v("3、随机生成的日志文件")])]),a._v(" "),t("p",[a._v("在导入数据之前，我们需要给各个类型的数据创建类型映射。")]),a._v(" "),t("p",[t("strong",[a._v("创建莎士比亚的所有著作的数据类型映射")])]),a._v(" "),t("p",[a._v("莎士比亚的所有著作的测试数据的字段有以下这些：")]),a._v(" "),t("p",[a._v("line_id、play_name、speech_number、line_number、speaker、text_entry")]),a._v(" "),t("p",[a._v("我们用以下DSL为该数据创建类型映射（其他没有在映射中约束的字段，使用默认约束）：")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("PUT /shakespeare\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"mappings"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"_default_"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n   "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"properties"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"speaker"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"type"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"keyword"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"play_name"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"type"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"keyword"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"line_id"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"type"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"integer"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"speech_number"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"type"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"integer"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("p",[a._v("映射解析：")]),a._v(" "),t("ul",[t("li",[a._v("1、speaker和play_name是关键字字段，因此不会分词。")]),a._v(" "),t("li",[a._v("2、line_id和speech_number是一个整数。")])]),a._v(" "),t("p",[t("strong",[a._v("创建日志数据类型映射")])]),a._v(" "),t("p",[a._v("日志数据有几十个不同的字段，但是在教程中关注的字段如下：")]),a._v(" "),t("p",[a._v("memory、geo.coordinates、"),t("a",{attrs:{href:"https://github.com/timestamp",target:"_blank",rel:"noopener noreferrer"}},[a._v("@timestamp"),t("OutboundLink")],1)]),a._v(" "),t("p",[a._v("我们用以下DSL为该数据创建类型映射：")]),a._v(" "),t("p",[a._v("2015.05.18的日志数据映射")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("PUT logstash-2015.05.18\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"mappings"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"log"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"properties"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"geo"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n          "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"properties"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"coordinates"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n              "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"type"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"geo_point"')]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("p",[a._v("2015.05.19的日志数据映射")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("PUT logstash-2015.05.19\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"mappings"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"log"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"properties"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"geo"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n          "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"properties"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"coordinates"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n              "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"type"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"geo_point"')]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("p",[a._v("2015.05.20的日志数据映射")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("PUT logstash-2015.05.20\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"mappings"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"log"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"properties"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"geo"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n          "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"properties"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"coordinates"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n              "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"type"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"geo_point"')]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("p",[a._v("映射解析：\n日志数据需要一个表明地理位置的经纬度，通过在那些字段使用一个geo_point类型。")]),a._v(" "),t("p",[t("strong",[a._v("创建账号信息数据类型映射")]),a._v("\n账号信息测试数据的字段有以下这些：")]),a._v(" "),t("p",[a._v("account_number、balance、firstname、lastname、age、gender、address、employer、city、state")]),a._v(" "),t("p",[a._v("账号数据的各个字段不需要任何约束映射，全都使用默认即可")]),a._v(" "),t("p",[t("strong",[a._v("导入数据")])]),a._v(" "),t("p",[a._v("测试数据下载：")]),a._v(" "),t("blockquote",[t("p",[a._v("https://pan.baidu.com/s/1r--IISJ_8ypRznUx-0aFYw")])]),a._v(" "),t("p",[a._v("下载好了之后，上传到Linux上，执行elasticsearch的数据批量导入命令：")]),a._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" -XPOST "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'localhost:9200/bank/account/_bulk?pretty'")]),a._v(" --data-binary @accounts.json\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" -XPOST "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'localhost:9200/shakespeare/_bulk?pretty'")]),a._v(" --data-binary @shakespeare.json\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" -XPOST "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'localhost:9200/_bulk?pretty'")]),a._v(" --data-binary @logs.jsonl\n")])])]),t("p",[a._v("导入这些数据需要一点时间，具体根据主机性能而定。导入完之后，可以执行数据查看命令：")]),a._v(" "),t("p",[t("code",[a._v("curl 'localhost:9200/_cat/indices?v'")])]),a._v(" "),t("p",[a._v("输出结果如下：")]),a._v(" "),t("div",{staticClass:"language-css extra-class"},[t("pre",{pre:!0,attrs:{class:"language-css"}},[t("code",[a._v("health status index               pri rep docs.count docs.deleted store.size pri.store.size\nyellow open   bank                  5   1       1000            0    418.2kb        418.2kb\nyellow open   shakespeare           5   1     111396            0     17.6mb         17.6mb\nyellow open   logstash-2015.05.18   5   1       4631            0     15.6mb         15.6mb\nyellow open   logstash-2015.05.19   5   1       4624            0     15.7mb         15.7mb\nyellow open   logstash-2015.05.20   5   1       4750            0     16.4mb         16.4mb\n")])])]),t("p",[a._v("通过以上的输出结果，可以看到我们新增的3个测试数据shakespeare，bank和logstash*的数据都导入进去了。那接下来我们就来开始学习Kibana的使用。")]),a._v(" "),t("h2",{attrs:{id:"参考文章"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[a._v("#")]),a._v(" 参考文章")]),a._v(" "),t("ul",[t("li",[a._v("https://www.jianshu.com/p/8001ac47c378")])])])}),[],!1,null,null,null);s.default=e.exports}}]);