(window.webpackJsonp=window.webpackJsonp||[]).push([[513],{1029:function(s,t,a){"use strict";a.r(t);var e=a(53),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),a("p",[s._v("本文主要是介绍 Logstash-安装使用 。")])]),s._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#logstash使用详解"}},[s._v("Logstash使用详解")])]),a("li",[a("a",{attrs:{href:"#下载、安装、使用"}},[s._v("下载、安装、使用")])]),a("li",[a("a",{attrs:{href:"#工作原理"}},[s._v("工作原理")])]),a("li",[a("a",{attrs:{href:"#命令行中常用的命令"}},[s._v("命令行中常用的命令")])]),a("li",[a("a",{attrs:{href:"#配置文件说明"}},[s._v("配置文件说明")])]),a("li",[a("a",{attrs:{href:"#参考"}},[s._v("参考")])]),a("li",[a("a",{attrs:{href:"#参考文章"}},[s._v("参考文章")])])])]),a("p"),s._v(" "),a("h2",{attrs:{id:"logstash使用详解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#logstash使用详解"}},[s._v("#")]),s._v(" Logstash使用详解")]),s._v(" "),a("blockquote",[a("p",[s._v("Logstash是一款轻量级的日志搜集处理框架，可以方便的把分散的、多样化的日志搜集起来，并进行自定义的处理，然后传输到指定的位置，比如某个服务器或者文件。")]),s._v(" "),a("p",[s._v("本文针对"),a("a",{attrs:{href:"https://www.elastic.co/guide/en/logstash/current/index.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),a("OutboundLink")],1),s._v("进行翻译以及实践，希望有更多的有用户了解、使用这款工具。")])]),s._v(" "),a("h2",{attrs:{id:"下载、安装、使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#下载、安装、使用"}},[s._v("#")]),s._v(" 下载、安装、使用")]),s._v(" "),a("p",[s._v("这款工具是开箱即用的软件，"),a("a",{attrs:{href:"https://www.elastic.co/downloads/logstash",target:"_blank",rel:"noopener noreferrer"}},[s._v("下载地址戳这里"),a("OutboundLink")],1),s._v("，下载自己对应的系统版本即可。")]),s._v(" "),a("img",{staticClass:"zoom-custom-imgs",attrs:{src:s.$withBase("/assets/img/es/logstash/install/449064-20150912114217028-2060652.png"),alt:"wxmp"}}),s._v(" "),a("p",[s._v("下载后直接解压，就可以了。")]),s._v(" "),a("p",[s._v("通过命令行，进入到logstash/bin目录，执行下面的命令：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("logstash -e "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n")])])]),a("p",[s._v("可以看到提示下面信息（这个命令稍后介绍），"),a("strong",[s._v("输入hello world!")])]),s._v(" "),a("img",{staticClass:"zoom-custom-imgs",attrs:{src:s.$withBase("/assets/img/es/logstash/install/449064-20150912120946325-1382526148.png"),alt:"wxmp"}}),s._v(" "),a("p",[s._v("可以看到logstash尾我们自动添加了几个字段，时间戳@timestamp，版本@version，输入的类型type，以及主机名host。")]),s._v(" "),a("h2",{attrs:{id:"工作原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#工作原理"}},[s._v("#")]),s._v(" 工作原理")]),s._v(" "),a("p",[s._v("Logstash使用管道方式进行日志的搜集处理和输出。有点类似*NIX系统的管道命令 "),a("strong",[s._v("xxx | ccc | ddd")]),s._v("，xxx执行完了会执行ccc，然后执行ddd。")]),s._v(" "),a("p",[s._v("在logstash中，包括了三个阶段:")]),s._v(" "),a("p",[a("strong",[s._v("输入input --\x3e 处理filter（不是必须的） --\x3e 输出output")])]),s._v(" "),a("img",{staticClass:"zoom-custom-imgs",attrs:{src:s.$withBase("/assets/img/es/logstash/install/449064-20150912115455559-525747352.png"),alt:"wxmp"}}),s._v(" "),a("p",[s._v("每个阶段都由很多的插件配合工作，比如file、elasticsearch、redis等等。")]),s._v(" "),a("p",[s._v("每个阶段也可以指定多种方式，比如输出既可以输出到elasticsearch中，也可以指定到stdout在控制台打印。")]),s._v(" "),a("p",[s._v("由于这种插件式的组织方式，使得logstash变得易于扩展和定制。")]),s._v(" "),a("h2",{attrs:{id:"命令行中常用的命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令行中常用的命令"}},[s._v("#")]),s._v(" 命令行中常用的命令")]),s._v(" "),a("p",[s._v("-f：通过这个命令可以指定Logstash的配置文件，根据配置文件配置logstash")]),s._v(" "),a("img",{staticClass:"zoom-custom-imgs",attrs:{src:s.$withBase("/assets/img/es/logstash/install/449064-20150912122337965-1219152269.png"),alt:"wxmp"}}),s._v(" "),a("p",[s._v("-e：后面跟着字符串，该字符串可以被当做logstash的配置（如果是“” 则默认使用stdin作为输入，stdout作为输出）")]),s._v(" "),a("img",{staticClass:"zoom-custom-imgs",attrs:{src:s.$withBase("/assets/img/es/logstash/install/449064-20150912121208137-496683476.png"),alt:"wxmp"}}),s._v(" "),a("p",[s._v("-l：日志输出的地址（默认就是stdout直接在控制台中输出）")]),s._v(" "),a("p",[s._v("-t：测试配置文件是否正确，然后退出。")]),s._v(" "),a("img",{staticClass:"zoom-custom-imgs",attrs:{src:s.$withBase("/assets/img/es/logstash/install/449064-20150912122104215-1167629390.png"),alt:"wxmp"}}),s._v(" "),a("h2",{attrs:{id:"配置文件说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置文件说明"}},[s._v("#")]),s._v(" 配置文件说明")]),s._v(" "),a("p",[s._v("前面介绍过logstash基本上由三部分组成，input、output以及用户需要才添加的filter，因此标准的配置文件格式如下：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("input "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \nfilter "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \noutput "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("img",{staticClass:"zoom-custom-imgs",attrs:{src:s.$withBase("/assets/img/es/logstash/install/449064-20150912120202262-1671564203.png"),alt:"wxmp"}}),s._v(" "),a("p",[s._v("在每个部分中，也可以指定多个访问方式，例如我想要指定两个日志来源文件，则可以这样写：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("input "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" path "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/log/messages"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"syslog"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" path "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/log/apache/access.log"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"apache"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("类似的，如果在filter中添加了多种处理规则，则按照它的顺序一一处理，但是有一些插件并不是线程安全的。")]),s._v(" "),a("p",[s._v("比如在filter中指定了两个一样的的插件，这两个任务并不能保证准确的按顺序执行，因此官方也推荐避免在filter中重复使用插件。")]),s._v(" "),a("p",[s._v("说完这些，简单的创建一个配置文件的小例子看看：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("input "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("　　　　 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#指定监听的文件路径，注意必须是绝对路径")]),s._v("\n        path "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"E:/software/logstash-1.5.4/logstash-1.5.4/data/test.log"')]),s._v("\n        start_position "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" beginning\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nfilter "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\noutput "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    stdout "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("日志大致如下：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" hello,this is first line "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" test.log"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" hello,my name is xingoo"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" goodbye.this is last line "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" test.log"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" \n")])])]),a("p",[s._v("注意最后有一个空行。")]),s._v(" "),a("p",[s._v("执行命令得到如下信息：")]),s._v(" "),a("img",{staticClass:"zoom-custom-imgs",attrs:{src:s.$withBase("/assets/img/es/logstash/install/449064-20150912122348497-608458129.png"),alt:"wxmp"}}),s._v(" "),a("p",[s._v('细心的会发现，这个日志输出与上面的logstash -e "" 并不相同，这是因为上面的命令默认指定了返回的格式是json形式。')]),s._v(" "),a("p",[s._v("至此，就是logstash入门篇的介绍了，稍后会介绍关于logstash更多的内容，感兴趣的可以关注哦！")]),s._v(" "),a("h2",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),a("p",[s._v("【1】Logstash官方文档："),a("a",{attrs:{href:"https://www.elastic.co/guide/en/logstash/current/index.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.elastic.co/guide/en/logstash/current/index.html　"),a("OutboundLink")],1),a("a",{attrs:{href:"https://www.elastic.co/guide/en/logstash/current/index.html",target:"_blank",rel:"noopener noreferrer"}},[a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("作者："),a("a",{attrs:{href:"http://www.cnblogs.com/xing901022",target:"_blank",rel:"noopener noreferrer"}},[s._v("xingoo"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("出处：http://www.cnblogs.com/xing901022")]),s._v(" "),a("p",[s._v("本文版权归作者和博客园共有。欢迎转载，但必须保留此段声明，且在文章页面明显位置给出原文连接！")]),s._v(" "),a("h2",{attrs:{id:"参考文章"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[s._v("#")]),s._v(" 参考文章")]),s._v(" "),a("ul",[a("li",[s._v("http://www.cnblogs.com/xing901022")])])])}),[],!1,null,null,null);t.default=n.exports}}]);