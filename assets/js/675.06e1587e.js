(window.webpackJsonp=window.webpackJsonp||[]).push([[675],{1191:function(a,e,s){"use strict";s.r(e);var t=s(53),r=Object(t.a)({},(function(){var a=this,e=a.$createElement,s=a._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),s("p",[a._v("本文主要是介绍 Zookeeper-安装和配置 。")])]),a._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#zookeeper-2、zookeeper的安装和配置-集群模式"}},[a._v("Zookeeper 2、Zookeeper的安装和配置（集群模式）")])]),s("li",[s("a",{attrs:{href:"#_1、下载与解压"}},[a._v("1、下载与解压")])]),s("li",[s("a",{attrs:{href:"#_2、zooker配置"}},[a._v("2、Zooker配置")])]),s("li",[s("a",{attrs:{href:"#_3、配置zookeeper的环境变量"}},[a._v("3、配置zookeeper的环境变量")])]),s("li",[s("a",{attrs:{href:"#_4-启动zookeeper-所有节点都要启动"}},[a._v("4.启动zookeeper(所有节点都要启动)")])]),s("li",[s("a",{attrs:{href:"#参考文章"}},[a._v("参考文章")])])])]),s("p"),a._v(" "),s("h2",{attrs:{id:"zookeeper-2、zookeeper的安装和配置-集群模式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper-2、zookeeper的安装和配置-集群模式"}},[a._v("#")]),a._v(" Zookeeper 2、Zookeeper的安装和配置（集群模式）")]),a._v(" "),s("h2",{attrs:{id:"_1、下载与解压"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1、下载与解压"}},[a._v("#")]),a._v(" 1、下载与解压")]),a._v(" "),s("p",[a._v("Zookeeper下载地址：http://www.apache.org/dyn/closer.cgi/zookeeper/")]),a._v(" "),s("p",[a._v("下载完成以后解压到一个特定目录")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("同步时间所有节点的时间，并关闭防火墙\n$ ntpdate -u ntp.sjtu.edu.cn\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" iptables stop\n")])])]),s("h2",{attrs:{id:"_2、zooker配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2、zooker配置"}},[a._v("#")]),a._v(" 2、Zooker配置")]),a._v(" "),s("p",[a._v("Zookeeper集群模式至少需要3台主机进行搭建，准备三台主机Serve1、Server2、Server3")]),a._v(" "),s("p",[a._v("在Zookeeper的conf目录下创建myid文件，server1机器的内容为：1，server2机器的内容为：2，server3机器的内容为：3\n在conf目录下创建一个配置文件zoo.cfg(标红的最主要)：")]),a._v(" "),s("p",[a._v("["),s("img",{attrs:{src:"https://common.cnblogs.com/images/copycode.gif",alt:"复制代码"}}),a._v("](javascript:void(0)😉")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("tickTime")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("dataDir")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/Users/zdandljb/zookeeper/data\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("dataLogDir")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/Users/zdandljb/zookeeper/dataLog\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("clientPort")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2181")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("initLimit")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("syncLimit")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("\nserver.1"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("server1:2888:3888\nserver.2"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("server2:2888:3888\nserver.3"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("server3:2888:3888\n")])])]),s("p",[a._v("配置完成以后把配置文件分发到其他的主机上；")]),a._v(" "),s("p",[a._v("参数解释:")]),a._v(" "),s("ul",[s("li",[a._v("tickTime：发送心跳的间隔时间，单位：毫秒")]),a._v(" "),s("li",[a._v("dataDir：zookeeper保存数据的目录。")]),a._v(" "),s("li",[a._v("clientPort：客户端连接 Zookeeper 服务器的端口，Zookeeper 会监听这个端口，接受客户端的访问请求。")]),a._v(" "),s("li",[a._v("initLimit： 这个配置项是用来配置 Zookeeper 接受客户端（这里所说的客户端不是用户连接 Zookeeper 服务器的客户端，")])]),a._v(" "),s("p",[a._v("而是 Zookeeper 服务器集群中连接到 Leader 的Follower 服务器）初始化连接时最长能忍受多少个心跳时间间隔数。")]),a._v(" "),s("p",[a._v("当已经超过 5 个心跳的时间（也就是 tickTime）长度后 Zookeeper 服务器还没有收到客户端的返回信息，那么表明这个客户端连接失败。")]),a._v(" "),s("p",[a._v("总的时间长度就是 5*2000=10 秒")]),a._v(" "),s("p",[a._v("syncLimit：这个配置项标识 Leader 与 Follower 之间发送消息，请求和应答时间长度，最长不能超过多少个 tickTime 的时间长度，")]),a._v(" "),s("p",[a._v("总的时间长度就是 2*2000=4 秒")]),a._v(" "),s("p",[a._v("server.A=B：C：D：其 中")]),a._v(" "),s("p",[a._v("A 是一个数字，表示这个是第几号服务器；")]),a._v(" "),s("p",[a._v("B 是这个服务器的 ip地址；")]),a._v(" "),s("p",[a._v("C 表示的是这个服务器与集群中的 Leader 服务器交换信息的端口；")]),a._v(" "),s("p",[a._v("D 表示的是万一集群中的 Leader 服务器挂了，需要一个端口来重新进行选举，选出一个新的 Leader，")]),a._v(" "),s("p",[a._v("而这个端口就是用来执行选举时服务器相互通信的端口。如果是伪集群的配置方式，由于 B 都是一样，")]),a._v(" "),s("p",[a._v("所以不同的 Zookeeper 实例通信端口号不能一样，所以要给它们分配不同的端口号。")]),a._v(" "),s("h2",{attrs:{id:"_3、配置zookeeper的环境变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3、配置zookeeper的环境变量"}},[a._v("#")]),a._v(" 3、配置zookeeper的环境变量")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" /root/.bash`"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("profile"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("写入"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("PATH")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$PATH")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("/usr/local/zookeeper-"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3.4")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("6")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("`/bin\n")])])]),s("h2",{attrs:{id:"_4-启动zookeeper-所有节点都要启动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-启动zookeeper-所有节点都要启动"}},[a._v("#")]),a._v(" 4.启动zookeeper(所有节点都要启动)")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /usr/local/zookeeper`"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("$ bin/zkServer.sh start"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" `显示：Starting zookeeper "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(". STARTED 表示启动成功\n")])])]),s("p"),a._v(" "),s("h2",{attrs:{id:"参考文章"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[a._v("#")]),a._v(" 参考文章")]),a._v(" "),s("ul",[s("li",[a._v("https://www.cnblogs.com/raphael5200/p/5285380.html")])])])}),[],!1,null,null,null);e.default=r.exports}}]);