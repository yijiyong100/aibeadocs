(window.webpackJsonp=window.webpackJsonp||[]).push([[681],{1197:function(s,t,a){"use strict";a.r(t);var n=a(53),r=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),a("p",[s._v("本文主要是介绍 备份与恢复-精华知识总结 。")])]),s._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#mysql备份与恢复"}},[s._v("mysql备份与恢复")])]),a("li",[a("a",{attrs:{href:"#_1-二进制格式mysql安装"}},[s._v("1. 二进制格式mysql安装")])]),a("li",[a("a",{attrs:{href:"#_1-1破解密码以及无密码登录"}},[s._v("1.1破解密码以及无密码登录")]),a("ul",[a("li",[a("a",{attrs:{href:"#_1-1-1破解密码"}},[s._v("1.1.1破解密码")])]),a("li",[a("a",{attrs:{href:"#_1-1-2无密码登录"}},[s._v("1.1.2无密码登录")])]),a("li",[a("a",{attrs:{href:"#_1-1-3定义不同的客户端"}},[s._v("1.1.3定义不同的客户端")])])])]),a("li",[a("a",{attrs:{href:"#_3-mysql数据库备份与恢复"}},[s._v("3. mysql数据库备份与恢复")])]),a("li",[a("a",{attrs:{href:"#_3-1备份类型"}},[s._v("3.1备份类型")])]),a("li",[a("a",{attrs:{href:"#_3-2备份种类"}},[s._v("3.2备份种类")])]),a("li",[a("a",{attrs:{href:"#_3-3mysql备份工具"}},[s._v("3.3mysql备份工具")]),a("ul",[a("li",[a("a",{attrs:{href:"#_3-3-1-mysqldump备份命令"}},[s._v("3.3.1 mysqldump备份命令")])]),a("li",[a("a",{attrs:{href:"#_3-3-2-xtrabackup备份命令"}},[s._v("3.3.2 xtrabackup备份命令")])])])]),a("li",[a("a",{attrs:{href:"#_4-知识补充-差异备份"}},[s._v("4.知识补充：差异备份")])]),a("li",[a("a",{attrs:{href:"#_4-1开启mysql服务器的二进制日志功能"}},[s._v("4.1开启MySQL服务器的二进制日志功能")])]),a("li",[a("a",{attrs:{href:"#_4-2对数据库进行完全备份"}},[s._v("4.2对数据库进行完全备份")])]),a("li",[a("a",{attrs:{href:"#_4-3mysql差异备份恢复"}},[s._v("4.3mysql差异备份恢复")])]),a("li",[a("a",{attrs:{href:"#_4-4恢复完全备份"}},[s._v("4.4恢复完全备份")])]),a("li",[a("a",{attrs:{href:"#_4-5恢复差异备份"}},[s._v("4.5恢复差异备份")])]),a("li",[a("a",{attrs:{href:"#参考文章"}},[s._v("参考文章")])])])]),a("p"),s._v(" "),a("h2",{attrs:{id:"mysql备份与恢复"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql备份与恢复"}},[s._v("#")]),s._v(" mysql备份与恢复")]),s._v(" "),a("h2",{attrs:{id:"_1-二进制格式mysql安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-二进制格式mysql安装"}},[s._v("#")]),s._v(" 1. 二进制格式mysql安装")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("//下载二进制格式的mysql软件包\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /usr/src/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl src"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# wget https://downloads.mysql.com/archives/get/file/mysql-5.7.22-linux-glibc2.12-x86_64.tar.gz")]),s._v("\n--2018-08-13 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":56:27--  https://downloads.mysql.com/archives/get/file/mysql-5.7.22-linux-glibc2.12-x86_64.tar.gz\nResolving downloads.mysql.com "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("downloads.mysql.com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("137.254")]),s._v(".60.14\nConnecting to downloads.mysql.com "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("downloads.mysql.com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("137.254")]),s._v(".60.14"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(":443"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". connected.\nHTTP request sent, awaiting response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("302")]),s._v(" Found\nLocation: https://cdn.mysql.com/archives/mysql-5.7/mysql-5.7.22-linux-glibc2.12-x86_64.tar.gz "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("following"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\nSaving to: ‘mysql-5.7.22-linux-glibc2.12-x86_64.tar.gz’\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("%"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("643,790")]),s._v(",848 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".46MB/s   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" 4m 20s\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-08-14 00:00:50 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.36")]),s._v(" MB/s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" - ‘mysql-5.7.22-linux-glibc2.12-x86_64.tar.gz’saved "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("643790848")]),s._v("/643790848"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n\n//创建用户和组\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl src"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# groupadd -r mysql")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl src"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# useradd -M -s /sbin/nologin -g mysql mysql")]),s._v("\n\n\n//解压软件至/usr/local/\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@clcl src"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\ndebug  kernels  mysql-5.7.22-linux-glibc2.12-x86_64.tar.gz\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@clcl src"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar xf mysql-5.7.22-linux-glibc2.12-x86_64.tar.gz -C /usr/local/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@clcl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls /usr/local/")]),s._v("\nbin  games    lib    libexec                              sbin   src\netc  include  lib64  mysql-5.7.22-linux-glibc2.12-x86_64  share\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@clcl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /usr/local/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@clcl local"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ln -sv mysql-5.7.22-linux-glibc2.12-x86_64/ mysql")]),s._v("\n‘mysql’ -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ‘mysql-5.7.22-linux-glibc2.12-x86_64/’\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@clcl local"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ndrwxr-xr-x. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" Mar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v(" bin\ndrwxr-xr-x. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" Mar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v(" etc\ndrwxr-xr-x. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" Mar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v(" games\ndrwxr-xr-x. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" Mar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v(" include\ndrwxr-xr-x. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" Mar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v(" lib\ndrwxr-xr-x. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" Mar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v(" lib64\ndrwxr-xr-x. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" Mar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v(" libexec\nlrwxrwxrwx  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("36")]),s._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":00 mysql -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mysql-5.7.22-linux-glibc2.12-x86_64/\ndrwxr-xr-x  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("129")]),s._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" 00:16 mysql-5.7.22-linux-glibc2.12-x86_64\ndrwxr-xr-x. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" Mar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v(" sbin\ndrwxr-xr-x. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" root root  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("49")]),s._v(" Jun "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":03 share\ndrwxr-xr-x. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" Mar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v(" src\n\n\n//修改目录/usr/local/mysql的属主属组\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@clcl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chown -R mysql.mysql /usr/local/mysql")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@clcl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /usr/local/mysql -d")]),s._v("\nlrwxrwxrwx "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("36")]),s._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":00 /usr/local/mysql -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mysql-5.7.22-linux-glibc2.12-x86_64/\n\n\n\n//添加环境变量\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@clcl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls /usr/local/mysql")]),s._v("\nbin  COPYING  docs  include  lib  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("man")]),s._v("  README  share  support-files\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@clcl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# echo 'export PATH=/usr/local/mysql/bin:$PATH' > /etc/profile.d/mysql.sh")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@clcl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# . /etc/profile.d/mysql.sh")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@clcl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# echo $PATH")]),s._v("\n/usr/local/mysql/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin\n\n\n\n//建立数据存放目录\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir /opt/data")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chown -R mysql.mysql /opt/data/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /opt/")]),s._v("\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ndrwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" mysql mysql "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" Aug "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":54 data\n\n\n\n//初始化数据库\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /usr/local/mysql/bin/mysqld --initialize --user=mysql --datadir=/opt/data/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-08-15T07:57:46.168380Z "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" TIMESTAMP with implicit DEFAULT value is deprecated. Please use --explicit_defaults_for_timestamp server option "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("see documentation "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" details"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-08-15T07:57:50.542516Z "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" InnoDB: New log files created, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LSN")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("45790")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-08-15T07:57:50.927286Z "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" InnoDB: Creating foreign key constraint system tables.\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-08-15T07:57:51.071260Z "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" No existing UUID has been found, so we assume that this is the first "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v(" that this server has been started. Generating a new UUID: e8600890-a060-11e8-b1a2-000c294c50b4.\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-08-15T07:57:51.074566Z "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Gtid table is not ready to be used. Table "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mysql.gtid_executed'")]),s._v(" cannot be opened.\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-08-15T07:57:51.078089Z "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Note"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" A temporary password is generatedfor root@localhost: /Tw,fZyuq4db\n//请注意，这个命令的最后会生成一个临时密码，此处密码是/Tw,fZyuq4db\n//再次注意，这个密码是随机的，你的不会跟我一样，一定要记住这个密码，因为一会登录时会用到\n\n\n\n\n\n//生成配置文件\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat > /etc/my.cnf <<EOF")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" basedir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/mysql\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" datadir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /opt/data\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" socket "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /tmp/mysql.sock\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" port "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" pid-file "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /opt/data/mysql.pid\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" user "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" mysql\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" skip-name-resolve\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" EOF\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/my.cnf")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nbasedir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/mysql\ndatadir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /opt/data\nsocket "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /tmp/mysql.sock\nport "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("\npid-file "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /opt/data/mysql.pid\nuser "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" mysql\nskip-name-resolve\n\n\n\n//配置服务启动脚本\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cp -a /usr/local/mysql/support-files/mysql.server /etc/init.d/mysqld")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sed -ri 's#^(basedir=).*#\\1/usr/local/mysql#g' /etc/init.d/mysqld")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sed -ri 's#^(datadir=).*#\\1/opt/data#g' /etc/init.d/mysqld")]),s._v("\n\n\n\n\n//启动mysql\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /etc/init.d/mysqld start")]),s._v("\nStarting MySQL.Logging to "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/opt/data/localhost.localdomain.err'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n SUCCESS"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ps -ef|grep mysql")]),s._v("\nroot       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1521")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 01:58 pts/0    00:00:00 /bin/sh /usr/local/mysql/binmysqld_safe --datadir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/data --pid-file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/data/mysql.pid\nmysql      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1699")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1521")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 01:58 pts/0    00:00:00 /usr/local/mysql/bin/mysqld --basedir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/mysql --datadir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/data --plugin-dir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/mysql/lib/plugin --user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql --log-error"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("localhost.localdomain.err --pid-file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/data/mysql.pid --socket"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/tmp/mysql.sock --port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("\nroot       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1734")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1301")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 01:59 pts/0    00:00:00 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" --color"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("auto mysql\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ss -antl")]),s._v("\nState       Recv-Q Send-Q Local Address:Port               Peer Address:Port\nLISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v("         *:22                      *:*\nLISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:25                      *:*\nLISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v("        :::22                     :::*\nLISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("       ::1:25                     :::*\nLISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("         :::3306                   :::* \n \n \n\n//修改密码\n//使用临时密码登录\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /usr/local/mysql/bin/mysql -uroot -p")]),s._v("\nEnter password:\nWelcome to the MySQL monitor.  Commands end with "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" or "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("g.\nYour MySQL connection "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\nServer version: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),s._v(".22\n\nCopyright "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v(", Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'help;'")]),s._v(" or "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\\h'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" help. Type "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),a("span",{pre:!0,attrs:{class:"token entity",title:"\\c"}},[s._v("\\c")]),s._v("'")]),s._v(" to "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("clear")]),s._v(" the current input statement.\n\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" \n\n//设置新密码\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" password "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'cljhfy'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nQuery OK, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" rows affected, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" warning "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),a("h2",{attrs:{id:"_1-1破解密码以及无密码登录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1破解密码以及无密码登录"}},[s._v("#")]),s._v(" 1.1破解密码以及无密码登录")]),s._v(" "),a("h3",{attrs:{id:"_1-1-1破解密码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-1破解密码"}},[s._v("#")]),s._v(" 1.1.1破解密码")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim /etc/my.cnf")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nskip-grant-tables        //增加这一行，然后重启服务\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysql")]),s._v("\n\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" use mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" * from user "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("G\n*************************** "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(". row ***************************\n-----//密码\n authentication_string: *376C8403A2C3233B69F4763C3E428E4ED7314D42\n-----\n\n \nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" UPDATE user SET password（或authentication_string）"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123456"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" WHERE "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  \nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" flush privileges"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n \nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("h3",{attrs:{id:"_1-1-2无密码登录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-2无密码登录"}},[s._v("#")]),s._v(" 1.1.2无密码登录")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim .my.cnf ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root //你要无秘登录的用户\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("password")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("cl //用户的密码\n")])])]),a("h3",{attrs:{id:"_1-1-3定义不同的客户端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-3定义不同的客户端"}},[s._v("#")]),s._v(" 1.1.3定义不同的客户端")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("                        //给/usr/local/mysql/bin/mysql使用\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("password")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123456"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqladmin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("               //给/usr/local/mysql/bin/mysqladmin使用\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("password")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123456"')]),s._v("\n")])])]),a("p",[s._v("//在家目录下的隐藏文件"),a("code",[s._v(".my.cnf")])]),s._v(" "),a("h1",{attrs:{id:"_2-mysql配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-mysql配置文件"}},[s._v("#")]),s._v(" 2. mysql配置文件")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("mysql"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("的配置文件为"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("/etc/my.cnf\n")])])]),a("p",[a("strong",[s._v("配置文件查找次序：若在多个配置文件中均有设定，则最后找到的最终生效")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("/etc/my.cnf --\x3e /etc/mysql/my.cnf --\x3e --default-extra-file=/PATH/TO/CONF_FILE --\x3e ~/.my.cnf\n")])])]),a("p",[a("strong",[s._v("mysql常用配置文件参数：")])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("参数")]),s._v(" "),a("th",[s._v("说明")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("port = 3306")]),s._v(" "),a("td",[s._v("设置监听端口")])]),s._v(" "),a("tr",[a("td",[s._v("socket = /tmp/mysql.sock")]),s._v(" "),a("td",[s._v("指定套接字文件位置")])]),s._v(" "),a("tr",[a("td",[s._v("basedir = /usr/local/mysql")]),s._v(" "),a("td",[s._v("指定MySQL的安装路径")])]),s._v(" "),a("tr",[a("td",[s._v("datadir = /data/mysql")]),s._v(" "),a("td",[s._v("指定MySQL的数据存放路径")])]),s._v(" "),a("tr",[a("td",[s._v("pid-file = /data/mysql/mysql.pid")]),s._v(" "),a("td",[s._v("指定进程ID文件存放路径")])]),s._v(" "),a("tr",[a("td",[s._v("user = mysql")]),s._v(" "),a("td",[s._v("指定MySQL以什么用户的身份提供服务")])]),s._v(" "),a("tr",[a("td",[s._v("skip-name-resolve")]),s._v(" "),a("td",[s._v("- 禁止MySQL对外部连接进行DNS解析 - 使用这一选项可以消除MySQL进行DNS解析的时间。 - 若开启该选项，则所有远程主机连接授权都要使用IP地址 方式否则MySQL将无法正常处理连接请求")])])])]),s._v(" "),a("h2",{attrs:{id:"_3-mysql数据库备份与恢复"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-mysql数据库备份与恢复"}},[s._v("#")]),s._v(" 3. mysql数据库备份与恢复")]),s._v(" "),a("blockquote",[a("p",[a("strong",[s._v("为什么要备份")])])]),s._v(" "),a("blockquote",[a("p",[s._v("灾难恢复：硬件故障、软件故障、自然灾害、黑客攻击、误操作测试等数据丢失场景")])]),s._v(" "),a("blockquote",[a("p",[s._v("备份注意要点")])]),s._v(" "),a("blockquote",[a("p",[s._v("能容忍最多丢失多少数据")])]),s._v(" "),a("blockquote",[a("p",[s._v("恢复数据需要在多长时间内完成")])]),s._v(" "),a("blockquote",[a("p",[s._v("需要恢复哪些数据")])]),s._v(" "),a("blockquote",[a("p",[s._v("还原要点")])]),s._v(" "),a("blockquote",[a("p",[s._v("做还原测试，用于测试备份的可用性\n还原演练")])]),s._v(" "),a("h2",{attrs:{id:"_3-1备份类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1备份类型"}},[s._v("#")]),s._v(" 3.1备份类型")]),s._v(" "),a("p",[a("strong",[s._v("备份类型：")])]),s._v(" "),a("ul",[a("li",[s._v("完全备份，部分备份\n"),a("ul",[a("li",[s._v("完全备份：整个数据集")]),s._v(" "),a("li",[s._v("部分备份：只备份数据子集，如部分库或表")])])]),s._v(" "),a("li",[s._v("完全备份、增量备份、差异备份\n"),a("ul",[a("li",[s._v("增量备份：仅备份最近一次完全备份或增量备份（如果存在增量）以来变化的数据，备份较快，还原复杂")]),s._v(" "),a("li",[s._v("差异备份：仅备份最近一次完全备份以来变化的数据，备份较慢，还原简单\n//注意：二进制日志文件不应该与数据文件放在同一磁盘")])])])]),s._v(" "),a("h2",{attrs:{id:"_3-2备份种类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2备份种类"}},[s._v("#")]),s._v(" 3.2备份种类")]),s._v(" "),a("p",[a("strong",[s._v("冷、温、热备份")])]),s._v(" "),a("ul",[a("li",[s._v("冷备：读写操作均不可进行")]),s._v(" "),a("li",[s._v("温备：读操作可执行；但写操作不可执行")]),s._v(" "),a("li",[s._v("热备：读写操作均可执行")])]),s._v(" "),a("blockquote",[a("p",[s._v("MyISAM引擎：温备，不支持热备")]),s._v(" "),a("p",[s._v("InnoDB引擎: 都支持")])]),s._v(" "),a("ul",[a("li",[s._v("物理和逻辑备份")]),s._v(" "),a("li",[s._v("物理备份：直接复制数据文件进行备份，与存储引擎有关，占用较多的空间，速度快")]),s._v(" "),a("li",[s._v("逻辑备份：从数据库中“导出”数据另存而进行的备份，与存储引擎无关，占用空间少，速度慢，可能丢失精度")])]),s._v(" "),a("h2",{attrs:{id:"_3-3mysql备份工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3mysql备份工具"}},[s._v("#")]),s._v(" 3.3mysql备份工具")]),s._v(" "),a("p",[a("strong",[s._v("mysqldump+复制binlog：")])]),s._v(" "),a("ul",[a("li",[s._v("mysqldump：完全备份复制binlog中指定时间范围的event：增量备份")])]),s._v(" "),a("p",[a("strong",[s._v("LVM快照+复制binlog")]),s._v("：")]),s._v(" "),a("ul",[a("li",[s._v("LVM快照：使用cp或tar等做物理备份；完全备份复制binlog中指定时间范围的event：增量备份\n"),a("strong",[s._v("其他工具")])]),s._v(" "),a("li",[s._v("xtrabackup：由Percona提供支持对InnoDB做热备(物理备份)的工具，支持完全备份、增量备份")]),s._v(" "),a("li",[s._v("MariaDB Backup： 从MariaDB 10.1.26开始集成，基于\nPercona XtraBackup 2.3.8实现")]),s._v(" "),a("li",[s._v("mysqlbackup：热备份， MySQL Enterprise Edition组件")])]),s._v(" "),a("h3",{attrs:{id:"_3-3-1-mysqldump备份命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-1-mysqldump备份命令"}},[s._v("#")]),s._v(" 3.3.1 mysqldump备份命令")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("//语法：\n    mysqldump "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OPTIONS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" database "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("tables "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    mysqldump "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OPTIONS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" --all-databases "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OPTIONS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    mysqldump "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OPTIONS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" --databases "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OPTIONS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" DB1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("DB2 DB3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    \n//常用的OPTIONS：\n    -uUSERNAME      //指定数据库用户名\n    -hHOST          //指定服务器主机，请使用ip地址\n    -pPASSWORD      //指定数据库用户的密码\n    -P"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#             //指定数据库监听的端口，这里的#需用实际的端口号代替，如-P3307")]),s._v("\n    -A， --all-databases 备份所有数据库，含create database\n    -B , --databases db_name… 指定备份的数据库，包括\ncreate database语句\n    -E, --events：备份相关的所有event scheduler\n    -R, --routines：备份所有存储过程和存储函数\n    --triggers：备份表相关的触发器，默认启用,用--skip-triggers，不备份触发器\n    --master-data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#]： 此选项须启用二进制日志")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("：所备份的数据之前加一条记录为CHANGE MASTER TO语句，非注释，不指定"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#，默认为1")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("：记录为注释的CHANGE MASTER TO语句\n    此选项会自动关闭--lock-tables功能，自动打开--lock-all-tables功能（除非开启--single-transaction）\n    -F, --flush-logs ：备份前滚动日志，锁定表完成后，执行flush logs命令,生成新的二进制日志文件，配合-A时，会导致刷新多次数据\n    库，在同一时刻执行转储和日志刷新，则应同时使用--flush-logs和-x，--master-data或-single-transaction,此时只刷新一次\n    建议：和-x，--master-data或 --single-transaction一起使用\n    --compact 去掉注释，适合调试，生产不使用\n    -d, --no-data 只备份表结构\n    -t, --no-create-info 只备份数据,不备份create table\n    -n,--no-create-db 不备份create database，可被-A或-B覆盖\n    --flush-privileges 备份mysql或相关时需要使用\n    -f, --force 忽略SQL错误，继续执行\n    --hex-blob 使用十六进制符号转储二进制列（例如，“abc”变为0x616263），受影响的数据类型包括BINARY， VARBINARY，BLOB，BIT\n    -q, --quick 不缓存查询，直接输出，加快备份速度\n \n \n    \n//备份整个数据库"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("全备"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show databases"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n+--------------------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Database           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" information_schema "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" mysql              "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" performance_schema "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" sys                "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" cljhfy             "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------+\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" rows "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" use cljhfy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nDatabase changed\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show tables"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n+----------------------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Tables_in_wangqingge "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+----------------------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" teacher              "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" student              "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+----------------------+\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" rows "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nanaconda-ks.cfg\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysqldump -uroot -p -h127.0.0.1 --all-databases > all-201904301500.sql")]),s._v("\nEnter password:\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nall-201904301500.sql  anaconda-ks.cfg\n\n\n\n\n//备份cljhfy库的student表和teacher表\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysqldump -uroot -p -h127.0.0.1 cljhfy student teacher > table-201904301500.sql")]),s._v("\nEnter password:\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nall-201904301500.sql  anaconda-ks.cfg  table-201904301500.sql\n\n\n\n\n//备份wangqingge库\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysqldump -uroot -p -h127.0.0.1 --databases cljhfy > cl-201904301500.sql")]),s._v("\nEnter password:\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nall-201904301500.sql  table-201904301500.sql\nanaconda-ks.cfg       cl-201904301500.sql\n")])])]),a("p",[s._v("// mysql数据恢复")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("//模拟误删cljhfy数据库\nmysql> drop database wangqingge;\nQuery OK, 3 rows affected (0.02 sec)\n\nmysql> show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| mysql              |\n| performance_schema |\n| sys                |\n+--------------------+\n4 rows in set (0.00 sec)\n\n\n//恢复cljhfy数据库\n[root@cl ~]# ls\nall-201904301500.sql  table-201904301500.sql\nanaconda-ks.cfg       cl-201904301500.sql\n[root@cl ~]# mysql -uroot -p -h127.0.0.1 < all-201904301500.sql\nEnter password:\n[root@cl ~]# mysql -uroot -p -h127.0.0.1 -e 'show databases;'\nEnter password:\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| mysql              |\n| performance_schema |\n| sys                |\n| wangqingge         |\n+--------------------+\n//恢复的方式都一样\n")])])]),a("h3",{attrs:{id:"_3-3-2-xtrabackup备份命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-2-xtrabackup备份命令"}},[s._v("#")]),s._v(" 3.3.2 xtrabackup备份命令")]),s._v(" "),a("p",[a("strong",[s._v("Xtrabackup")])]),s._v(" "),a("ul",[a("li",[s._v("percona提供的mysql数据库备份工具，惟一开源的能够对innodb和xtradb数据库进行热备的工具")])]),s._v(" "),a("p",[a("strong",[s._v("特点：")])]),s._v(" "),a("ul",[a("li",[a("ol",[a("li",[s._v("备份还原过程快速、可靠")])])]),s._v(" "),a("li",[a("ol",{attrs:{start:"2"}},[a("li",[s._v("备份过程不会打断正在执行的事务")])])]),s._v(" "),a("li",[a("ol",{attrs:{start:"3"}},[a("li",[s._v("能够基于压缩等功能节约磁盘空间和流量")])])]),s._v(" "),a("li",[a("ol",{attrs:{start:"4"}},[a("li",[s._v("自动实现备份检验")])])]),s._v(" "),a("li",[a("ol",{attrs:{start:"5"}},[a("li",[s._v("开源，免费")])])])]),s._v(" "),a("p",[a("strong",[s._v("Xtrabackup2.2版之前包括4个可执行文件：")])]),s._v(" "),a("ul",[a("li",[s._v("Innobackupex: perl 脚本")]),s._v(" "),a("li",[s._v("Xtrabackup: C/C++ 编译的二进制")]),s._v(" "),a("li",[s._v("Xbcrypt:加解密")]),s._v(" "),a("li",[s._v("Xbstream:支持并发写的流文件格式")])]),s._v(" "),a("blockquote",[a("p",[s._v("xtrabackup 是用来备份 InnoDB 表的，不能备份非 InnoDB 表，和 mysqld server 没有交互；innobackupex 脚本用来备份非InnoDB 表，同时会调用 xtrabackup 命令来备份 InnoDB 表，还会和 mysqld server 发送命令进行交互，如加读锁（FTWRL）、获取位点（SHOW SLAVESTATUS）等。即innobackupex是在xtrabackup 之上做了一层封装实现的。")])]),s._v(" "),a("blockquote",[a("p",[s._v("虽然目前一般不用 MyISAM 表，只是mysql 库下的系统表是MyISAM 的，因此备份基本都通过 innobackupex 命令进行")])]),s._v(" "),a("p",[a("strong",[s._v("xtrabackup的特性：")]),s._v("\n使用innobakupex备份时，其会调用xtrabackup备份所有的InnoDB表，复制所有关于表结构定义的相关文件(.frm)、以及MyISAM、MERGE、CSV和ARCHIVE表的相关文件，同时还会备份触发器和数据库配置信息相关的文件。这些文件会被保存至一个以时间命名的目录中,在备份时，innobackupex还会在备份目录中创建如下文件：")]),s._v(" "),a("ol",[a("li",[s._v("xtrabackup_checkpoints：备份类型（如完全或增量）、备份状态（如是否已经为prepared状态）和LSN(日志序列号)范围信息,每个InnoDB页(通常为16k大小)都会包含一个日志序列号，即LSN。LSN是整个数据库系统的系统版本号，每个页面相关的LSN能够表明此页面最近是如何发生改变的")]),s._v(" "),a("li",[s._v("xtrabackup_binlog_info：mysql服务器当前正在使用的二进制日志文件及至备份这一刻为止二进制日志事件的位置")]),s._v(" "),a("li",[s._v("xtrabackup_binlog_pos_innodb：二进制日志文件及用于InnoDB或XtraDB表的二进制日志文件的当position")]),s._v(" "),a("li",[s._v("xtrabackup_binary：备份中用到的xtrabackup的可执行文件")]),s._v(" "),a("li",[s._v("backup-my.cnf：备份命令用到的配置选项信息在使用innobackupex进行备份时，还可以使用--no-timestamp选项来阻止命令自动创建一个以时间命名的目录；innobackupex命令将会创建一个BACKUP-DIR目录来存储备份数据")])]),s._v(" "),a("p",[a("strong",[s._v("xtrabackup用法")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('备份：innobackupex [option] BACKUP-ROOT-DIR\n选项说明：\n--user：该选项表示备份账号\n--password：该选项表示备份的密码\n--host：该选项表示备份数据库的地址\n--databases：该选项接受的参数为数据名，如果要指定多个数据库，彼此间需要以空格隔开；如："xtra_test dba_test"，同时，在指定某数据库时，也可以只指定其中的某张表。如："mydatabase.mytable"。该选项对innodb引擎表无效，还是会备份所有innodb表\n--defaults-file：该选项指定了从哪个文件读取MySQL配置，必须放在命令行第一个选项的位置\n--incremental：该选项表示创建一个增量备份，需要指定--incremental-\nbasedir\n--incremental-basedir：该选项表示接受了一个字符串参数指定含有full backup的目录为增量备份的base目录，与--incremental同时使用\n--incremental-dir：该选项表示增量备份的目录\n--include=name：指定表名，格式：databasename.tablename\nPrepare：innobackupex --apply-log [option] BACKUP-DIR\n选项说明：\n--apply-log：一般情况下,在备份完成后，数据尚且不能用于恢复操作，因为备份的数据中可能会包含尚未提交的事务或已经提交但尚未同步至数据文件中的事务。因此，此时数据文件仍处理不一致状态。此选项作用是通过回滚未提交的事务及同步已经提交的事务至数据文件使数据文件处于一致性状态\n--use-memory：该选项表示和--apply-log选项一起使用，prepare 备份的时候，xtrabackup做crash recovery分配的内存大小，单位字节。也可(1MB,1M,1G,1GB)，推荐1G\n--defaults-file：该选项指定了从哪个文件读取MySQL配置，必须放在命令行第一个选项的位置\n-export：表示开启可导出单独的表之后再导入其他Mysql中\n--redo-only：这个选项在prepare base full backup，往其中merge增量备份时候使用\n还原：innobackupex --copy-back [选项] BACKUP-DIR\ninnobackupex --move-back [选项] [--defaults-group=GROUP-NAME] BACKUP-DIR\n选项说明：\n--copy-back：做数据恢复时将备份数据文件拷贝到MySQL服务器的datadir\n--move-back：这个选项与--copy-back相似，唯一的区别是它不拷贝文件，而是移动文件到目的地。这个选项移除backup文件，用时候必须小心。使用场景：没有足够的磁盘空间同事保留数据文件和Backup副本\n')])])]),a("p",[a("strong",[s._v("注意事项")])]),s._v(" "),a("blockquote",[a("p",[s._v("1.datadir目录必须为空。除非指定innobackupex --force-non-empty-directorires选项指定，否则--copy-backup选项不会覆盖")]),s._v(" "),a("p",[s._v("2.在restore之前,必须shutdown MySQL实例，你不能将一个运行中的实例restore到datadir目录中")]),s._v(" "),a("p",[s._v("3.由于文件属性会被保留，大部分情况下你需要在启动实例之前将文件的属主改为mysql，这些文件将属于创建备份的用户chown -R mysql:mysql /data/mysql以上需要在用户调用innobackupex之前完成--force-non-empty-directories：指定该参数时候，使得innobackupex --copy-back或--move-back选项转移文件到非空目录，已存在的文件不会被覆盖。如果--copy-back和--move-back文件需要从备份目录拷贝一个在datadir已经存在的文件，会报错失败!")])]),s._v(" "),a("h2",{attrs:{id:"_4-知识补充-差异备份"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-知识补充-差异备份"}},[s._v("#")]),s._v(" 4.知识补充：差异备份")]),s._v(" "),a("h2",{attrs:{id:"_4-1开启mysql服务器的二进制日志功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1开启mysql服务器的二进制日志功能"}},[s._v("#")]),s._v(" 4.1开启MySQL服务器的二进制日志功能")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nbasedir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/mysql\ndatadir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /opt/data\nsocket "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /tmp/mysql.sock\nport "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("\nuser "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" mysql\npid-file "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /tmp/mysql.pid\nskip-name-resolve\n\nserver-id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("         //设置服务器标识符\nlog-bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("cl_bin    //开启二进制日志功能\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# service mysqld restart")]),s._v("\nShutting down MySQL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(" SUCCESS"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nStarting MySQL. SUCCESS"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /opt/data/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nauto.cnf       cl.err          ib_logfile0  mysql               sys\ncl_bin.000001  ib_buffer_pool  ib_logfile1  mysql.pid\ncl_bin.index   ibdata1         ibtmp1       performance_schema\n")])])]),a("h2",{attrs:{id:"_4-2对数据库进行完全备份"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2对数据库进行完全备份"}},[s._v("#")]),s._v(" 4.2对数据库进行完全备份")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysql -uroot -pcljhfy")]),s._v("\nmysql: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Using a password on the "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" line interface can be insecure.\nWelcome to the MySQL monitor.  Commands end with "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" or "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("g.\nYour MySQL connection "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\nServer version: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),s._v(".22-log MySQL Community Server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("GPL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nCopyright "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v(", Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'help;'")]),s._v(" or "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\\h'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" help. Type "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),a("span",{pre:!0,attrs:{class:"token entity",title:"\\c"}},[s._v("\\c")]),s._v("'")]),s._v(" to "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("clear")]),s._v(" the current input statement.\n\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show databases"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n+--------------------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Database           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" information_schema "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" chenliang          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" mysql              "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" performance_schema "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" sys                "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------+\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" rows "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show tables"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n+---------------------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Tables_in_chenliang "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+---------------------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" student             "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" teacher             "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+---------------------+\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" rows "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" * from student"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n+----+---------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" name    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+----+---------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" leo     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" natasha "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" tonny   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+----+---------+\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" rows "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.01")]),s._v(" sec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" * from teacher"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n+----+---------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" name    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+----+---------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" leo     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" natasha "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" tor     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+----+---------+\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" rows "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n//完全备份\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysqldump -uroot -pcljhfy --single-transaction --flush-logs --master-data=2 --all-databases --delete-master-logs > chen-201904301600.sql")]),s._v("\nmysqldump: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Using a password on the "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" line interface can be insecure.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nanaconda-ks.cfg        mysql-5.7.22-linux-glibc2.12-x86_64.tar.gz\nchen-201904301600.sql\n\n//增加新内容\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" use chenliang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nReading table information "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" completion of table and "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("column")]),s._v(" names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" insert teacher values"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'jerry'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'kiso'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nQuery OK, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" rows affected "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nRecords: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("  Duplicates: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  Warnings: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" * from teacher"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n+----+---------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" name    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+----+---------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" leo     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" natasha "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" tor     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jerry   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" kiso    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+----+---------+\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" rows "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),a("h2",{attrs:{id:"_4-3mysql差异备份恢复"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3mysql差异备份恢复"}},[s._v("#")]),s._v(" 4.3mysql差异备份恢复")]),s._v(" "),a("p",[s._v("模拟误删数据")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@cl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysql -uroot -pcljhfy -e 'drop database chenliang'")]),s._v("\nmysql: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Using")]),s._v(" a password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" the command line interface can be insecure"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@cl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysql -uroot -pcljhfy -e 'show databases'")]),s._v("\nmysql: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Using")]),s._v(" a password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" the command line interface can be insecure"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--------------------+")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Database")]),s._v("           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--------------------+")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" information_schema "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" mysql              "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" performance_schema "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" sys                "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--------------------+")]),s._v("\n")])])]),a("p",[s._v("刷新创建新的二进制日志")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /opt/data/")]),s._v("\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("122944")]),s._v("\n-rw-r-----. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("56")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":44 auto.cnf\n-rw-r-----. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("613")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":07 cl_bin.000002\n-rw-r-----. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":03 cl_bin.index\n-rw-r-----. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12587")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":54 cl.err\n-rw-r-----. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("349")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":54 ib_buffer_pool\n-rw-r-----. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12582912")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":07 ibdata1\n-rw-r-----. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50331648")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":07 ib_logfile0\n-rw-r-----. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50331648")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":44 ib_logfile1\n-rw-r-----. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12582912")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":03 ibtmp1\ndrwxr-x---. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" mysql mysql     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":44 mysql\n-rw-r-----. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":54 mysql.pid\ndrwxr-x---. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" mysql mysql     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8192")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":44 performance_schema\ndrwxr-x---. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" mysql mysql     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8192")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":44 sys\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysqladmin -uroot -pcljhfy flush-logs  //刷新创建新的二进制日志")]),s._v("\nmysqladmin: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Using a password on the "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" line interface can be insecure.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /opt/data/")]),s._v("\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("122948")]),s._v("\n-rw-r-----. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("56")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":44 auto.cnf\n-rw-r-----. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("657")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":08 cl_bin.000002\n-rw-r-----. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("154")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":08 cl_bin.000003\n-rw-r-----. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":08 cl_bin.index\n-rw-r-----. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12587")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":54 cl.err\n-rw-r-----. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("349")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":54 ib_buffer_pool\n-rw-r-----. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12582912")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":07 ibdata1\n-rw-r-----. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50331648")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":07 ib_logfile0\n-rw-r-----. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50331648")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":44 ib_logfile1\n-rw-r-----. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12582912")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":03 ibtmp1\ndrwxr-x---. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" mysql mysql     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":44 mysql\n-rw-r-----. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":54 mysql.pid\ndrwxr-x---. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" mysql mysql     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8192")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":44 performance_schema\ndrwxr-x---. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" mysql mysql     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8192")]),s._v(" May  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":44 sys\n")])])]),a("h2",{attrs:{id:"_4-4恢复完全备份"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-4恢复完全备份"}},[s._v("#")]),s._v(" 4.4恢复完全备份")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysql -uroot -pcljhfy < chen-201904301600.sql ")]),s._v("\nmysql: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Using a password on the "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" line interface can be insecure.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysql -uroot -pcljhfy -e 'show databases'")]),s._v("\nmysql: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Using a password on the "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" line interface can be insecure.\n+--------------------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Database           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" information_schema "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" chenliang          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" mysql              "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" performance_schema "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" sys                "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------+\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysql -uroot -pcljhfy -e 'select * from chenliang.teacher'")]),s._v("\nmysql: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Using a password on the "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" line interface can be insecure.\n+----+---------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" name    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+----+---------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" leo     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" natasha "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" tor     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+----+---------+\n")])])]),a("h2",{attrs:{id:"_4-5恢复差异备份"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-5恢复差异备份"}},[s._v("#")]),s._v(" 4.5恢复差异备份")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("//检查误删数据库的位置在什么地方\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show binlog events "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'cl_bin.000002'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n+---------------+-----+----------------+-----------+-------------+---------------------------------------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Log_name      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Pos "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Event_type     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Server_id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" End_log_pos "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Info                                  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+---------------+-----+----------------+-----------+-------------+---------------------------------------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" cl_bin.000002 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Format_desc    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Server ver: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),s._v(".22-log, Binlog ver: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" cl_bin.000002 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Previous_gtids "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("154")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("                                       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" cl_bin.000002 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("154")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Anonymous_Gtid "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("219")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SET @@"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("SESSION")]),s._v(".GTID_NEXT"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ANONYMOUS'")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" cl_bin.000002 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("219")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Query          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("296")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" BEGIN                                 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" cl_bin.000002 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("296")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Table_map      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("354")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" table_id: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("113")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("chenliang.teacher"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" cl_bin.000002 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("354")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Write_rows     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("410")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" table_id: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("113")]),s._v(" flags: STMT_END_F       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" cl_bin.000002 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("410")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Xid            "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("441")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" COMMIT /* "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("xid")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("485")]),s._v(" */                  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" cl_bin.000002 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("441")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Anonymous_Gtid "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("506")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SET @@"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("SESSION")]),s._v(".GTID_NEXT"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ANONYMOUS'")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" cl_bin.000002 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("506")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Query          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("613")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" drop database chenliang               "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" cl_bin.000002 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("613")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Rotate         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("657")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" cl_bin.000003"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("pos")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("                   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+---------------+-----+----------------+-----------+-------------+---------------------------------------+\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" rows "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n//使用mysqlbinlog恢复差异备份\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysqlbinlog --stop-position=506 /opt/data/cl_bin.000002 |mysql -uroot -pcljhfy")]),s._v("\nmysql: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Using a password on the "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" line interface can be insecure.\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@cl ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysql -uroot -pcljhfy -e 'select * from chenliang.teacher'")]),s._v("\nmysql: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Using a password on the "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" line interface can be insecure.\n+----+---------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" name    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+----+---------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" leo     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" natasha "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" tor     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jerry   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" kiso    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+----+---------+\n")])])]),a("h2",{attrs:{id:"参考文章"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[s._v("#")]),s._v(" 参考文章")]),s._v(" "),a("ul",[a("li",[s._v("https://www.cnblogs.com/cljhfy/p/10802020.html")])])])}),[],!1,null,null,null);t.default=r.exports}}]);