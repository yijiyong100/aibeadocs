<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Spark-SparkSQL总结 | 智能后端和架构</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="智能后端和架构的文档">
    <meta name="icon" content="">
    <meta name="author" content="landry -- seo 选项">
    <meta name="keywords" content="后端 java 架构 面试 -- seo 选项">
    
    <link rel="preload" href="/assets/css/0.styles.183d1d00.css" as="style"><link rel="preload" href="/assets/js/app.db30138a.js" as="script"><link rel="preload" href="/assets/js/5.df8bf371.js" as="script"><link rel="preload" href="/assets/js/1.60d99fe1.js" as="script"><link rel="preload" href="/assets/js/415.ad521b94.js" as="script"><link rel="prefetch" href="/assets/js/10.034bcceb.js"><link rel="prefetch" href="/assets/js/100.bc78c9c9.js"><link rel="prefetch" href="/assets/js/101.fc021eba.js"><link rel="prefetch" href="/assets/js/102.44f58839.js"><link rel="prefetch" href="/assets/js/103.cd3ce876.js"><link rel="prefetch" href="/assets/js/104.ece12d4f.js"><link rel="prefetch" href="/assets/js/105.e0ef0178.js"><link rel="prefetch" href="/assets/js/106.f8113fb8.js"><link rel="prefetch" href="/assets/js/107.7af90320.js"><link rel="prefetch" href="/assets/js/108.a76af7ab.js"><link rel="prefetch" href="/assets/js/109.ae7dfcbe.js"><link rel="prefetch" href="/assets/js/11.22d5654f.js"><link rel="prefetch" href="/assets/js/110.829dbd72.js"><link rel="prefetch" href="/assets/js/111.2612d028.js"><link rel="prefetch" href="/assets/js/112.381ba79f.js"><link rel="prefetch" href="/assets/js/113.52309728.js"><link rel="prefetch" href="/assets/js/114.afd46270.js"><link rel="prefetch" href="/assets/js/115.cfff1785.js"><link rel="prefetch" href="/assets/js/116.b9e85eed.js"><link rel="prefetch" href="/assets/js/117.c88c3ceb.js"><link rel="prefetch" href="/assets/js/118.0cfd8d46.js"><link rel="prefetch" href="/assets/js/119.972e6fcd.js"><link rel="prefetch" href="/assets/js/12.a1fbf449.js"><link rel="prefetch" href="/assets/js/120.c4d0fa30.js"><link rel="prefetch" href="/assets/js/121.a05fb7c8.js"><link rel="prefetch" href="/assets/js/122.84bc99e8.js"><link rel="prefetch" href="/assets/js/123.6e40db8b.js"><link rel="prefetch" href="/assets/js/124.679f60f0.js"><link rel="prefetch" href="/assets/js/125.7b983b12.js"><link rel="prefetch" href="/assets/js/126.c6529e34.js"><link rel="prefetch" href="/assets/js/127.62896466.js"><link rel="prefetch" href="/assets/js/128.11cadf09.js"><link rel="prefetch" href="/assets/js/129.a2c6007b.js"><link rel="prefetch" href="/assets/js/13.773a30c0.js"><link rel="prefetch" href="/assets/js/130.cd51d586.js"><link rel="prefetch" href="/assets/js/131.5d81a3a4.js"><link rel="prefetch" href="/assets/js/132.c062c43a.js"><link rel="prefetch" href="/assets/js/133.94b50107.js"><link rel="prefetch" href="/assets/js/134.e787c6f2.js"><link rel="prefetch" href="/assets/js/135.514b39b8.js"><link rel="prefetch" href="/assets/js/136.2209902a.js"><link rel="prefetch" href="/assets/js/137.8ee62050.js"><link rel="prefetch" href="/assets/js/138.30076406.js"><link rel="prefetch" href="/assets/js/139.153f79f0.js"><link rel="prefetch" href="/assets/js/14.a010702c.js"><link rel="prefetch" href="/assets/js/140.c22ae524.js"><link rel="prefetch" href="/assets/js/141.03388ce3.js"><link rel="prefetch" href="/assets/js/142.be052d72.js"><link rel="prefetch" href="/assets/js/143.86f4f723.js"><link rel="prefetch" href="/assets/js/144.58a81178.js"><link rel="prefetch" href="/assets/js/145.b6065cbb.js"><link rel="prefetch" href="/assets/js/146.a7d48393.js"><link rel="prefetch" href="/assets/js/147.1f5a2c27.js"><link rel="prefetch" href="/assets/js/148.e545c932.js"><link rel="prefetch" href="/assets/js/149.b7f633ea.js"><link rel="prefetch" href="/assets/js/15.6612b8a7.js"><link rel="prefetch" href="/assets/js/150.0c633255.js"><link rel="prefetch" href="/assets/js/151.7518fca9.js"><link rel="prefetch" href="/assets/js/152.85ebf0bb.js"><link rel="prefetch" href="/assets/js/153.6696affd.js"><link rel="prefetch" href="/assets/js/154.a488a746.js"><link rel="prefetch" href="/assets/js/155.b1285b65.js"><link rel="prefetch" href="/assets/js/156.c7d65add.js"><link rel="prefetch" href="/assets/js/157.95b667f4.js"><link rel="prefetch" href="/assets/js/158.36dcae64.js"><link rel="prefetch" href="/assets/js/159.5ab4607b.js"><link rel="prefetch" href="/assets/js/16.9728f201.js"><link rel="prefetch" href="/assets/js/160.f31c31c5.js"><link rel="prefetch" href="/assets/js/161.7faa6f5b.js"><link rel="prefetch" href="/assets/js/162.8bed1a3e.js"><link rel="prefetch" href="/assets/js/163.bccb4b94.js"><link rel="prefetch" href="/assets/js/164.d019f9f6.js"><link rel="prefetch" href="/assets/js/165.4ea2fcec.js"><link rel="prefetch" href="/assets/js/166.937ae33a.js"><link rel="prefetch" href="/assets/js/167.63bf2a10.js"><link rel="prefetch" href="/assets/js/168.8501b450.js"><link rel="prefetch" href="/assets/js/169.52064ac2.js"><link rel="prefetch" href="/assets/js/17.01684033.js"><link rel="prefetch" href="/assets/js/170.bc536396.js"><link rel="prefetch" href="/assets/js/171.5c44671a.js"><link rel="prefetch" href="/assets/js/172.cbc9f01e.js"><link rel="prefetch" href="/assets/js/173.036cc49c.js"><link rel="prefetch" href="/assets/js/174.7900267f.js"><link rel="prefetch" href="/assets/js/175.7f350261.js"><link rel="prefetch" href="/assets/js/176.abfbdc57.js"><link rel="prefetch" href="/assets/js/177.679877f2.js"><link rel="prefetch" href="/assets/js/178.87fc5aba.js"><link rel="prefetch" href="/assets/js/179.26c9f0a4.js"><link rel="prefetch" href="/assets/js/18.e64f0610.js"><link rel="prefetch" href="/assets/js/180.bd2cdacc.js"><link rel="prefetch" href="/assets/js/181.3ad737a4.js"><link rel="prefetch" href="/assets/js/182.3e7faf1a.js"><link rel="prefetch" href="/assets/js/183.4d65d295.js"><link rel="prefetch" href="/assets/js/184.460482ae.js"><link rel="prefetch" href="/assets/js/185.46d4a7fe.js"><link rel="prefetch" href="/assets/js/186.61235089.js"><link rel="prefetch" href="/assets/js/187.397bcfe8.js"><link rel="prefetch" href="/assets/js/188.060a1cb7.js"><link rel="prefetch" href="/assets/js/189.e3995463.js"><link rel="prefetch" href="/assets/js/19.f8b70585.js"><link rel="prefetch" href="/assets/js/190.dcaa16c4.js"><link rel="prefetch" href="/assets/js/191.f4c5aa96.js"><link rel="prefetch" href="/assets/js/192.8b10742f.js"><link rel="prefetch" href="/assets/js/193.64a40b9c.js"><link rel="prefetch" href="/assets/js/194.2ea34c9f.js"><link rel="prefetch" href="/assets/js/195.6bb470df.js"><link rel="prefetch" href="/assets/js/196.a0f55724.js"><link rel="prefetch" href="/assets/js/197.493d62fe.js"><link rel="prefetch" href="/assets/js/198.285ec3f4.js"><link rel="prefetch" href="/assets/js/199.c26664a8.js"><link rel="prefetch" href="/assets/js/20.c407011e.js"><link rel="prefetch" href="/assets/js/200.e172c025.js"><link rel="prefetch" href="/assets/js/201.88cbb622.js"><link rel="prefetch" href="/assets/js/202.da403177.js"><link rel="prefetch" href="/assets/js/203.6eb14b41.js"><link rel="prefetch" href="/assets/js/204.2ddae4bf.js"><link rel="prefetch" href="/assets/js/205.0a89efc1.js"><link rel="prefetch" href="/assets/js/206.480a66d3.js"><link rel="prefetch" href="/assets/js/207.bf5c1d60.js"><link rel="prefetch" href="/assets/js/208.b187dc67.js"><link rel="prefetch" href="/assets/js/209.20c99616.js"><link rel="prefetch" href="/assets/js/21.7edc8b1b.js"><link rel="prefetch" href="/assets/js/210.e4f1f766.js"><link rel="prefetch" href="/assets/js/211.1ed7b354.js"><link rel="prefetch" href="/assets/js/212.7e1243ab.js"><link rel="prefetch" href="/assets/js/213.6daddd4b.js"><link rel="prefetch" href="/assets/js/214.e548b00f.js"><link rel="prefetch" href="/assets/js/215.5e7f305a.js"><link rel="prefetch" href="/assets/js/216.d02d9a10.js"><link rel="prefetch" href="/assets/js/217.4ee282a4.js"><link rel="prefetch" href="/assets/js/218.d95d737e.js"><link rel="prefetch" href="/assets/js/219.fab5907a.js"><link rel="prefetch" href="/assets/js/22.fdbd00d3.js"><link rel="prefetch" href="/assets/js/220.56c6f7cc.js"><link rel="prefetch" href="/assets/js/221.3ee9e8ae.js"><link rel="prefetch" href="/assets/js/222.30c2d9ac.js"><link rel="prefetch" href="/assets/js/223.d6f5a1ce.js"><link rel="prefetch" href="/assets/js/224.b964e9b3.js"><link rel="prefetch" href="/assets/js/225.4f7cdb7b.js"><link rel="prefetch" href="/assets/js/226.34f5bc46.js"><link rel="prefetch" href="/assets/js/227.0c1d6c32.js"><link rel="prefetch" href="/assets/js/228.5c4850fa.js"><link rel="prefetch" href="/assets/js/229.0e83acaa.js"><link rel="prefetch" href="/assets/js/23.714595d5.js"><link rel="prefetch" href="/assets/js/230.d56ff6f6.js"><link rel="prefetch" href="/assets/js/231.19e033e0.js"><link rel="prefetch" href="/assets/js/232.b020bd32.js"><link rel="prefetch" href="/assets/js/233.19037210.js"><link rel="prefetch" href="/assets/js/234.10d14014.js"><link rel="prefetch" href="/assets/js/235.91bc5ad5.js"><link rel="prefetch" href="/assets/js/236.e9193180.js"><link rel="prefetch" href="/assets/js/237.e9be28a3.js"><link rel="prefetch" href="/assets/js/238.d1ac2fd8.js"><link rel="prefetch" href="/assets/js/239.44f2f146.js"><link rel="prefetch" href="/assets/js/24.2611c0d6.js"><link rel="prefetch" href="/assets/js/240.c8fe20cb.js"><link rel="prefetch" href="/assets/js/241.b232c3db.js"><link rel="prefetch" href="/assets/js/242.5bacdca9.js"><link rel="prefetch" href="/assets/js/243.bc85e605.js"><link rel="prefetch" href="/assets/js/244.975158d1.js"><link rel="prefetch" href="/assets/js/245.a139b48a.js"><link rel="prefetch" href="/assets/js/246.3138e906.js"><link rel="prefetch" href="/assets/js/247.070da83a.js"><link rel="prefetch" href="/assets/js/248.a1d8ac56.js"><link rel="prefetch" href="/assets/js/249.aadb0dca.js"><link rel="prefetch" href="/assets/js/25.2272f92f.js"><link rel="prefetch" href="/assets/js/250.c9cbf057.js"><link rel="prefetch" href="/assets/js/251.e8ddac0a.js"><link rel="prefetch" href="/assets/js/252.47894d0d.js"><link rel="prefetch" href="/assets/js/253.38f4c081.js"><link rel="prefetch" href="/assets/js/254.73808710.js"><link rel="prefetch" href="/assets/js/255.19234ae1.js"><link rel="prefetch" href="/assets/js/256.dbd6b6af.js"><link rel="prefetch" href="/assets/js/257.c16eae54.js"><link rel="prefetch" href="/assets/js/258.89a54cc9.js"><link rel="prefetch" href="/assets/js/259.ff8893b9.js"><link rel="prefetch" href="/assets/js/26.4d1df400.js"><link rel="prefetch" href="/assets/js/260.da83ef3e.js"><link rel="prefetch" href="/assets/js/261.39869cb6.js"><link rel="prefetch" href="/assets/js/262.6df31a71.js"><link rel="prefetch" href="/assets/js/263.a98eab49.js"><link rel="prefetch" href="/assets/js/264.1204725e.js"><link rel="prefetch" href="/assets/js/265.b6ce2d26.js"><link rel="prefetch" href="/assets/js/266.0c03e783.js"><link rel="prefetch" href="/assets/js/267.d686ec0e.js"><link rel="prefetch" href="/assets/js/268.e7c76c63.js"><link rel="prefetch" href="/assets/js/269.9ec0a34d.js"><link rel="prefetch" href="/assets/js/27.a88ca8bc.js"><link rel="prefetch" href="/assets/js/270.99f54d10.js"><link rel="prefetch" href="/assets/js/271.b9e143e2.js"><link rel="prefetch" href="/assets/js/272.1c93e968.js"><link rel="prefetch" href="/assets/js/273.7235d019.js"><link rel="prefetch" href="/assets/js/274.fbed798d.js"><link rel="prefetch" href="/assets/js/275.0006136b.js"><link rel="prefetch" href="/assets/js/276.8fc094f0.js"><link rel="prefetch" href="/assets/js/277.20e11e67.js"><link rel="prefetch" href="/assets/js/278.f8dc8f8f.js"><link rel="prefetch" href="/assets/js/279.651a9f88.js"><link rel="prefetch" href="/assets/js/28.69be6cc7.js"><link rel="prefetch" href="/assets/js/280.94aed3df.js"><link rel="prefetch" href="/assets/js/281.b9e4a0c1.js"><link rel="prefetch" href="/assets/js/282.fcbf917d.js"><link rel="prefetch" href="/assets/js/283.4b9335f2.js"><link rel="prefetch" href="/assets/js/284.a2748605.js"><link rel="prefetch" href="/assets/js/285.75119aca.js"><link rel="prefetch" href="/assets/js/286.a4a0abc2.js"><link rel="prefetch" href="/assets/js/287.0e10db49.js"><link rel="prefetch" href="/assets/js/288.540945f8.js"><link rel="prefetch" href="/assets/js/289.65991a71.js"><link rel="prefetch" href="/assets/js/29.3d144449.js"><link rel="prefetch" href="/assets/js/290.3cda3c0a.js"><link rel="prefetch" href="/assets/js/291.a7c9d6a2.js"><link rel="prefetch" href="/assets/js/292.2ce3fd5f.js"><link rel="prefetch" href="/assets/js/293.6572edb6.js"><link rel="prefetch" href="/assets/js/294.2a04291f.js"><link rel="prefetch" href="/assets/js/295.9a0fdf51.js"><link rel="prefetch" href="/assets/js/296.76bf15e5.js"><link rel="prefetch" href="/assets/js/297.ca22f9e0.js"><link rel="prefetch" href="/assets/js/298.dfd560c6.js"><link rel="prefetch" href="/assets/js/299.ea6a076f.js"><link rel="prefetch" href="/assets/js/3.19255846.js"><link rel="prefetch" href="/assets/js/30.c9924233.js"><link rel="prefetch" href="/assets/js/300.08ab4a0a.js"><link rel="prefetch" href="/assets/js/301.493634b6.js"><link rel="prefetch" href="/assets/js/302.088b770b.js"><link rel="prefetch" href="/assets/js/303.fdda8763.js"><link rel="prefetch" href="/assets/js/304.6e6a4a01.js"><link rel="prefetch" href="/assets/js/305.a3a1ae34.js"><link rel="prefetch" href="/assets/js/306.5835726c.js"><link rel="prefetch" href="/assets/js/307.0fce17cb.js"><link rel="prefetch" href="/assets/js/308.1e172ca3.js"><link rel="prefetch" href="/assets/js/309.80af26f3.js"><link rel="prefetch" href="/assets/js/31.f9f57568.js"><link rel="prefetch" href="/assets/js/310.b5f3ed6f.js"><link rel="prefetch" href="/assets/js/311.82c7e552.js"><link rel="prefetch" href="/assets/js/312.a48280c0.js"><link rel="prefetch" href="/assets/js/313.7c31693f.js"><link rel="prefetch" href="/assets/js/314.307f9eda.js"><link rel="prefetch" href="/assets/js/315.9f1e1099.js"><link rel="prefetch" href="/assets/js/316.7d255d6d.js"><link rel="prefetch" href="/assets/js/317.ef013a1a.js"><link rel="prefetch" href="/assets/js/318.64d24469.js"><link rel="prefetch" href="/assets/js/319.59c19af0.js"><link rel="prefetch" href="/assets/js/32.b29dc01b.js"><link rel="prefetch" href="/assets/js/320.add9fa10.js"><link rel="prefetch" href="/assets/js/321.22b199c2.js"><link rel="prefetch" href="/assets/js/322.ad9a2dff.js"><link rel="prefetch" href="/assets/js/323.b4183fc2.js"><link rel="prefetch" href="/assets/js/324.cf1aca23.js"><link rel="prefetch" href="/assets/js/325.83a4f1cf.js"><link rel="prefetch" href="/assets/js/326.f5c26436.js"><link rel="prefetch" href="/assets/js/327.16102be7.js"><link rel="prefetch" href="/assets/js/328.da84fbb0.js"><link rel="prefetch" href="/assets/js/329.4bdbc8ed.js"><link rel="prefetch" href="/assets/js/33.961516b8.js"><link rel="prefetch" href="/assets/js/330.0a98e84a.js"><link rel="prefetch" href="/assets/js/331.36e66e80.js"><link rel="prefetch" href="/assets/js/332.1b010d76.js"><link rel="prefetch" href="/assets/js/333.bf2def9d.js"><link rel="prefetch" href="/assets/js/334.373631c9.js"><link rel="prefetch" href="/assets/js/335.68121e51.js"><link rel="prefetch" href="/assets/js/336.49a94ea2.js"><link rel="prefetch" href="/assets/js/337.661abdcc.js"><link rel="prefetch" href="/assets/js/338.389c4be2.js"><link rel="prefetch" href="/assets/js/339.098329ed.js"><link rel="prefetch" href="/assets/js/34.7cb1f223.js"><link rel="prefetch" href="/assets/js/340.5c400f4d.js"><link rel="prefetch" href="/assets/js/341.41d84f2d.js"><link rel="prefetch" href="/assets/js/342.ef356713.js"><link rel="prefetch" href="/assets/js/343.d1e1952a.js"><link rel="prefetch" href="/assets/js/344.1980f7cc.js"><link rel="prefetch" href="/assets/js/345.0f7d9b9f.js"><link rel="prefetch" href="/assets/js/346.c3878425.js"><link rel="prefetch" href="/assets/js/347.dd74c55a.js"><link rel="prefetch" href="/assets/js/348.89584af8.js"><link rel="prefetch" href="/assets/js/349.c7bc7bc1.js"><link rel="prefetch" href="/assets/js/35.51ade70c.js"><link rel="prefetch" href="/assets/js/350.d2df1d20.js"><link rel="prefetch" href="/assets/js/351.a1b78a34.js"><link rel="prefetch" href="/assets/js/352.08ae09fd.js"><link rel="prefetch" href="/assets/js/353.aced76b3.js"><link rel="prefetch" href="/assets/js/354.f033ee07.js"><link rel="prefetch" href="/assets/js/355.95831785.js"><link rel="prefetch" href="/assets/js/356.893584e1.js"><link rel="prefetch" href="/assets/js/357.5f070ca5.js"><link rel="prefetch" href="/assets/js/358.35f2ade5.js"><link rel="prefetch" href="/assets/js/359.e45099bd.js"><link rel="prefetch" href="/assets/js/36.82c64b8f.js"><link rel="prefetch" href="/assets/js/360.59aa32f9.js"><link rel="prefetch" href="/assets/js/361.bd3c2fdd.js"><link rel="prefetch" href="/assets/js/362.3566e79d.js"><link rel="prefetch" href="/assets/js/363.b4ab82f7.js"><link rel="prefetch" href="/assets/js/364.7f50d299.js"><link rel="prefetch" href="/assets/js/365.4f8e93f6.js"><link rel="prefetch" href="/assets/js/366.8fd91814.js"><link rel="prefetch" href="/assets/js/367.0d47f5a8.js"><link rel="prefetch" href="/assets/js/368.fb7814d2.js"><link rel="prefetch" href="/assets/js/369.d6d8c504.js"><link rel="prefetch" href="/assets/js/37.5165b622.js"><link rel="prefetch" href="/assets/js/370.00a807a6.js"><link rel="prefetch" href="/assets/js/371.867a9db3.js"><link rel="prefetch" href="/assets/js/372.decca4ce.js"><link rel="prefetch" href="/assets/js/373.98b37511.js"><link rel="prefetch" href="/assets/js/374.6313e71a.js"><link rel="prefetch" href="/assets/js/375.f2e2fa05.js"><link rel="prefetch" href="/assets/js/376.7103c034.js"><link rel="prefetch" href="/assets/js/377.9bf388c9.js"><link rel="prefetch" href="/assets/js/378.57ae31cf.js"><link rel="prefetch" href="/assets/js/379.739ee8d7.js"><link rel="prefetch" href="/assets/js/38.563ce632.js"><link rel="prefetch" href="/assets/js/380.6256f3c8.js"><link rel="prefetch" href="/assets/js/381.38f7eb5a.js"><link rel="prefetch" href="/assets/js/382.ae035904.js"><link rel="prefetch" href="/assets/js/383.2d1b99c3.js"><link rel="prefetch" href="/assets/js/384.094517c8.js"><link rel="prefetch" href="/assets/js/385.62ddf499.js"><link rel="prefetch" href="/assets/js/386.8315cf9d.js"><link rel="prefetch" href="/assets/js/387.2bef00d3.js"><link rel="prefetch" href="/assets/js/388.178f867f.js"><link rel="prefetch" href="/assets/js/389.d893ba15.js"><link rel="prefetch" href="/assets/js/39.29556252.js"><link rel="prefetch" href="/assets/js/390.1b85f452.js"><link rel="prefetch" href="/assets/js/391.12fe014e.js"><link rel="prefetch" href="/assets/js/392.8c88755d.js"><link rel="prefetch" href="/assets/js/393.72aa7675.js"><link rel="prefetch" href="/assets/js/394.df13d1f7.js"><link rel="prefetch" href="/assets/js/395.8f8d96d9.js"><link rel="prefetch" href="/assets/js/396.aa362f3c.js"><link rel="prefetch" href="/assets/js/397.cca49694.js"><link rel="prefetch" href="/assets/js/398.d9fd0617.js"><link rel="prefetch" href="/assets/js/399.96f3fede.js"><link rel="prefetch" href="/assets/js/4.623783fc.js"><link rel="prefetch" href="/assets/js/40.0330d609.js"><link rel="prefetch" href="/assets/js/400.a1472f96.js"><link rel="prefetch" href="/assets/js/401.3d4e1a6b.js"><link rel="prefetch" href="/assets/js/402.0a8a7162.js"><link rel="prefetch" href="/assets/js/403.b1393b0f.js"><link rel="prefetch" href="/assets/js/404.7e485063.js"><link rel="prefetch" href="/assets/js/405.1037d751.js"><link rel="prefetch" href="/assets/js/406.ae7d83bb.js"><link rel="prefetch" href="/assets/js/407.cb9ade38.js"><link rel="prefetch" href="/assets/js/408.a105752d.js"><link rel="prefetch" href="/assets/js/409.a56202e0.js"><link rel="prefetch" href="/assets/js/41.dcb7a3f5.js"><link rel="prefetch" href="/assets/js/410.f615dd75.js"><link rel="prefetch" href="/assets/js/411.29882ac4.js"><link rel="prefetch" href="/assets/js/412.ed8e6abb.js"><link rel="prefetch" href="/assets/js/413.2a212c18.js"><link rel="prefetch" href="/assets/js/414.9717c94d.js"><link rel="prefetch" href="/assets/js/416.981646b8.js"><link rel="prefetch" href="/assets/js/417.3bcf1a86.js"><link rel="prefetch" href="/assets/js/418.d6d8bc33.js"><link rel="prefetch" href="/assets/js/419.79a736e3.js"><link rel="prefetch" href="/assets/js/42.61434728.js"><link rel="prefetch" href="/assets/js/420.bd2fe57b.js"><link rel="prefetch" href="/assets/js/421.040b2b27.js"><link rel="prefetch" href="/assets/js/422.5cc63c45.js"><link rel="prefetch" href="/assets/js/423.9d447e90.js"><link rel="prefetch" href="/assets/js/424.51734eb2.js"><link rel="prefetch" href="/assets/js/425.f6a00d75.js"><link rel="prefetch" href="/assets/js/426.896f7a5b.js"><link rel="prefetch" href="/assets/js/427.e099dd6a.js"><link rel="prefetch" href="/assets/js/428.beef8eb2.js"><link rel="prefetch" href="/assets/js/429.266ed61e.js"><link rel="prefetch" href="/assets/js/43.667a4108.js"><link rel="prefetch" href="/assets/js/430.cd857ec2.js"><link rel="prefetch" href="/assets/js/431.cb5550b2.js"><link rel="prefetch" href="/assets/js/432.3a31614c.js"><link rel="prefetch" href="/assets/js/433.c9f73ea8.js"><link rel="prefetch" href="/assets/js/434.c3d546a3.js"><link rel="prefetch" href="/assets/js/435.6a5558d5.js"><link rel="prefetch" href="/assets/js/436.fac0cdde.js"><link rel="prefetch" href="/assets/js/437.858e2dbc.js"><link rel="prefetch" href="/assets/js/438.4f6fd7f1.js"><link rel="prefetch" href="/assets/js/439.d823d6d5.js"><link rel="prefetch" href="/assets/js/44.2e051a69.js"><link rel="prefetch" href="/assets/js/440.8d4edefe.js"><link rel="prefetch" href="/assets/js/441.806f144c.js"><link rel="prefetch" href="/assets/js/442.56b1ae7b.js"><link rel="prefetch" href="/assets/js/443.0c9c92ed.js"><link rel="prefetch" href="/assets/js/444.4484d097.js"><link rel="prefetch" href="/assets/js/445.6e68718d.js"><link rel="prefetch" href="/assets/js/446.5bdd4ab4.js"><link rel="prefetch" href="/assets/js/447.6202d37b.js"><link rel="prefetch" href="/assets/js/448.88ae6dd3.js"><link rel="prefetch" href="/assets/js/449.2e911cca.js"><link rel="prefetch" href="/assets/js/45.08ce102a.js"><link rel="prefetch" href="/assets/js/450.16bda76e.js"><link rel="prefetch" href="/assets/js/451.ee603a5b.js"><link rel="prefetch" href="/assets/js/452.ff4a503b.js"><link rel="prefetch" href="/assets/js/453.f4bf543d.js"><link rel="prefetch" href="/assets/js/454.fb1e37fa.js"><link rel="prefetch" href="/assets/js/455.55467fe9.js"><link rel="prefetch" href="/assets/js/456.c1ccc8ef.js"><link rel="prefetch" href="/assets/js/457.aaeaefa6.js"><link rel="prefetch" href="/assets/js/458.f59b0607.js"><link rel="prefetch" href="/assets/js/459.201f603d.js"><link rel="prefetch" href="/assets/js/46.074adfe9.js"><link rel="prefetch" href="/assets/js/460.4e283c1a.js"><link rel="prefetch" href="/assets/js/461.c2492681.js"><link rel="prefetch" href="/assets/js/462.9362354d.js"><link rel="prefetch" href="/assets/js/463.a4087f38.js"><link rel="prefetch" href="/assets/js/464.e5828e7e.js"><link rel="prefetch" href="/assets/js/465.e95594b5.js"><link rel="prefetch" href="/assets/js/466.7b75c1f4.js"><link rel="prefetch" href="/assets/js/467.8e9d9c24.js"><link rel="prefetch" href="/assets/js/468.b87a6973.js"><link rel="prefetch" href="/assets/js/469.3411b392.js"><link rel="prefetch" href="/assets/js/47.8175158f.js"><link rel="prefetch" href="/assets/js/470.95363b28.js"><link rel="prefetch" href="/assets/js/471.21a1606b.js"><link rel="prefetch" href="/assets/js/472.f9687e9c.js"><link rel="prefetch" href="/assets/js/473.64f85306.js"><link rel="prefetch" href="/assets/js/474.8a9f362d.js"><link rel="prefetch" href="/assets/js/475.5d6399de.js"><link rel="prefetch" href="/assets/js/476.70d49b7b.js"><link rel="prefetch" href="/assets/js/477.7e3e21a3.js"><link rel="prefetch" href="/assets/js/478.67387462.js"><link rel="prefetch" href="/assets/js/479.a239eaa0.js"><link rel="prefetch" href="/assets/js/48.f20bc2b0.js"><link rel="prefetch" href="/assets/js/480.6f0b953b.js"><link rel="prefetch" href="/assets/js/481.b3ec6e3e.js"><link rel="prefetch" href="/assets/js/482.ef931c32.js"><link rel="prefetch" href="/assets/js/483.e2271a83.js"><link rel="prefetch" href="/assets/js/484.544c1072.js"><link rel="prefetch" href="/assets/js/485.d8a5505a.js"><link rel="prefetch" href="/assets/js/486.1ea2510a.js"><link rel="prefetch" href="/assets/js/487.e954f3bc.js"><link rel="prefetch" href="/assets/js/488.dbfe8c7c.js"><link rel="prefetch" href="/assets/js/489.92152c72.js"><link rel="prefetch" href="/assets/js/49.f4b7dc24.js"><link rel="prefetch" href="/assets/js/490.8ea88875.js"><link rel="prefetch" href="/assets/js/491.d1e2d1b6.js"><link rel="prefetch" href="/assets/js/492.217b7fd1.js"><link rel="prefetch" href="/assets/js/493.6d188156.js"><link rel="prefetch" href="/assets/js/494.adcca4bf.js"><link rel="prefetch" href="/assets/js/495.13cdbf74.js"><link rel="prefetch" href="/assets/js/496.53a4b758.js"><link rel="prefetch" href="/assets/js/497.0763c40d.js"><link rel="prefetch" href="/assets/js/498.debcfb1b.js"><link rel="prefetch" href="/assets/js/499.7d3cf6eb.js"><link rel="prefetch" href="/assets/js/50.41ac06fd.js"><link rel="prefetch" href="/assets/js/500.28473fb4.js"><link rel="prefetch" href="/assets/js/501.90241d8d.js"><link rel="prefetch" href="/assets/js/502.a096c362.js"><link rel="prefetch" href="/assets/js/503.539676ba.js"><link rel="prefetch" href="/assets/js/504.39d8e399.js"><link rel="prefetch" href="/assets/js/505.2b2a130b.js"><link rel="prefetch" href="/assets/js/506.7811ad79.js"><link rel="prefetch" href="/assets/js/507.2817d33b.js"><link rel="prefetch" href="/assets/js/508.89b8d712.js"><link rel="prefetch" href="/assets/js/509.80dcd2b5.js"><link rel="prefetch" href="/assets/js/51.3ef6cdbe.js"><link rel="prefetch" href="/assets/js/510.a8f28525.js"><link rel="prefetch" href="/assets/js/511.e890924a.js"><link rel="prefetch" href="/assets/js/512.9a073fe1.js"><link rel="prefetch" href="/assets/js/513.0a302efb.js"><link rel="prefetch" href="/assets/js/514.6b43f3e7.js"><link rel="prefetch" href="/assets/js/515.c7b0284a.js"><link rel="prefetch" href="/assets/js/516.5daf0566.js"><link rel="prefetch" href="/assets/js/517.67f7c508.js"><link rel="prefetch" href="/assets/js/518.7854e40b.js"><link rel="prefetch" href="/assets/js/519.dcb88d39.js"><link rel="prefetch" href="/assets/js/52.840d0f74.js"><link rel="prefetch" href="/assets/js/520.6f40c4e7.js"><link rel="prefetch" href="/assets/js/521.3c0a006c.js"><link rel="prefetch" href="/assets/js/522.ed57f1a7.js"><link rel="prefetch" href="/assets/js/523.39d637e2.js"><link rel="prefetch" href="/assets/js/524.acd5ee1f.js"><link rel="prefetch" href="/assets/js/525.0836647e.js"><link rel="prefetch" href="/assets/js/526.9e2af36c.js"><link rel="prefetch" href="/assets/js/527.9337d948.js"><link rel="prefetch" href="/assets/js/528.cacbd480.js"><link rel="prefetch" href="/assets/js/529.21a67f8f.js"><link rel="prefetch" href="/assets/js/53.fb86a936.js"><link rel="prefetch" href="/assets/js/530.3373ac51.js"><link rel="prefetch" href="/assets/js/531.1b371c24.js"><link rel="prefetch" href="/assets/js/532.64685d6d.js"><link rel="prefetch" href="/assets/js/533.d3344f80.js"><link rel="prefetch" href="/assets/js/534.1adcd2e2.js"><link rel="prefetch" href="/assets/js/535.cf0f4bbe.js"><link rel="prefetch" href="/assets/js/536.f3cadbc2.js"><link rel="prefetch" href="/assets/js/537.d2071727.js"><link rel="prefetch" href="/assets/js/538.b700925e.js"><link rel="prefetch" href="/assets/js/539.a5de8601.js"><link rel="prefetch" href="/assets/js/54.e8d5a023.js"><link rel="prefetch" href="/assets/js/540.525e8630.js"><link rel="prefetch" href="/assets/js/541.0b14ac8a.js"><link rel="prefetch" href="/assets/js/542.fc96e578.js"><link rel="prefetch" href="/assets/js/543.53cf25d0.js"><link rel="prefetch" href="/assets/js/544.f9b3e911.js"><link rel="prefetch" href="/assets/js/545.b353670e.js"><link rel="prefetch" href="/assets/js/546.5ed48a56.js"><link rel="prefetch" href="/assets/js/547.9843edce.js"><link rel="prefetch" href="/assets/js/548.f8eb7890.js"><link rel="prefetch" href="/assets/js/549.990650c2.js"><link rel="prefetch" href="/assets/js/55.b268240f.js"><link rel="prefetch" href="/assets/js/550.c7ba17a1.js"><link rel="prefetch" href="/assets/js/551.2ea79a07.js"><link rel="prefetch" href="/assets/js/552.950843bd.js"><link rel="prefetch" href="/assets/js/553.d1f94516.js"><link rel="prefetch" href="/assets/js/554.873b4336.js"><link rel="prefetch" href="/assets/js/555.12e7f37d.js"><link rel="prefetch" href="/assets/js/556.c84abfa5.js"><link rel="prefetch" href="/assets/js/557.76108e15.js"><link rel="prefetch" href="/assets/js/558.ad0caf91.js"><link rel="prefetch" href="/assets/js/559.efc5fcaa.js"><link rel="prefetch" href="/assets/js/56.862368c6.js"><link rel="prefetch" href="/assets/js/560.82032a52.js"><link rel="prefetch" href="/assets/js/561.b776e2e3.js"><link rel="prefetch" href="/assets/js/562.8f48c34e.js"><link rel="prefetch" href="/assets/js/563.1916b1f0.js"><link rel="prefetch" href="/assets/js/564.89eef1bf.js"><link rel="prefetch" href="/assets/js/565.2ca43acb.js"><link rel="prefetch" href="/assets/js/566.6caf93e6.js"><link rel="prefetch" href="/assets/js/567.1888604a.js"><link rel="prefetch" href="/assets/js/568.c909a75b.js"><link rel="prefetch" href="/assets/js/569.6862733a.js"><link rel="prefetch" href="/assets/js/57.d93cbd65.js"><link rel="prefetch" href="/assets/js/570.ce0e3115.js"><link rel="prefetch" href="/assets/js/571.0da49310.js"><link rel="prefetch" href="/assets/js/572.c34ca3fd.js"><link rel="prefetch" href="/assets/js/573.895c8f8d.js"><link rel="prefetch" href="/assets/js/574.e59b6191.js"><link rel="prefetch" href="/assets/js/575.842ef1ff.js"><link rel="prefetch" href="/assets/js/576.9b5dd540.js"><link rel="prefetch" href="/assets/js/577.2d0e6020.js"><link rel="prefetch" href="/assets/js/578.2e49a333.js"><link rel="prefetch" href="/assets/js/579.005171f1.js"><link rel="prefetch" href="/assets/js/58.10ca5b0d.js"><link rel="prefetch" href="/assets/js/580.74d9d14e.js"><link rel="prefetch" href="/assets/js/581.404aa6ad.js"><link rel="prefetch" href="/assets/js/582.4c756647.js"><link rel="prefetch" href="/assets/js/583.84f8db17.js"><link rel="prefetch" href="/assets/js/584.0c4307db.js"><link rel="prefetch" href="/assets/js/585.9cbe1c6c.js"><link rel="prefetch" href="/assets/js/586.94d5912f.js"><link rel="prefetch" href="/assets/js/587.08073e55.js"><link rel="prefetch" href="/assets/js/588.a4cb5da6.js"><link rel="prefetch" href="/assets/js/589.ff2423ac.js"><link rel="prefetch" href="/assets/js/59.3eb351e6.js"><link rel="prefetch" href="/assets/js/590.1a498879.js"><link rel="prefetch" href="/assets/js/591.eb8d6c20.js"><link rel="prefetch" href="/assets/js/592.850eee03.js"><link rel="prefetch" href="/assets/js/593.12b28022.js"><link rel="prefetch" href="/assets/js/594.9c805b81.js"><link rel="prefetch" href="/assets/js/595.e9119b0e.js"><link rel="prefetch" href="/assets/js/596.6b641a7e.js"><link rel="prefetch" href="/assets/js/597.77bf95f8.js"><link rel="prefetch" href="/assets/js/598.da53697e.js"><link rel="prefetch" href="/assets/js/599.281b72be.js"><link rel="prefetch" href="/assets/js/6.8773fb47.js"><link rel="prefetch" href="/assets/js/60.1c1a9cd1.js"><link rel="prefetch" href="/assets/js/600.4aa56a28.js"><link rel="prefetch" href="/assets/js/601.93029330.js"><link rel="prefetch" href="/assets/js/602.3dee7fe6.js"><link rel="prefetch" href="/assets/js/603.cdc313ee.js"><link rel="prefetch" href="/assets/js/604.965166a0.js"><link rel="prefetch" href="/assets/js/605.7c70961f.js"><link rel="prefetch" href="/assets/js/606.a9f02486.js"><link rel="prefetch" href="/assets/js/607.73baa5d1.js"><link rel="prefetch" href="/assets/js/608.e8fa09f4.js"><link rel="prefetch" href="/assets/js/609.ac51d009.js"><link rel="prefetch" href="/assets/js/61.9683ebee.js"><link rel="prefetch" href="/assets/js/610.644de93e.js"><link rel="prefetch" href="/assets/js/611.4435581a.js"><link rel="prefetch" href="/assets/js/612.27640be2.js"><link rel="prefetch" href="/assets/js/613.5010499b.js"><link rel="prefetch" href="/assets/js/614.cf985a78.js"><link rel="prefetch" href="/assets/js/615.175e2d87.js"><link rel="prefetch" href="/assets/js/616.c034e53d.js"><link rel="prefetch" href="/assets/js/617.fe843932.js"><link rel="prefetch" href="/assets/js/618.17ffbf18.js"><link rel="prefetch" href="/assets/js/619.c968374b.js"><link rel="prefetch" href="/assets/js/62.2276e6d3.js"><link rel="prefetch" href="/assets/js/620.f34c0fa0.js"><link rel="prefetch" href="/assets/js/621.815b8624.js"><link rel="prefetch" href="/assets/js/622.d534821e.js"><link rel="prefetch" href="/assets/js/623.936ac4e3.js"><link rel="prefetch" href="/assets/js/624.68e1aa29.js"><link rel="prefetch" href="/assets/js/625.07b94155.js"><link rel="prefetch" href="/assets/js/626.96720feb.js"><link rel="prefetch" href="/assets/js/627.6c0097f7.js"><link rel="prefetch" href="/assets/js/628.1b01c525.js"><link rel="prefetch" href="/assets/js/629.6b7b7051.js"><link rel="prefetch" href="/assets/js/63.21657e0e.js"><link rel="prefetch" href="/assets/js/630.5e364b4e.js"><link rel="prefetch" href="/assets/js/631.1dbc5bc2.js"><link rel="prefetch" href="/assets/js/632.26cf0433.js"><link rel="prefetch" href="/assets/js/633.f5940046.js"><link rel="prefetch" href="/assets/js/634.631e139f.js"><link rel="prefetch" href="/assets/js/635.dcb1483c.js"><link rel="prefetch" href="/assets/js/636.99b6e8c3.js"><link rel="prefetch" href="/assets/js/637.ac8ad035.js"><link rel="prefetch" href="/assets/js/638.5782cc19.js"><link rel="prefetch" href="/assets/js/639.1db80fe2.js"><link rel="prefetch" href="/assets/js/64.02fb1ddb.js"><link rel="prefetch" href="/assets/js/640.bc54f7f5.js"><link rel="prefetch" href="/assets/js/641.cdff8819.js"><link rel="prefetch" href="/assets/js/642.df23e220.js"><link rel="prefetch" href="/assets/js/643.89df1b3c.js"><link rel="prefetch" href="/assets/js/644.5f0031ba.js"><link rel="prefetch" href="/assets/js/645.f7daa126.js"><link rel="prefetch" href="/assets/js/646.d47a3e0e.js"><link rel="prefetch" href="/assets/js/647.d1c8f3ae.js"><link rel="prefetch" href="/assets/js/648.0506ce23.js"><link rel="prefetch" href="/assets/js/649.6cf2a641.js"><link rel="prefetch" href="/assets/js/65.b4028009.js"><link rel="prefetch" href="/assets/js/650.89785dee.js"><link rel="prefetch" href="/assets/js/651.8b6fa105.js"><link rel="prefetch" href="/assets/js/652.5e42ce8f.js"><link rel="prefetch" href="/assets/js/653.eddc84e1.js"><link rel="prefetch" href="/assets/js/654.48762cb9.js"><link rel="prefetch" href="/assets/js/655.7bcd5aa3.js"><link rel="prefetch" href="/assets/js/656.bf91b745.js"><link rel="prefetch" href="/assets/js/657.332eec27.js"><link rel="prefetch" href="/assets/js/658.9e9b31c8.js"><link rel="prefetch" href="/assets/js/659.b469808c.js"><link rel="prefetch" href="/assets/js/66.33d6767a.js"><link rel="prefetch" href="/assets/js/660.25843c88.js"><link rel="prefetch" href="/assets/js/661.ca1a9580.js"><link rel="prefetch" href="/assets/js/662.cd6fe6ce.js"><link rel="prefetch" href="/assets/js/663.dddb87c3.js"><link rel="prefetch" href="/assets/js/664.c4d2b9b4.js"><link rel="prefetch" href="/assets/js/665.e26ea7fd.js"><link rel="prefetch" href="/assets/js/666.918a92c2.js"><link rel="prefetch" href="/assets/js/667.5f06fa05.js"><link rel="prefetch" href="/assets/js/668.7b783af2.js"><link rel="prefetch" href="/assets/js/669.efe734b4.js"><link rel="prefetch" href="/assets/js/67.0737d4e2.js"><link rel="prefetch" href="/assets/js/670.70a7afa1.js"><link rel="prefetch" href="/assets/js/671.d82e7481.js"><link rel="prefetch" href="/assets/js/672.f4e33cf4.js"><link rel="prefetch" href="/assets/js/673.f3b26cca.js"><link rel="prefetch" href="/assets/js/674.d5327fdb.js"><link rel="prefetch" href="/assets/js/675.06e1587e.js"><link rel="prefetch" href="/assets/js/676.b81eab7c.js"><link rel="prefetch" href="/assets/js/677.65c1f157.js"><link rel="prefetch" href="/assets/js/678.dd3c35f4.js"><link rel="prefetch" href="/assets/js/679.1b3371c6.js"><link rel="prefetch" href="/assets/js/68.ff08cac1.js"><link rel="prefetch" href="/assets/js/680.4c431b6d.js"><link rel="prefetch" href="/assets/js/681.4b4df97f.js"><link rel="prefetch" href="/assets/js/682.daa28558.js"><link rel="prefetch" href="/assets/js/683.019ac4bf.js"><link rel="prefetch" href="/assets/js/684.72942987.js"><link rel="prefetch" href="/assets/js/685.b232df8f.js"><link rel="prefetch" href="/assets/js/686.27dc24b3.js"><link rel="prefetch" href="/assets/js/687.4a8ef826.js"><link rel="prefetch" href="/assets/js/688.0ba25fdf.js"><link rel="prefetch" href="/assets/js/689.be8172ba.js"><link rel="prefetch" href="/assets/js/69.516fa4ee.js"><link rel="prefetch" href="/assets/js/690.88418e50.js"><link rel="prefetch" href="/assets/js/691.1d8c222b.js"><link rel="prefetch" href="/assets/js/692.85d9e426.js"><link rel="prefetch" href="/assets/js/693.a78b6c7b.js"><link rel="prefetch" href="/assets/js/694.8348e02c.js"><link rel="prefetch" href="/assets/js/695.0bbdae98.js"><link rel="prefetch" href="/assets/js/696.f9dcc8bf.js"><link rel="prefetch" href="/assets/js/697.1c6c7982.js"><link rel="prefetch" href="/assets/js/698.fa867a93.js"><link rel="prefetch" href="/assets/js/699.5ad98f0b.js"><link rel="prefetch" href="/assets/js/7.e86883c6.js"><link rel="prefetch" href="/assets/js/70.d7c0b02d.js"><link rel="prefetch" href="/assets/js/700.da097ba8.js"><link rel="prefetch" href="/assets/js/701.8f40c007.js"><link rel="prefetch" href="/assets/js/702.2ac7cfc8.js"><link rel="prefetch" href="/assets/js/703.e4f83f34.js"><link rel="prefetch" href="/assets/js/704.3230d5d3.js"><link rel="prefetch" href="/assets/js/705.9f2ac56e.js"><link rel="prefetch" href="/assets/js/706.479ef752.js"><link rel="prefetch" href="/assets/js/707.12907b99.js"><link rel="prefetch" href="/assets/js/708.a54c005e.js"><link rel="prefetch" href="/assets/js/709.2f084e72.js"><link rel="prefetch" href="/assets/js/71.c9ef60a6.js"><link rel="prefetch" href="/assets/js/710.992d9298.js"><link rel="prefetch" href="/assets/js/711.3dec9e74.js"><link rel="prefetch" href="/assets/js/712.fbba000f.js"><link rel="prefetch" href="/assets/js/713.644be223.js"><link rel="prefetch" href="/assets/js/714.20e703bd.js"><link rel="prefetch" href="/assets/js/715.7ac51064.js"><link rel="prefetch" href="/assets/js/716.5f8c7487.js"><link rel="prefetch" href="/assets/js/717.cdd46244.js"><link rel="prefetch" href="/assets/js/718.7b7a44e2.js"><link rel="prefetch" href="/assets/js/719.ed06b003.js"><link rel="prefetch" href="/assets/js/72.c23e24e9.js"><link rel="prefetch" href="/assets/js/720.202718be.js"><link rel="prefetch" href="/assets/js/721.1426ef3c.js"><link rel="prefetch" href="/assets/js/722.79f56663.js"><link rel="prefetch" href="/assets/js/723.6dcfa3ed.js"><link rel="prefetch" href="/assets/js/724.4c098acf.js"><link rel="prefetch" href="/assets/js/725.381dd189.js"><link rel="prefetch" href="/assets/js/726.baa6dcfe.js"><link rel="prefetch" href="/assets/js/727.f893500e.js"><link rel="prefetch" href="/assets/js/728.977ee9a0.js"><link rel="prefetch" href="/assets/js/729.3dc27591.js"><link rel="prefetch" href="/assets/js/73.d2b5812c.js"><link rel="prefetch" href="/assets/js/730.e62b3efb.js"><link rel="prefetch" href="/assets/js/731.8b21fd00.js"><link rel="prefetch" href="/assets/js/732.0e4b5daf.js"><link rel="prefetch" href="/assets/js/733.1cc505b4.js"><link rel="prefetch" href="/assets/js/734.55c0fe79.js"><link rel="prefetch" href="/assets/js/735.4eb02d3a.js"><link rel="prefetch" href="/assets/js/736.40c2728a.js"><link rel="prefetch" href="/assets/js/737.73c562f3.js"><link rel="prefetch" href="/assets/js/738.6dd69adf.js"><link rel="prefetch" href="/assets/js/739.af66a4dc.js"><link rel="prefetch" href="/assets/js/74.408525bc.js"><link rel="prefetch" href="/assets/js/740.eff57d99.js"><link rel="prefetch" href="/assets/js/741.7c9b1745.js"><link rel="prefetch" href="/assets/js/742.87bf09be.js"><link rel="prefetch" href="/assets/js/743.fd587ae7.js"><link rel="prefetch" href="/assets/js/744.b207d76b.js"><link rel="prefetch" href="/assets/js/745.5da05a37.js"><link rel="prefetch" href="/assets/js/746.05f0fcc4.js"><link rel="prefetch" href="/assets/js/747.8afc4f80.js"><link rel="prefetch" href="/assets/js/748.a6328657.js"><link rel="prefetch" href="/assets/js/749.488acffe.js"><link rel="prefetch" href="/assets/js/75.d6223e36.js"><link rel="prefetch" href="/assets/js/750.b778f9b2.js"><link rel="prefetch" href="/assets/js/751.046fb057.js"><link rel="prefetch" href="/assets/js/752.4fa1c3ec.js"><link rel="prefetch" href="/assets/js/753.2023ccf5.js"><link rel="prefetch" href="/assets/js/754.68df0df4.js"><link rel="prefetch" href="/assets/js/755.7289134a.js"><link rel="prefetch" href="/assets/js/756.bce7616e.js"><link rel="prefetch" href="/assets/js/757.3403e5f9.js"><link rel="prefetch" href="/assets/js/758.8f0d0bdf.js"><link rel="prefetch" href="/assets/js/759.cdd31702.js"><link rel="prefetch" href="/assets/js/76.f65eed64.js"><link rel="prefetch" href="/assets/js/760.9bfe29ed.js"><link rel="prefetch" href="/assets/js/761.e23339c6.js"><link rel="prefetch" href="/assets/js/762.db375c5b.js"><link rel="prefetch" href="/assets/js/763.8b16c3fe.js"><link rel="prefetch" href="/assets/js/764.f1f4f712.js"><link rel="prefetch" href="/assets/js/765.23e53b3a.js"><link rel="prefetch" href="/assets/js/766.3d3bb3ff.js"><link rel="prefetch" href="/assets/js/767.35ad7cea.js"><link rel="prefetch" href="/assets/js/768.295d1f7a.js"><link rel="prefetch" href="/assets/js/769.2f8fe776.js"><link rel="prefetch" href="/assets/js/77.ec9614b4.js"><link rel="prefetch" href="/assets/js/770.a89ea5e2.js"><link rel="prefetch" href="/assets/js/771.0d2cf3ee.js"><link rel="prefetch" href="/assets/js/772.a10354a4.js"><link rel="prefetch" href="/assets/js/773.ee60e68b.js"><link rel="prefetch" href="/assets/js/774.ba4aad28.js"><link rel="prefetch" href="/assets/js/775.7d35f9cc.js"><link rel="prefetch" href="/assets/js/776.b3ec764c.js"><link rel="prefetch" href="/assets/js/777.c124aefe.js"><link rel="prefetch" href="/assets/js/778.325cfc0e.js"><link rel="prefetch" href="/assets/js/779.d2b575a6.js"><link rel="prefetch" href="/assets/js/78.f56b2037.js"><link rel="prefetch" href="/assets/js/780.218c6b47.js"><link rel="prefetch" href="/assets/js/781.0eac52b7.js"><link rel="prefetch" href="/assets/js/782.79965326.js"><link rel="prefetch" href="/assets/js/783.60892b73.js"><link rel="prefetch" href="/assets/js/784.b8f79fd0.js"><link rel="prefetch" href="/assets/js/785.0528258e.js"><link rel="prefetch" href="/assets/js/786.1dbadb12.js"><link rel="prefetch" href="/assets/js/787.f247b164.js"><link rel="prefetch" href="/assets/js/788.3dd93a34.js"><link rel="prefetch" href="/assets/js/789.7b97a48d.js"><link rel="prefetch" href="/assets/js/79.ed5ad905.js"><link rel="prefetch" href="/assets/js/790.8ceeb0b3.js"><link rel="prefetch" href="/assets/js/791.e926d9a8.js"><link rel="prefetch" href="/assets/js/792.3e5a323a.js"><link rel="prefetch" href="/assets/js/793.43419085.js"><link rel="prefetch" href="/assets/js/794.b8c22345.js"><link rel="prefetch" href="/assets/js/795.7370ff3c.js"><link rel="prefetch" href="/assets/js/796.9509e009.js"><link rel="prefetch" href="/assets/js/797.4a4202c2.js"><link rel="prefetch" href="/assets/js/798.3961cf47.js"><link rel="prefetch" href="/assets/js/799.69707d57.js"><link rel="prefetch" href="/assets/js/8.3fe9535a.js"><link rel="prefetch" href="/assets/js/80.202c3322.js"><link rel="prefetch" href="/assets/js/800.f72c31a2.js"><link rel="prefetch" href="/assets/js/801.2372cb79.js"><link rel="prefetch" href="/assets/js/802.3aefd131.js"><link rel="prefetch" href="/assets/js/803.18443761.js"><link rel="prefetch" href="/assets/js/804.301bf327.js"><link rel="prefetch" href="/assets/js/805.e169a32a.js"><link rel="prefetch" href="/assets/js/806.27cbd296.js"><link rel="prefetch" href="/assets/js/807.b0443249.js"><link rel="prefetch" href="/assets/js/808.91924bc7.js"><link rel="prefetch" href="/assets/js/809.865e8932.js"><link rel="prefetch" href="/assets/js/81.9d064e1c.js"><link rel="prefetch" href="/assets/js/810.28dafb2c.js"><link rel="prefetch" href="/assets/js/811.9248d0a5.js"><link rel="prefetch" href="/assets/js/812.8bb147f8.js"><link rel="prefetch" href="/assets/js/813.57a8a982.js"><link rel="prefetch" href="/assets/js/814.f80c73c9.js"><link rel="prefetch" href="/assets/js/815.2b3d99fc.js"><link rel="prefetch" href="/assets/js/816.4a05e284.js"><link rel="prefetch" href="/assets/js/817.6c8508c2.js"><link rel="prefetch" href="/assets/js/818.c72f5330.js"><link rel="prefetch" href="/assets/js/819.35126624.js"><link rel="prefetch" href="/assets/js/82.210310b3.js"><link rel="prefetch" href="/assets/js/820.d5254c3c.js"><link rel="prefetch" href="/assets/js/821.c69c6b2c.js"><link rel="prefetch" href="/assets/js/822.1ccbb204.js"><link rel="prefetch" href="/assets/js/823.0436449a.js"><link rel="prefetch" href="/assets/js/824.a9d3c6f0.js"><link rel="prefetch" href="/assets/js/825.f9bf8329.js"><link rel="prefetch" href="/assets/js/826.e0d5f786.js"><link rel="prefetch" href="/assets/js/827.cf88e320.js"><link rel="prefetch" href="/assets/js/828.67da7389.js"><link rel="prefetch" href="/assets/js/829.21c2eac1.js"><link rel="prefetch" href="/assets/js/83.d74f6f93.js"><link rel="prefetch" href="/assets/js/830.1eb4ea1b.js"><link rel="prefetch" href="/assets/js/831.6b51565e.js"><link rel="prefetch" href="/assets/js/832.07a20675.js"><link rel="prefetch" href="/assets/js/833.0f7823b8.js"><link rel="prefetch" href="/assets/js/834.27bf9c2e.js"><link rel="prefetch" href="/assets/js/835.409429ce.js"><link rel="prefetch" href="/assets/js/836.28de2c29.js"><link rel="prefetch" href="/assets/js/837.5e7df1f1.js"><link rel="prefetch" href="/assets/js/838.5adc5f6e.js"><link rel="prefetch" href="/assets/js/839.11c3bfc2.js"><link rel="prefetch" href="/assets/js/84.4cf98a31.js"><link rel="prefetch" href="/assets/js/840.65d20fee.js"><link rel="prefetch" href="/assets/js/841.1949a396.js"><link rel="prefetch" href="/assets/js/842.f7a8d098.js"><link rel="prefetch" href="/assets/js/843.65694aa6.js"><link rel="prefetch" href="/assets/js/844.7a62cf9b.js"><link rel="prefetch" href="/assets/js/85.22b95924.js"><link rel="prefetch" href="/assets/js/86.a6f80a36.js"><link rel="prefetch" href="/assets/js/87.3b138e3b.js"><link rel="prefetch" href="/assets/js/88.bb56b7a2.js"><link rel="prefetch" href="/assets/js/89.198a78ff.js"><link rel="prefetch" href="/assets/js/9.59b98557.js"><link rel="prefetch" href="/assets/js/90.d743afe3.js"><link rel="prefetch" href="/assets/js/91.3b6d096c.js"><link rel="prefetch" href="/assets/js/92.a61a93f5.js"><link rel="prefetch" href="/assets/js/93.89cc3bad.js"><link rel="prefetch" href="/assets/js/94.fafb4ea3.js"><link rel="prefetch" href="/assets/js/95.52a52f2e.js"><link rel="prefetch" href="/assets/js/96.82379902.js"><link rel="prefetch" href="/assets/js/97.fb013838.js"><link rel="prefetch" href="/assets/js/98.17d2f72a.js"><link rel="prefetch" href="/assets/js/99.b355b28b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.183d1d00.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-17815e06><header class="navbar" data-v-17815e06><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/logo.png" alt="智能后端和架构" class="logo"> <span class="site-name can-hide">智能后端和架构</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/readguide.html" class="nav-link">
  导读
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java基础" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java基础" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Java语言基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/intro/01-java-intro.html" class="nav-link">
  Java入门介绍
</a></li><li class="dropdown-subitem"><a href="/java/intro/03-java-grammer.html" class="nav-link">
  Java基础语法
</a></li></ul></li><li class="dropdown-item"><h4>
          Java面向对象基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/basic/01-lan-feature.html" class="nav-link">
  语言基础特性
</a></li><li class="dropdown-subitem"><a href="/java/basic/02-oop-feature.html" class="nav-link">
  面向对象特征
</a></li></ul></li><li class="dropdown-item"><h4>
          Java集合类编程
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/collection/01-intro.html" class="nav-link">
  集合类基础介绍
</a></li><li class="dropdown-subitem"><a href="/java/collection/02-collectionmap.html" class="nav-link">
  集合框架Collction、Map
</a></li></ul></li><li class="dropdown-item"><h4>
          Java文件和网络编程
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/file/01-intro.html" class="nav-link">
  Java文件IO流入门
</a></li><li class="dropdown-subitem"><a href="/java/net/01-intro.html" class="nav-link">
  Java网络编程入门
</a></li></ul></li><li class="dropdown-item"><h4>
          Java并发编程和JUC
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/thread/01-intro.html" class="nav-link">
  Java并发 基础入门
</a></li><li class="dropdown-subitem"><a href="/java/juc/01-intro.html" class="nav-link">
  Java并发 JUC入门
</a></li></ul></li><li class="dropdown-item"><h4>
          Java虚拟机和语言特性
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/jvm/01-intro.html" class="nav-link">
  Java  虚拟机
</a></li><li class="dropdown-subitem"><a href="/java/characteristic/01-java8.html" class="nav-link">
  Java8 语言特性
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          数据库基础和SQL
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/db/intro/01-intro.html" class="nav-link">
  数据库绪论
</a></li><li class="dropdown-subitem"><a href="/db/intro/02-relationdb.html" class="nav-link">
  关系数据库
</a></li><li class="dropdown-subitem"><a href="/db/comsql/01-basicselect.html" class="nav-link">
  基本查询SQL
</a></li><li class="dropdown-subitem"><a href="/db/comsql/02-joinselect.html" class="nav-link">
  连表查询SQL
</a></li></ul></li><li class="dropdown-item"><h4>
          MySQL基础和优化
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/db/mysqlbasic/01-intro.html" class="nav-link">
  入门介绍
</a></li><li class="dropdown-subitem"><a href="/db/mysqlopt1/01-solutionsum.html" class="nav-link">
  性能优化方案
</a></li><li class="dropdown-subitem"><a href="/db/mysqlopt2/01-districtandtable.html" class="nav-link">
  分区和分表
</a></li><li class="dropdown-subitem"><a href="/db/mysqlopt2/05-readwritesepration.html" class="nav-link">
  读写分离介绍
</a></li></ul></li><li class="dropdown-item"><h4>
          NoSQL数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/db/redis/01-intro.html" class="nav-link">
  Redis介绍和总结
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          基础概念总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/algorithm/basic/01-basicconcept.html" class="nav-link">
  数据结构基础概念
</a></li><li class="dropdown-subitem"><a href="/algorithm/basic/02-intro.html" class="nav-link">
  算法和数据结构介绍
</a></li><li class="dropdown-subitem"><a href="/algorithm/visual/01-commondy.html" class="nav-link">
  常用算法动态展示
</a></li><li class="dropdown-subitem"><a href="/algorithm/visual/04-visualgo.html" class="nav-link">
  visualgo-中文算法展示
</a></li></ul></li><li class="dropdown-item"><h4>
          算法思想总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/algorithm/thought/01-thoughts8intro.html" class="nav-link">
  八种常用算法思想
</a></li><li class="dropdown-subitem"><a href="/algorithm/thought/02-thoughts5intro.html" class="nav-link">
  五种基本算法思想
</a></li></ul></li><li class="dropdown-item"><h4>
          常用算法总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/algorithm/search/01-intro.html" class="nav-link">
  常用查找算法-介绍
</a></li><li class="dropdown-subitem"><a href="/algorithm/sort/01-intro.html" class="nav-link">
  常用排序算法-介绍
</a></li><li class="dropdown-subitem"><a href="/algorithm/strmatch/01-intro.html" class="nav-link">
  常用字符串匹配-介绍
</a></li><li class="dropdown-subitem"><a href="/algorithm/encryption/01-intro.html" class="nav-link">
  常用加密解密算法-介绍
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">大数据</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          基础知识总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/bigdata/intro/01-intro.html" class="nav-link">
  入门知识介绍
</a></li><li class="dropdown-subitem"><a href="/bigdata/techintro/01-intro.html" class="nav-link">
  技术体系介绍
</a></li></ul></li><li class="dropdown-item"><h4>
          数据采集总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dc/intro/01-intro.html" class="nav-link">
  入门知识介绍
</a></li><li class="dropdown-subitem"><a href="/dc/intro/02-diff.html" class="nav-link">
  常用工具比较
</a></li></ul></li><li class="dropdown-item"><h4>
          数据存储总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ds/intro/01-basicintro.html" class="nav-link">
  Hadoop入门介绍
</a></li><li class="dropdown-subitem"><a href="/ds/intro/02-detailintro.html" class="nav-link">
  Hadoop生态介绍
</a></li></ul></li><li class="dropdown-item"><h4>
          数据仓库总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dw/intro/01-intro.html" class="nav-link">
  数据仓库入门介绍
</a></li><li class="dropdown-subitem"><a href="/dw/intro/03-summary.html" class="nav-link">
  数据仓库精华总结
</a></li></ul></li><li class="dropdown-item"><h4>
          数据处理总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dp/mr/01-intro.html" class="nav-link">
  MapReduce-入门介绍
</a></li><li class="dropdown-subitem"><a href="/dp/mr/02-basicprin.html" class="nav-link">
  MapReduce-工作原理
</a></li></ul></li><li class="dropdown-item"><h4>
          数据应用总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/da/intro/01-intro.html" class="nav-link">
  大数据应用场景基础介绍
</a></li><li class="dropdown-subitem"><a href="/dm/intro/01-intro.html" class="nav-link">
  大数据数据挖掘基础介绍
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">人工智能</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">人工智能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          基础知识总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ai/intro/01-intro.html" class="nav-link">
  人工智能基础介绍
</a></li><li class="dropdown-subitem"><a href="/ai/mlintro/01-intro.html" class="nav-link">
  机器学习基础介绍
</a></li><li class="dropdown-subitem"><a href="/ai/dlintro/01-intro.html" class="nav-link">
  深度学习基础介绍
</a></li><li class="dropdown-subitem"><a href="/ai/nnprin/01-intro.html" class="nav-link">
  神经网络原理介绍
</a></li><li class="dropdown-subitem"><a href="/ai/mlalgorithm/01-intro.html" class="nav-link">
  机器学习算法介绍
</a></li><li class="dropdown-subitem"><a href="/ai/mlmath/01-intro.html" class="nav-link">
  机器学习数学介绍
</a></li></ul></li><li class="dropdown-item"><h4>
          开发框架总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ad/intro/01-intro.html" class="nav-link">
  主流-AI开源开发框架介绍
</a></li><li class="dropdown-subitem"><a href="/ad/dl4jintro/01-intro.html" class="nav-link">
  JAVA-AI开发框架Dl4j介绍
</a></li><li class="dropdown-subitem"><a href="/ad/pytorch/01-intro.html" class="nav-link">
  AI开发框架-Pytorch介绍
</a></li><li class="dropdown-subitem"><a href="/ad/tensorflow/01-intro.html" class="nav-link">
  AI开发框架-TensorFlow介绍
</a></li></ul></li><li class="dropdown-item"><h4>
          开发应用案例
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ac/intro/01-intro.html" class="nav-link">
  AI常见案例和趋势介绍
</a></li><li class="dropdown-subitem"><a href="/ac/rsintro/01-intro.html" class="nav-link">
  AI应用案例-推荐系统介绍
</a></li><li class="dropdown-subitem"><a href="/ac/aicity/01-intro.html" class="nav-link">
  AI应用案例-智慧城市介绍
</a></li><li class="dropdown-subitem"><a href="/ac/aibigscreen/01-intro.html" class="nav-link">
  AI应用案例-智慧大屏介绍
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">Spring</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">Spring</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Spring基础知识
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/spring/basic/01-intro.html" class="nav-link">
  Spring-入门介绍
</a></li><li class="dropdown-subitem"><a href="/spring/basic/02-iocaopintro.html" class="nav-link">
  IOC和AOP-原理介绍
</a></li></ul></li><li class="dropdown-item"><h4>
          SpringMVC总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/spring/springmvc/01-intro.html" class="nav-link">
  SpringMVC-入门介绍
</a></li><li class="dropdown-subitem"><a href="/spring/springmvc/02-prinintro.html" class="nav-link">
  SpringMVC-工作原理介绍
</a></li></ul></li><li class="dropdown-item"><h4>
          SpringBoot总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/spring/springboot/03-workprin.html" class="nav-link">
  SpringBoot-工作原理
</a></li><li class="dropdown-subitem"><a href="/spring/springboot/06-startprincodeanalysis.html" class="nav-link">
  启动原理分析和源码解读
</a></li></ul></li><li class="dropdown-item"><h4>
          Spring注解总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/spring/annotation/03-springannprin.html" class="nav-link">
  Spring注解实现原理
</a></li><li class="dropdown-subitem"><a href="/spring/annotation/04-anntotal1.html" class="nav-link">
  Spring注解大全(一)
</a></li></ul></li><li class="dropdown-item"><h4>
          SpringCloud知识介绍
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/spring/springcloud/01-intro.html" class="nav-link">
  SpringCloud-基础介绍
</a></li><li class="dropdown-subitem"><a href="/spring/springcloud/03-prindetail.html" class="nav-link">
  SpringCloud-原理详解
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          框架基础总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/framework/basic/01-intro.html" class="nav-link">
  框架基础知识介绍
</a></li><li class="dropdown-subitem"><a href="/framework/basic/02-commconceptdiff.html" class="nav-link">
  框架架构组件区别
</a></li><li class="dropdown-subitem"><a href="/framework/basic/03-commconceptrela.html" class="nav-link">
  框架架构组件关系
</a></li><li class="dropdown-subitem"><a href="/framework/basic/06-microserv15.html" class="nav-link">
  常见15种微服务框架
</a></li><li class="dropdown-subitem"><a href="/framework/basic/07-springframethink.html" class="nav-link">
  Spring框架思想总结
</a></li></ul></li><li class="dropdown-item"><h4>
          常用框架总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/framework/log/01-intro.html" class="nav-link">
  日志框架-介绍和总结
</a></li><li class="dropdown-subitem"><a href="/framework/orm/01-intro.html" class="nav-link">
  ORM框架-介绍和总结
</a></li><li class="dropdown-subitem"><a href="/framework/nio/01-intro.html" class="nav-link">
  NIO框架-介绍和总结
</a></li><li class="dropdown-subitem"><a href="/framework/netty/01-intro.html" class="nav-link">
  Netty框架-介绍和总结
</a></li><li class="dropdown-subitem"><a href="/framework/nettycase/01-intro.html" class="nav-link">
  Netty案例-介绍和总结
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">架构</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">架构</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          架构基础知识
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/architecture/basic/01-intro.html" class="nav-link">
  架构基础知识介绍
</a></li><li class="dropdown-subitem"><a href="/architecture/basic/02-essence.html" class="nav-link">
  架构基本概念和本质
</a></li><li class="dropdown-subitem"><a href="/architecture/microservanddistribute/01-intro.html" class="nav-link">
  微服务架构知识介绍
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">开发</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          开发工具
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dev/tool/01-intro.html" class="nav-link">
  Java开发工具介绍
</a></li><li class="dropdown-subitem"><a href="/dev/tool/05-idea20recommendedplug.html" class="nav-link">
  Idea开发插件推荐
</a></li></ul></li><li class="dropdown-item"><h4>
          开发规范
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dev/standard/01-intro.html" class="nav-link">
  Java开发规范
</a></li><li class="dropdown-subitem"><a href="/dev/designpattern/01-intro.html" class="nav-link">
  Java设计模式
</a></li></ul></li><li class="dropdown-item"><h4>
          开发效率
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dev/deveffciency/02-commpromethods.html" class="nav-link">
  效率提升常用方法
</a></li><li class="dropdown-subitem"><a href="/dev/deveffciency/09-summary.html" class="nav-link">
  效率提升精华总结
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">综合</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">综合</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          中间件
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/middleware/mq/01-intro.html" class="nav-link">
  MQ消息队列介绍
</a></li><li class="dropdown-subitem"><a href="/es/basic/01-intro.html" class="nav-link">
  ES搜索服务器介绍
</a></li><li class="dropdown-subitem"><a href="/middleware/zookeeper/01-intro.html" class="nav-link">
  Zookeeper介绍
</a></li></ul></li><li class="dropdown-item"><h4>
          综合技能
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/mysqlop/basic/01-intro.html" class="nav-link">
  MySQL运维总结
</a></li><li class="dropdown-subitem"><a href="/operation/linux/01-intro.html" class="nav-link">
  Linux常用命令
</a></li><li class="dropdown-subitem"><a href="/operation/ng/05-ngsum.html" class="nav-link">
  Nginx使用总结
</a></li><li class="dropdown-subitem"><a href="/post/javabasic/01-javabasic.html" class="nav-link">
  求职面试整理
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">项目|产品</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">项目|产品</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          研发效能介绍
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/projprod/rdefficiencyintro/01-intro.html" class="nav-link">
  研发效能入门介绍
</a></li><li class="dropdown-subitem"><a href="/projprod/rdefficiencyintro/06-efficiencysystem.html" class="nav-link">
  研发效能体系构建
</a></li></ul></li><li class="dropdown-item"><h4>
          研发效能提升
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/projprod/rdeffciencypromote/09-summary.html" class="nav-link">
  研发效能提升精华总结
</a></li><li class="dropdown-subitem"><a href="/projprod/rdeffciencytool/01-intro.html" class="nav-link">
  研发效能系统管理工具
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/about/aboutme.html" class="nav-link">
  关于
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-17815e06></div> <aside class="sidebar" data-v-17815e06><nav class="nav-links"><div class="nav-item"><a href="/readguide.html" class="nav-link">
  导读
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java基础" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java基础" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Java语言基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/intro/01-java-intro.html" class="nav-link">
  Java入门介绍
</a></li><li class="dropdown-subitem"><a href="/java/intro/03-java-grammer.html" class="nav-link">
  Java基础语法
</a></li></ul></li><li class="dropdown-item"><h4>
          Java面向对象基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/basic/01-lan-feature.html" class="nav-link">
  语言基础特性
</a></li><li class="dropdown-subitem"><a href="/java/basic/02-oop-feature.html" class="nav-link">
  面向对象特征
</a></li></ul></li><li class="dropdown-item"><h4>
          Java集合类编程
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/collection/01-intro.html" class="nav-link">
  集合类基础介绍
</a></li><li class="dropdown-subitem"><a href="/java/collection/02-collectionmap.html" class="nav-link">
  集合框架Collction、Map
</a></li></ul></li><li class="dropdown-item"><h4>
          Java文件和网络编程
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/file/01-intro.html" class="nav-link">
  Java文件IO流入门
</a></li><li class="dropdown-subitem"><a href="/java/net/01-intro.html" class="nav-link">
  Java网络编程入门
</a></li></ul></li><li class="dropdown-item"><h4>
          Java并发编程和JUC
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/thread/01-intro.html" class="nav-link">
  Java并发 基础入门
</a></li><li class="dropdown-subitem"><a href="/java/juc/01-intro.html" class="nav-link">
  Java并发 JUC入门
</a></li></ul></li><li class="dropdown-item"><h4>
          Java虚拟机和语言特性
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/jvm/01-intro.html" class="nav-link">
  Java  虚拟机
</a></li><li class="dropdown-subitem"><a href="/java/characteristic/01-java8.html" class="nav-link">
  Java8 语言特性
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          数据库基础和SQL
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/db/intro/01-intro.html" class="nav-link">
  数据库绪论
</a></li><li class="dropdown-subitem"><a href="/db/intro/02-relationdb.html" class="nav-link">
  关系数据库
</a></li><li class="dropdown-subitem"><a href="/db/comsql/01-basicselect.html" class="nav-link">
  基本查询SQL
</a></li><li class="dropdown-subitem"><a href="/db/comsql/02-joinselect.html" class="nav-link">
  连表查询SQL
</a></li></ul></li><li class="dropdown-item"><h4>
          MySQL基础和优化
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/db/mysqlbasic/01-intro.html" class="nav-link">
  入门介绍
</a></li><li class="dropdown-subitem"><a href="/db/mysqlopt1/01-solutionsum.html" class="nav-link">
  性能优化方案
</a></li><li class="dropdown-subitem"><a href="/db/mysqlopt2/01-districtandtable.html" class="nav-link">
  分区和分表
</a></li><li class="dropdown-subitem"><a href="/db/mysqlopt2/05-readwritesepration.html" class="nav-link">
  读写分离介绍
</a></li></ul></li><li class="dropdown-item"><h4>
          NoSQL数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/db/redis/01-intro.html" class="nav-link">
  Redis介绍和总结
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          基础概念总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/algorithm/basic/01-basicconcept.html" class="nav-link">
  数据结构基础概念
</a></li><li class="dropdown-subitem"><a href="/algorithm/basic/02-intro.html" class="nav-link">
  算法和数据结构介绍
</a></li><li class="dropdown-subitem"><a href="/algorithm/visual/01-commondy.html" class="nav-link">
  常用算法动态展示
</a></li><li class="dropdown-subitem"><a href="/algorithm/visual/04-visualgo.html" class="nav-link">
  visualgo-中文算法展示
</a></li></ul></li><li class="dropdown-item"><h4>
          算法思想总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/algorithm/thought/01-thoughts8intro.html" class="nav-link">
  八种常用算法思想
</a></li><li class="dropdown-subitem"><a href="/algorithm/thought/02-thoughts5intro.html" class="nav-link">
  五种基本算法思想
</a></li></ul></li><li class="dropdown-item"><h4>
          常用算法总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/algorithm/search/01-intro.html" class="nav-link">
  常用查找算法-介绍
</a></li><li class="dropdown-subitem"><a href="/algorithm/sort/01-intro.html" class="nav-link">
  常用排序算法-介绍
</a></li><li class="dropdown-subitem"><a href="/algorithm/strmatch/01-intro.html" class="nav-link">
  常用字符串匹配-介绍
</a></li><li class="dropdown-subitem"><a href="/algorithm/encryption/01-intro.html" class="nav-link">
  常用加密解密算法-介绍
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">大数据</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          基础知识总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/bigdata/intro/01-intro.html" class="nav-link">
  入门知识介绍
</a></li><li class="dropdown-subitem"><a href="/bigdata/techintro/01-intro.html" class="nav-link">
  技术体系介绍
</a></li></ul></li><li class="dropdown-item"><h4>
          数据采集总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dc/intro/01-intro.html" class="nav-link">
  入门知识介绍
</a></li><li class="dropdown-subitem"><a href="/dc/intro/02-diff.html" class="nav-link">
  常用工具比较
</a></li></ul></li><li class="dropdown-item"><h4>
          数据存储总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ds/intro/01-basicintro.html" class="nav-link">
  Hadoop入门介绍
</a></li><li class="dropdown-subitem"><a href="/ds/intro/02-detailintro.html" class="nav-link">
  Hadoop生态介绍
</a></li></ul></li><li class="dropdown-item"><h4>
          数据仓库总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dw/intro/01-intro.html" class="nav-link">
  数据仓库入门介绍
</a></li><li class="dropdown-subitem"><a href="/dw/intro/03-summary.html" class="nav-link">
  数据仓库精华总结
</a></li></ul></li><li class="dropdown-item"><h4>
          数据处理总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dp/mr/01-intro.html" class="nav-link">
  MapReduce-入门介绍
</a></li><li class="dropdown-subitem"><a href="/dp/mr/02-basicprin.html" class="nav-link">
  MapReduce-工作原理
</a></li></ul></li><li class="dropdown-item"><h4>
          数据应用总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/da/intro/01-intro.html" class="nav-link">
  大数据应用场景基础介绍
</a></li><li class="dropdown-subitem"><a href="/dm/intro/01-intro.html" class="nav-link">
  大数据数据挖掘基础介绍
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">人工智能</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">人工智能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          基础知识总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ai/intro/01-intro.html" class="nav-link">
  人工智能基础介绍
</a></li><li class="dropdown-subitem"><a href="/ai/mlintro/01-intro.html" class="nav-link">
  机器学习基础介绍
</a></li><li class="dropdown-subitem"><a href="/ai/dlintro/01-intro.html" class="nav-link">
  深度学习基础介绍
</a></li><li class="dropdown-subitem"><a href="/ai/nnprin/01-intro.html" class="nav-link">
  神经网络原理介绍
</a></li><li class="dropdown-subitem"><a href="/ai/mlalgorithm/01-intro.html" class="nav-link">
  机器学习算法介绍
</a></li><li class="dropdown-subitem"><a href="/ai/mlmath/01-intro.html" class="nav-link">
  机器学习数学介绍
</a></li></ul></li><li class="dropdown-item"><h4>
          开发框架总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ad/intro/01-intro.html" class="nav-link">
  主流-AI开源开发框架介绍
</a></li><li class="dropdown-subitem"><a href="/ad/dl4jintro/01-intro.html" class="nav-link">
  JAVA-AI开发框架Dl4j介绍
</a></li><li class="dropdown-subitem"><a href="/ad/pytorch/01-intro.html" class="nav-link">
  AI开发框架-Pytorch介绍
</a></li><li class="dropdown-subitem"><a href="/ad/tensorflow/01-intro.html" class="nav-link">
  AI开发框架-TensorFlow介绍
</a></li></ul></li><li class="dropdown-item"><h4>
          开发应用案例
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ac/intro/01-intro.html" class="nav-link">
  AI常见案例和趋势介绍
</a></li><li class="dropdown-subitem"><a href="/ac/rsintro/01-intro.html" class="nav-link">
  AI应用案例-推荐系统介绍
</a></li><li class="dropdown-subitem"><a href="/ac/aicity/01-intro.html" class="nav-link">
  AI应用案例-智慧城市介绍
</a></li><li class="dropdown-subitem"><a href="/ac/aibigscreen/01-intro.html" class="nav-link">
  AI应用案例-智慧大屏介绍
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">Spring</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">Spring</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Spring基础知识
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/spring/basic/01-intro.html" class="nav-link">
  Spring-入门介绍
</a></li><li class="dropdown-subitem"><a href="/spring/basic/02-iocaopintro.html" class="nav-link">
  IOC和AOP-原理介绍
</a></li></ul></li><li class="dropdown-item"><h4>
          SpringMVC总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/spring/springmvc/01-intro.html" class="nav-link">
  SpringMVC-入门介绍
</a></li><li class="dropdown-subitem"><a href="/spring/springmvc/02-prinintro.html" class="nav-link">
  SpringMVC-工作原理介绍
</a></li></ul></li><li class="dropdown-item"><h4>
          SpringBoot总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/spring/springboot/03-workprin.html" class="nav-link">
  SpringBoot-工作原理
</a></li><li class="dropdown-subitem"><a href="/spring/springboot/06-startprincodeanalysis.html" class="nav-link">
  启动原理分析和源码解读
</a></li></ul></li><li class="dropdown-item"><h4>
          Spring注解总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/spring/annotation/03-springannprin.html" class="nav-link">
  Spring注解实现原理
</a></li><li class="dropdown-subitem"><a href="/spring/annotation/04-anntotal1.html" class="nav-link">
  Spring注解大全(一)
</a></li></ul></li><li class="dropdown-item"><h4>
          SpringCloud知识介绍
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/spring/springcloud/01-intro.html" class="nav-link">
  SpringCloud-基础介绍
</a></li><li class="dropdown-subitem"><a href="/spring/springcloud/03-prindetail.html" class="nav-link">
  SpringCloud-原理详解
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          框架基础总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/framework/basic/01-intro.html" class="nav-link">
  框架基础知识介绍
</a></li><li class="dropdown-subitem"><a href="/framework/basic/02-commconceptdiff.html" class="nav-link">
  框架架构组件区别
</a></li><li class="dropdown-subitem"><a href="/framework/basic/03-commconceptrela.html" class="nav-link">
  框架架构组件关系
</a></li><li class="dropdown-subitem"><a href="/framework/basic/06-microserv15.html" class="nav-link">
  常见15种微服务框架
</a></li><li class="dropdown-subitem"><a href="/framework/basic/07-springframethink.html" class="nav-link">
  Spring框架思想总结
</a></li></ul></li><li class="dropdown-item"><h4>
          常用框架总结
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/framework/log/01-intro.html" class="nav-link">
  日志框架-介绍和总结
</a></li><li class="dropdown-subitem"><a href="/framework/orm/01-intro.html" class="nav-link">
  ORM框架-介绍和总结
</a></li><li class="dropdown-subitem"><a href="/framework/nio/01-intro.html" class="nav-link">
  NIO框架-介绍和总结
</a></li><li class="dropdown-subitem"><a href="/framework/netty/01-intro.html" class="nav-link">
  Netty框架-介绍和总结
</a></li><li class="dropdown-subitem"><a href="/framework/nettycase/01-intro.html" class="nav-link">
  Netty案例-介绍和总结
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">架构</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">架构</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          架构基础知识
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/architecture/basic/01-intro.html" class="nav-link">
  架构基础知识介绍
</a></li><li class="dropdown-subitem"><a href="/architecture/basic/02-essence.html" class="nav-link">
  架构基本概念和本质
</a></li><li class="dropdown-subitem"><a href="/architecture/microservanddistribute/01-intro.html" class="nav-link">
  微服务架构知识介绍
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">开发</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          开发工具
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dev/tool/01-intro.html" class="nav-link">
  Java开发工具介绍
</a></li><li class="dropdown-subitem"><a href="/dev/tool/05-idea20recommendedplug.html" class="nav-link">
  Idea开发插件推荐
</a></li></ul></li><li class="dropdown-item"><h4>
          开发规范
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dev/standard/01-intro.html" class="nav-link">
  Java开发规范
</a></li><li class="dropdown-subitem"><a href="/dev/designpattern/01-intro.html" class="nav-link">
  Java设计模式
</a></li></ul></li><li class="dropdown-item"><h4>
          开发效率
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dev/deveffciency/02-commpromethods.html" class="nav-link">
  效率提升常用方法
</a></li><li class="dropdown-subitem"><a href="/dev/deveffciency/09-summary.html" class="nav-link">
  效率提升精华总结
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">综合</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">综合</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          中间件
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/middleware/mq/01-intro.html" class="nav-link">
  MQ消息队列介绍
</a></li><li class="dropdown-subitem"><a href="/es/basic/01-intro.html" class="nav-link">
  ES搜索服务器介绍
</a></li><li class="dropdown-subitem"><a href="/middleware/zookeeper/01-intro.html" class="nav-link">
  Zookeeper介绍
</a></li></ul></li><li class="dropdown-item"><h4>
          综合技能
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/mysqlop/basic/01-intro.html" class="nav-link">
  MySQL运维总结
</a></li><li class="dropdown-subitem"><a href="/operation/linux/01-intro.html" class="nav-link">
  Linux常用命令
</a></li><li class="dropdown-subitem"><a href="/operation/ng/05-ngsum.html" class="nav-link">
  Nginx使用总结
</a></li><li class="dropdown-subitem"><a href="/post/javabasic/01-javabasic.html" class="nav-link">
  求职面试整理
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">项目|产品</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">项目|产品</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          研发效能介绍
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/projprod/rdefficiencyintro/01-intro.html" class="nav-link">
  研发效能入门介绍
</a></li><li class="dropdown-subitem"><a href="/projprod/rdefficiencyintro/06-efficiencysystem.html" class="nav-link">
  研发效能体系构建
</a></li></ul></li><li class="dropdown-item"><h4>
          研发效能提升
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/projprod/rdeffciencypromote/09-summary.html" class="nav-link">
  研发效能提升精华总结
</a></li><li class="dropdown-subitem"><a href="/projprod/rdeffciencytool/01-intro.html" class="nav-link">
  研发效能系统管理工具
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/about/aboutme.html" class="nav-link">
  关于
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>大数据处理-MapReduce介绍</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dp/mr/01-intro.html" class="sidebar-link">MapReduce-基础介绍</a></li><li><a href="/dp/mr/02-basicprin.html" class="sidebar-link">MapReduce-基本工作原理</a></li><li><a href="/dp/mr/03-prinandcase.html" class="sidebar-link">MapReduce-基本原理和应用</a></li><li><a href="/dp/mr/04-mreliminatecause.html" class="sidebar-link">MapReduce-为什么被&quot;淘汰&quot;</a></li><li><a href="/dp/mr/05-summary.html" class="sidebar-link">MapReduce-精华知识总结</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>大数据【资源管理】-Yarn介绍</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dp/yarn/01-intro.html" class="sidebar-link">Yarn-基础知识介绍</a></li><li><a href="/dp/yarn/02-archiprin.html" class="sidebar-link">Yarn-架构组件原理</a></li><li><a href="/dp/yarn/03-runprin.html" class="sidebar-link">Yarn-运行机制原理</a></li><li><a href="/dp/yarn/04-clusterbuild.html" class="sidebar-link">Yarn-集群搭建案例</a></li><li><a href="/dp/yarn/05-configintro.html" class="sidebar-link">Yarn-参数配置详解</a></li><li><a href="/dp/yarn/06-summarycase.html" class="sidebar-link">Yarn-精华知识总结</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>大数据【资源管理】-Yarn优化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dp/yarnopt/01-basicparamopt.html" class="sidebar-link">Yarn-基础参数和配置优化</a></li><li><a href="/dp/yarnopt/02-memparamopt.html" class="sidebar-link">Yarn-内存参数和配置优化</a></li><li><a href="/dp/yarnopt/03-summaryopt.html" class="sidebar-link">Yarn-系统参数和综合优化</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>大数据【批处理】-Tez介绍</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dp/tez/01-intro.html" class="sidebar-link">Tez-基础知识介绍</a></li><li><a href="/dp/tez/02-installcase.html" class="sidebar-link">Tez-安装部署案例</a></li><li><a href="/dp/tez/03-summary.html" class="sidebar-link">Tez-精华知识总结</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>大数据【流处理】-Storm介绍</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dp/storm/01-intro.html" class="sidebar-link">Storm-基础知识介绍</a></li><li><a href="/dp/storm/02-artchiandprin.html" class="sidebar-link">Storm-架构运行原理</a></li><li><a href="/dp/storm/03-streamdealframe.html" class="sidebar-link">Storm-流式处理框架</a></li><li><a href="/dp/storm/04-clusterinstallcase.html" class="sidebar-link">Storm-集群安装案例</a></li><li><a href="/dp/storm/05-clusterandwordcase.html" class="sidebar-link">Storm-集群应用案例</a></li><li><a href="/dp/storm/06-summary.html" class="sidebar-link">Storm-综合精华总结</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>大数据【流处理】-Spark介绍</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dp/spark/01-intro.html" class="sidebar-link">Spark-基础知识介绍</a></li><li><a href="/dp/spark/02-caseintro.html" class="sidebar-link">Spark-应用案例介绍</a></li><li><a href="/dp/spark/03-rddintro.html" class="sidebar-link">Spark-RDD模型介绍</a></li><li><a href="/dp/spark/04-basicarchi.html" class="sidebar-link">Spark-基础架构总结</a></li><li><a href="/dp/spark/05-fourfeatures.html" class="sidebar-link">Spark-四大特征分析</a></li><li><a href="/dp/spark/06-clusterinstall.html" class="sidebar-link">Spark-集群安装案例</a></li><li><a href="/dp/spark/07-sparkshellintro.html" class="sidebar-link">Spark-SparkShell介绍</a></li><li><a href="/dp/spark/08-sparksqlsum.html" aria-current="page" class="active sidebar-link">Spark-SparkSQL总结</a></li><li><a href="/dp/spark/09-sparkmllibintro.html" class="sidebar-link">SparkMLLib-基础介绍</a></li><li><a href="/dp/spark/10-summary1.html" class="sidebar-link">Spark-综合精华总结(一)</a></li><li><a href="/dp/spark/11-summary2.html" class="sidebar-link">Spark-综合精华总结(二)</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>大数据【流处理】-Spark优化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dp/sparkopt/01-basicopt.html" class="sidebar-link">Spark-基础参数优化</a></li><li><a href="/dp/sparkopt/02-commonopt.html" class="sidebar-link">Spark-常用调优整理</a></li><li><a href="/dp/sparkopt/03-summaryopt.html" class="sidebar-link">Spark-综合性能优化</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>大数据【流处理】-Flink介绍</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dp/flink/01-intro.html" class="sidebar-link">Flink-基础知识介绍</a></li><li><a href="/dp/flink/02-install.html" class="sidebar-link">Flink-安装部署案例</a></li><li><a href="/dp/flink/03-clusterinstall.html" class="sidebar-link">Flink-集群安装案例</a></li><li><a href="/dp/flink/04-runprin.html" class="sidebar-link">Flink-架构工作原理</a></li><li><a href="/dp/flink/05-checkpoints.html" class="sidebar-link">Flink-checkPoint机制</a></li><li><a href="/dp/flink/06-savepoints.html" class="sidebar-link">Flink-savePoint机制</a></li><li><a href="/dp/flink/07-checkandsavepointdiff.html" class="sidebar-link">CheckPoint和SavePoint区别</a></li><li><a href="/dp/flink/08-caseanalysis.html" class="sidebar-link">Flink-经典案例分析</a></li><li><a href="/dp/flink/09-summary.html" class="sidebar-link">Flink-综合精华汇总</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>大数据【流处理】-Flink优化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dp/flinkopt/01-basicopt.html" class="sidebar-link">Spark-基础参数调优</a></li><li><a href="/dp/flinkopt/02-taskopt.html" class="sidebar-link">Spark-任务性能优化</a></li><li><a href="/dp/flinkopt/03-summaryopt.html" class="sidebar-link">Spark-综合配置优化</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>大数据【流处理框架比较】</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dp/streamdiff/01-stormandflinkdiff.html" class="sidebar-link">Storm与Flink比较和区别</a></li><li><a href="/dp/streamdiff/02-sparkandflinkdiff.html" class="sidebar-link">Spark与Flink比较和区别</a></li><li><a href="/dp/streamdiff/03-stormsaprkflinkbasicdiff.html" class="sidebar-link">Storm、Spark与Flink基础比较</a></li><li><a href="/dp/streamdiff/04-stormsaprkflinkdetaildiff.html" class="sidebar-link">Storm、Spark与Flink详细比较</a></li><li><a href="/dp/streamdiff/05-stormsaprkflinksummarydiff.html" class="sidebar-link">Storm、Spark与Flink核心区别</a></li></ul></section></li></ul> </aside> <main class="page page-content-spec" data-v-17815e06><div class="page_article_title_info" data-v-17815e06><div class="page_content_title" data-v-17815e06>Spark-SparkSQL总结</div> <div class="page_content_visit" data-v-17815e06><span data-v-17815e06>更新时间</span> <span style="display:none;" data-v-17815e06>2021-09-10 19:13:59</span>
            
          <span data-v-17815e06>浏览</span> <span style="display:none;" data-v-17815e06>0</span>
            

        </div></div>  <div class="theme-default-content content__default"><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>本文主要是介绍 Spark-SparkSQL总结 。</p></div> <p></p><div class="table-of-contents"><ul><li><a href="#一-概述">一.概述</a><ul><li><a href="#_1-spark历史">1 spark历史</a></li><li><a href="#_2-spark-sql-概述">2 Spark-SQL 概述</a></li><li><a href="#_3-dataset演进历史">3 Dataset演进历史</a></li><li><a href="#_4-sparksql-api">4 SparkSQL API</a></li><li><a href="#_5-基本操作">5 基本操作</a></li><li><a href="#_6-dataset-dataframe">6 Dataset &amp; DataFrame</a></li><li><a href="#_7-rdd-dataframe-dataset-相互转换">7 RDD &amp; DataFrame &amp; DataSet 相互转换</a></li></ul></li><li><a href="#二-spark-sql-算子">二. spark sql 算子</a></li><li><a href="#三-窗体函数-不断地累计计算">三 窗体函数 （不断地累计计算）</a><ul><li><a href="#_1-语法形式">1. 语法形式</a></li><li><a href="#_2-rows-range">2. rows &amp; range</a></li><li><a href="#_3-partition-by-order-by的组合">3.partition by &amp; order by的组合</a></li><li><a href="#_4-排名函数">4. 排名函数</a></li><li><a href="#_5-行函数-lag、lead">5. 行函数：lag、lead</a></li><li><a href="#_6-first-value、last-value">6. firstvalue、lastvalue</a></li><li><a href="#_7-合并记录-collect-set-concat-ws-collect-list">7.合并记录(collectset,concatws,collect_list)</a></li><li><a href="#_8-展开记录-explode">8.展开记录（explode）</a></li><li><a href="#_9-left-semi-anti-join">9.left semi &amp; anti join</a></li></ul></li><li><a href="#四-udf">四.UDF</a><ul><li><a href="#_1-注册版">1.注册版</a></li><li><a href="#_2-非注册版">2.非注册版</a></li><li><a href="#_3-案例">3. 案例</a></li></ul></li><li><a href="#五-udaf">五. UDAF</a><ul><li><a href="#案例">案例</a></li></ul></li><li><a href="#六-从mysql读取数据">六. 从MySQL读取数据</a></li><li><a href="#参考文章">参考文章</a></li></ul></div><p></p> <h2 id="一-概述"><a href="#一-概述" class="header-anchor">#</a> 一.概述</h2> <h3 id="_1-spark历史"><a href="#_1-spark历史" class="header-anchor">#</a> 1 spark历史</h3> <div class="language- extra-class"><pre class="language-text"><code>前身: shark (即Hive on Spark)
        hive 进程维护 , shark 线程维护
新入口:SparkSession
RDD-----&gt;DataFrame-------&gt;Dataset
基本数据类型:Row,schema,StructType,StructField
支持: scala,Java python,R
shark:
	执行计划优化完全依赖于Hive，不方便添加新的优化策略；
	Spark是线程级并行，而MapReduce是进程级并行。
	Spark在兼容Hive的实现上存在线程安全问题，导致Shark
		不得不使用另外一套独立维护的打了补丁的Hive源码分支；
Spark SQL:
	作为Spark生态的一员继续发展，而不再受限于Hive，
	只是兼容Hive；Hive on Spark作为Hive的底层引擎之一
	Hive可以采用Map-Reduce、Tez、Spark等引擎

</code></pre></div><h3 id="_2-spark-sql-概述"><a href="#_2-spark-sql-概述" class="header-anchor">#</a> 2 Spark-SQL 概述</h3> <h4 id="_2-1-特点"><a href="#_2-1-特点" class="header-anchor">#</a> 2.1 特点</h4> <ul><li><ol><li>数据兼容：不仅兼容Hive，还可以从RDD、parquet文件、Json文件获取数据、支持从RDBMS获取数据</li></ol></li> <li><ol start="2"><li>性能优化：采用内存列式存储、自定义序列化器等方式提升性能；</li></ol></li> <li><ol start="3"><li>组件扩展：SQL的语法解析器、分析器、优化器都可以重新定义和扩展</li></ol></li> <li><ol start="4"><li>兼容: Hive兼容层面仅依赖HiveQL解析、Hive元数据。
从HQL被解析成抽象语法树（AST）起，就全部由Spark SQL接管了，Spark SQL执行计划生成和优化都由Catalyst（函数式关系查询优化框架）负责</li></ol></li> <li><ol start="5"><li>支持: 数据既可以来自RDD，也可以是Hive、HDFS、Cassandra等外部数据源，还可以是JSON格式的数据；
Spark SQL目前支持Scala、Java、Python三种语言，支持SQL-92规范；</li></ol></li></ul> <h4 id="_2-2-作用"><a href="#_2-2-作用" class="header-anchor">#</a> 2.2 作用</h4> <ul><li><ol><li>Spark 中用于处理结构化数据的模块；</li></ol></li> <li><ol start="2"><li>相对于RDD的API来说，提供更多结构化数据信息和计算方法</li></ol></li> <li><ol start="3"><li>可以通过SQL或DataSet API方式同Spark SQL进行交互,</li></ol></li></ul> <h4 id="_2-3-spark-sql架构图"><a href="#_2-3-spark-sql架构图" class="header-anchor">#</a> 2.3 Spark SQL架构图</h4> <img src="/assets/img/dp/spark/sparksql/20191015082539972.png" alt="wxmp" class="zoom-custom-imgs"> <h3 id="_3-dataset演进历史"><a href="#_3-dataset演进历史" class="header-anchor">#</a> 3 Dataset演进历史</h3> <div class="language- extra-class"><pre class="language-text"><code>RDD-------------------&gt;DataFrame--------------------&gt;Dataset
0.0            		     1.3        			       1.6
12
</code></pre></div><img src="/assets/img/dp/spark/sparksql/20191015082646414.png" alt="wxmp" class="zoom-custom-imgs"> <h4 id="_3-1-rdd"><a href="#_3-1-rdd" class="header-anchor">#</a> 3.1 RDD</h4> <h5 id="_3-1-1-优点"><a href="#_3-1-1-优点" class="header-anchor">#</a> 3.1.1 优点</h5> <ul><li><ol><li>编译时类型安全，编译时就能检查出类型错误；</li></ol></li> <li><ol start="2"><li>面向对象的编程风格，直接通过class.name的方式来操作数据；</li></ol></li></ul> <div class="language-java extra-class"><pre class="language-java"><code>   idAge<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">.</span>age <span class="token operator">&gt;</span> “”<span class="token punctuation">)</span> <span class="token comment">// 编译时报错, int不能跟与String比较</span>
   idAgeRDDPerson<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">.</span>age <span class="token operator">&gt;</span> <span class="token number">25</span><span class="token punctuation">)</span> <span class="token comment">// 直接操作一个个的person对象</span>
</code></pre></div><h5 id="_3-1-2-缺点"><a href="#_3-1-2-缺点" class="header-anchor">#</a> 3.1.2 缺点</h5> <ul><li><ol><li>序列化和反序列化的性能开销，无论是集群间的通信, 还是IO操作都需要对对象的结构和数据进行序列化反序列化；</li></ol></li> <li><ol start="2"><li>GC的性能开销，频繁的创建和销毁对象, 势必会增加GC</li></ol></li></ul> <h4 id="_3-2-dataframe"><a href="#_3-2-dataframe" class="header-anchor">#</a> 3.2 DataFrame</h4> <h5 id="_3-2-1-优点"><a href="#_3-2-1-优点" class="header-anchor">#</a> 3.2.1 优点</h5> <ul><li><ol><li>off-heap类似于地盘, schema类似于地图, 有自己地盘了, 不再受JVM的限制, 也就不再受GC的困扰了</li></ol></li> <li><ol start="2"><li>通过schema和off-heap, DataFrame克服了RDD的缺点。对比RDD提升计算效率、减少数据读取、底层计算优化；</li></ol></li></ul> <h5 id="_3-2-2-缺点"><a href="#_3-2-2-缺点" class="header-anchor">#</a> 3.2.2 缺点</h5> <ul><li><ol><li>DataFrame克服了RDD的缺点,但是却丢了RDD的优点。</li></ol></li> <li><ol start="2"><li>DataFrame不是类型安全的,API也不是面向对象风格的。</li></ol></li></ul> <div class="language-java extra-class"><pre class="language-java"><code>   <span class="token comment">// API不是面向对象的</span>
   idAgeDF<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>idAgeDF<span class="token punctuation">.</span><span class="token function">col</span><span class="token punctuation">(</span>“age”<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">25</span><span class="token punctuation">)</span>
   <span class="token comment">// 不会报错, DataFrame不是编译时类型安全的</span>
   idAgeDF<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>idAgeDF<span class="token punctuation">.</span><span class="token function">col</span><span class="token punctuation">(</span>“age”<span class="token punctuation">)</span> <span class="token operator">&gt;</span> “”<span class="token punctuation">)</span>
</code></pre></div><h5 id="_3-2-3-核心特征"><a href="#_3-2-3-核心特征" class="header-anchor">#</a> 3.2.3 核心特征</h5> <ul><li><ol><li>DataFrame的前身是SchemaRDD,不继承RDD，自己实现了RDD的大部分功能,在DataFrame上调用RDD的方法转化成另外一个RDD</li></ol></li> <li><ol start="2"><li>DataFrame可以看做分布式Row对象的集合,DataFrame 不仅有比RDD更多的算子，还可以进行执行计划的优化；</li></ol></li> <li><ol start="3"><li>DataFrame表示为DataSet<code>[Row]</code>，即DataSet的子集</li></ol></li> <li><ol start="4"><li>Row :被 DataFrame 自动实现,一行就是一个Row对象</li></ol></li> <li><ol start="5"><li>Schema :包含了以ROW为单位的每行数据的列的信息； Spark通过Schema就能够读懂数据, 因此在通信和IO时就只需要序列化和反序列化数据, 而结构的部分就可以省略了</li></ol></li> <li><ol start="6"><li>off-heap : Spark能够以二进制的形式序列化数据(不包括结构)到off-heap中, 当要操作数据时, 就直接操作off-heap内存</li></ol></li> <li><ol start="7"><li>Tungsten：新的执行引擎</li></ol></li> <li><ol start="8"><li>Catalyst：新的语法解析框架</li></ol></li></ul> <h4 id="_3-3-dataset"><a href="#_3-3-dataset" class="header-anchor">#</a> 3.3 Dataset</h4> <p>Spark第三代API：Dataset；Dataset的核心：Encoder</p> <h5 id="_3-3-1-区别"><a href="#_3-3-1-区别" class="header-anchor">#</a> 3.3.1 区别</h5> <p>DataSet不同于RDD，没有使用Java序列化器或者Kryo进行序列化，而是使用一个特定的编码器进行序列化，这些序列化器可以自动生成，而且在spark执行很多操作（过滤、排序、hash）的时候不用进行反序列化。</p> <h5 id="_3-3-2-特点"><a href="#_3-3-2-特点" class="header-anchor">#</a> 3.3.2 特点</h5> <ul><li><ol><li>编译时的类型安全检查,性能极大的提升，内存使用极大降低、减少GC、极大的减少网络数据的传输,极大的减少scala和java之间代码的差异性。</li></ol></li> <li><ol start="2"><li>DataFrame每一个行对应了一个Row。而Dataset的定义更加宽松，每一个record对应了一个任意的类型。DataFrame只是Dataset的一种特例。</li></ol></li> <li><ol start="3"><li>不同于Row是一个泛化的无类型JVM object, Dataset是由一系列的强类型JVM object组成的，Scala的case class或者Java class定义。因此Dataset可以在编译时进行类型检查</li></ol></li> <li><ol start="4"><li>Dataset以Catalyst逻辑执行计划表示，并且数据以编码的二进制形式被存储，不需要反序列化就可以执行sorting、shuffle等操作。</li></ol></li> <li><ol start="5"><li>Dataset创立需要一个显式的Encoder，把对象序列化为二进制。</li></ol></li></ul> <h3 id="_4-sparksql-api"><a href="#_4-sparksql-api" class="header-anchor">#</a> 4 SparkSQL API</h3> <img src="/assets/img/dp/spark/sparksql/20191015092243489.png" alt="wxmp" class="zoom-custom-imgs">
SparkSession：Spark的一个全新的切入点，统一Spark入口；
<h4 id="_4-1创建sparksession"><a href="#_4-1创建sparksession" class="header-anchor">#</a> 4.1创建SparkSession</h4> <div class="language-java extra-class"><pre class="language-java"><code>val spark <span class="token operator">=</span> <span class="token class-name">SparkSession</span><span class="token punctuation">.</span>builder
<span class="token punctuation">.</span><span class="token function">appName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">enableHiveSupport</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">getOrCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">master</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
spark<span class="token punctuation">.</span>conf<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>“spark<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>shuffle<span class="token punctuation">.</span>partitions”<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>
spark<span class="token punctuation">.</span>conf<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>“spark<span class="token punctuation">.</span>executor<span class="token punctuation">.</span>memory”<span class="token punctuation">,</span> “<span class="token number">2</span>g”<span class="token punctuation">)</span>
</code></pre></div><h4 id="_4-2-核心api"><a href="#_4-2-核心api" class="header-anchor">#</a> 4.2 核心API</h4> <p>1、sparkSession: spark入口</p> <p>统一封装SparkConf,SparkContext,SQLContext, 配置运行参数,读取文件,创建数据,使用SQL</p> <p>2、Dataset:</p> <p>统一Dataset接口,其中DataFrame==Dataset[Row]</p> <p>基本实现了类似RDD的所有算子</p> <p>column: Dataset的列对象</p> <p>包括对列操作的基本函数</p> <p>3、ROW : DataFrame的行对象</p> <p>包括对行操作的基本函数</p> <p>4、Encoder : 序列化</p> <p>支持常用的数据类型,可以直接序列化,也支持case class自定义数据对象进行序列化</p> <p>5、functions: Dataset的内置函数</p> <p>支持丰富的操作函数(聚合,collection… …)</p> <p>6、SQlImplict: 隐式转换</p> <p>其中scala对象RDD转换成DF/DS ,DF/DS使用Map/FlatMap方法等;</p> <p>要采用的隐式转换格式的</p> <p>val spark= SparkSession.()</p> <p>import spark.implicts._</p> <p>注意 : Dataset是一个类（RDD是一个抽象类，而Dataset不是抽象类），其中有三个参数：</p> <p>SparkSession（包含环境信息）</p> <p>QueryExecution（包含数据和执行逻辑）</p> <p>Encoder<code>[T]</code>：数据结构编码信息（包含序列化、schema、数据类型）</p> <h3 id="_5-基本操作"><a href="#_5-基本操作" class="header-anchor">#</a> 5 基本操作</h3> <h4 id="_5-1-row"><a href="#_5-1-row" class="header-anchor">#</a> 5.1 Row</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Row</span>
<span class="token comment">//创建行对象</span>
val row1<span class="token operator">=</span><span class="token class-name">Row</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>”ss”<span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">2.2</span><span class="token punctuation">)</span>
<span class="token comment">//访问</span>
<span class="token function">row1</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
row1<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">//要与数据的类型对应</span>
row1<span class="token punctuation">.</span>getAs<span class="token punctuation">[</span><span class="token class-name">Int</span><span class="token punctuation">]</span><span class="token punctuation">(</span>https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>blog<span class="token punctuation">.</span>csdn<span class="token punctuation">.</span>net<span class="token operator">/</span>qq_45710900<span class="token operator">/</span>article<span class="token operator">/</span>details<span class="token operator">/</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_5-2-schema"><a href="#_5-2-schema" class="header-anchor">#</a> 5.2 Schema</h4> <p>DataFrame（即带有Schema信息的RDD）Spark通过Schema就能够读懂数据
DataFrame中提供了详细的数据结构信息，从而使得SparkSQL可以清楚地知道该数据集中包含哪些列，每列的名称和类型各是什么，DataFrame中的数据结构信息，即为schema。</p> <h4 id="_5-3-schema-structtype-structfield"><a href="#_5-3-schema-structtype-structfield" class="header-anchor">#</a> 5.3 Schema &amp; StructType &amp; StructField</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>types<span class="token punctuation">.</span></span>_

<span class="token number">1.</span> val s<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StructType</span><span class="token punctuation">)</span>
   <span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>“列名”<span class="token punctuation">,</span>”类型”<span class="token punctuation">,</span>可是否为空<span class="token punctuation">,</span>”备注”<span class="token punctuation">)</span>
   <span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>“列名”<span class="token punctuation">,</span>”类型”<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token operator">/</span><span class="token boolean">false</span><span class="token punctuation">,</span>”备注”<span class="token punctuation">)</span>
   val s1<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StructType</span><span class="token punctuation">)</span>
   <span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>“列名”<span class="token punctuation">,</span><span class="token class-name">IntType</span><span class="token punctuation">,</span>可是否为空<span class="token punctuation">,</span>”备注”<span class="token punctuation">)</span>
   <span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>“列名”<span class="token punctuation">,</span><span class="token class-name">StringType</span><span class="token punctuation">,</span>可是否为空<span class="token punctuation">,</span>”备注”<span class="token punctuation">)</span>
<span class="token number">2.</span> val s2<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StructType</span><span class="token punctuation">)</span>
   <span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">StructField</span><span class="token punctuation">(</span>“列名”<span class="token punctuation">,</span><span class="token class-name">IntType</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">StructField</span><span class="token punctuation">(</span>“列名”<span class="token punctuation">,</span><span class="token class-name">StringType</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">3.</span> val s3<span class="token operator">=</span><span class="token class-name">StructType</span><span class="token punctuation">(</span><span class="token class-name">StructField</span><span class="token punctuation">(</span>“列名”<span class="token punctuation">,</span><span class="token class-name">StringType</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token operator">::</span>
   <span class="token class-name">StructField</span><span class="token punctuation">(</span>“列名”<span class="token punctuation">,</span><span class="token class-name">IntType</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token operator">::</span><span class="token class-name">Nil</span> <span class="token punctuation">)</span>
   val s4<span class="token operator">=</span><span class="token class-name">StructType</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token class-name">List</span><span class="token operator">/</span><span class="token class-name">Sep</span><span class="token punctuation">)</span>
   <span class="token punctuation">(</span><span class="token class-name">StructField</span><span class="token punctuation">(</span>“列名”<span class="token punctuation">,</span><span class="token class-name">StringType</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token operator">::</span>
   <span class="token class-name">StructField</span><span class="token punctuation">(</span>“列名”<span class="token punctuation">,</span><span class="token class-name">IntType</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token operator">::</span><span class="token class-name">Nil</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_6-dataset-dataframe"><a href="#_6-dataset-dataframe" class="header-anchor">#</a> 6 Dataset &amp; DataFrame</h3> <p>Spark提供了一整套用于操纵数据的DSL
（DSL ：Domain Specified Language，领域专用语言）
DSL在语义上与SQL关系查询非常相近</p> <h4 id="_6-1-dataset-dataframe-的创建"><a href="#_6-1-dataset-dataframe-的创建" class="header-anchor">#</a> 6.1 Dataset&amp; DataFrame 的创建</h4> <p><img src="/assets/img/dp/spark/sparksql/20191015085321810.png" alt="wxmp" class="zoom-custom-imgs"><img src="/assets/img/dp/spark/sparksql/20191015090208114.png" alt="wxmp" class="zoom-custom-imgs"></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token number">1.</span> 由range生成<span class="token class-name">Dataset</span>
   val numDS <span class="token operator">=</span> spark<span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
   <span class="token comment">//降序显示前五个</span>
   numDS<span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token function">desc</span><span class="token punctuation">(</span>“id”<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
   <span class="token comment">//显示总数,平均数,偏差,最大值,最小值</span>
   numDS<span class="token punctuation">.</span><span class="token function">describe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
<span class="token number">2.</span> 多列由集合生成<span class="token class-name">Dataset</span>
   <span class="token operator">*</span><span class="token operator">*</span><span class="token keyword">case</span> <span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">(</span>name<span class="token operator">:</span><span class="token class-name">String</span><span class="token punctuation">,</span> age<span class="token operator">:</span><span class="token class-name">Int</span><span class="token punctuation">,</span> height<span class="token operator">:</span><span class="token class-name">Int</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token operator">*</span>
   val seq1 <span class="token operator">=</span> <span class="token class-name">Seq</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">(</span>“<span class="token class-name">Jack</span>”<span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">184</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Person</span><span class="token punctuation">(</span>“<span class="token class-name">Tom</span>”<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">144</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   val ds1 <span class="token operator">=</span> spark<span class="token punctuation">.</span><span class="token function">createDataset</span><span class="token punctuation">(</span>seq1<span class="token punctuation">)</span>
   ds1<span class="token punctuation">.</span>show
   val seq2 <span class="token operator">=</span> <span class="token class-name">Seq</span><span class="token punctuation">(</span><span class="token punctuation">(</span>“<span class="token class-name">Jack</span>”<span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">184</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>“<span class="token class-name">Tom</span>”<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">144</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   val ds2 <span class="token operator">=</span> spark<span class="token punctuation">.</span><span class="token function">createDataset</span><span class="token punctuation">(</span>seq2<span class="token punctuation">)</span>
   ds2<span class="token punctuation">.</span>show
<span class="token number">3.</span> 集合转成<span class="token class-name">DataFrame</span>，并修改列名必须有类型
   val seq1 <span class="token operator">=</span><span class="token punctuation">[</span><span class="token class-name">Sep</span><span class="token operator">/</span><span class="token class-name">List</span><span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>“<span class="token class-name">Jack</span>”<span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">184</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>“<span class="token class-name">Tom</span>”<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">144</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>“<span class="token class-name">Andy</span>”<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">165</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   val df1 <span class="token operator">=</span> spark<span class="token punctuation">.</span><span class="token function">createDataFrame</span><span class="token punctuation">(</span>seq1<span class="token punctuation">)</span>
   <span class="token punctuation">.</span><span class="token function">withColumnRenamed</span><span class="token punctuation">(</span><span class="token string">&quot;_1&quot;</span><span class="token punctuation">,</span> “name1”<span class="token punctuation">)</span>
   <span class="token punctuation">.</span><span class="token function">withColumnRenamed</span><span class="token punctuation">(</span><span class="token string">&quot;_2&quot;</span><span class="token punctuation">,</span>“age1”<span class="token punctuation">)</span>
   <span class="token punctuation">.</span><span class="token function">withColumnRenamed</span><span class="token punctuation">(</span><span class="token string">&quot;_3&quot;</span><span class="token punctuation">,</span> “height1”<span class="token punctuation">)</span>
   df1<span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token function">desc</span><span class="token punctuation">(</span>“age1”<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
   val df2 <span class="token operator">=</span> spark<span class="token punctuation">.</span><span class="token function">createDataFrame</span><span class="token punctuation">(</span>seq1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDF</span><span class="token punctuation">(</span>“name”<span class="token punctuation">,</span> “age”<span class="token punctuation">,</span> “height”<span class="token punctuation">)</span><span class="token punctuation">.</span>show
   <span class="token comment">// 简单！2.0.0的新方法</span>
   createDataset 无法运用toDS 修改列名
</code></pre></div><h4 id="_6-1-2-read-的格式"><a href="#_6-1-2-read-的格式" class="header-anchor">#</a> 6.1.2 <strong>read 的格式</strong></h4> <img src="/assets/img/dp/spark/sparksql/20191015093912810.png" alt="wxmp" class="zoom-custom-imgs"> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>types<span class="token punctuation">.</span></span>_
val schema2 <span class="token operator">=</span> <span class="token class-name">StructType</span><span class="token punctuation">(</span> <span class="token class-name">StructField</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token class-name">StringType</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token operator">::</span> 
                          <span class="token class-name">StructField</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span>  <span class="token class-name">IntegerType</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token operator">::</span> 
                          <span class="token class-name">StructField</span><span class="token punctuation">(</span><span class="token string">&quot;height&quot;</span><span class="token punctuation">,</span> <span class="token class-name">IntegerType</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token operator">::</span>  <span class="token class-name">Nil</span><span class="token punctuation">)</span>
<span class="token function">options</span><span class="token punctuation">(</span>    <span class="token class-name">Map</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span>v<span class="token punctuation">)</span>	  <span class="token punctuation">)</span>                
	val df <span class="token operator">=</span> spark<span class="token punctuation">.</span>read<span class="token punctuation">.</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;delimiter&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
					<span class="token punctuation">(</span><span class="token string">&quot;header&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;false&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token punctuation">.</span><span class="token function">schema</span><span class="token punctuation">(</span>schema2<span class="token punctuation">)</span>
					<span class="token punctuation">.</span><span class="token function">csv</span><span class="token punctuation">(</span><span class="token string">&quot;file:///home/spark/t01.csv&quot;</span><span class="token punctuation">)</span>
<span class="token function">option</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token punctuation">)</span>					
	val df1<span class="token operator">=</span>spark<span class="token punctuation">.</span>read<span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token string">&quot;header&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span>
					<span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token string">&quot;inferschema&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span>
					<span class="token punctuation">.</span><span class="token function">csv</span><span class="token punctuation">(</span><span class="token string">&quot;data/emp.dat&quot;</span><span class="token punctuation">)</span> 
	df<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>	

delimiter <span class="token comment">//分隔符</span>
header <span class="token comment">//是否要头部作为列名</span>
schema <span class="token comment">//设置格式列名</span>
inferschema  <span class="token comment">//当不指定schema时自动推测列的格式</span>

</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code>val df <span class="token operator">=</span> spark<span class="token punctuation">.</span>read<span class="token punctuation">.</span><span class="token function">csv</span><span class="token punctuation">(</span>“file<span class="token operator">:</span><span class="token operator">/</span><span class="token comment">//home/spark/data/sparksql/t01.csv”)</span>
</code></pre></div><img src="/assets/img/dp/spark/sparksql/20191015093950795.png" alt="wxmp" class="zoom-custom-imgs"> <div class="language-java extra-class"><pre class="language-java"><code>val df <span class="token operator">=</span> spark<span class="token punctuation">.</span>read<span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span>“inferschema”<span class="token punctuation">,</span>“<span class="token boolean">true</span>”<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">csv</span><span class="token punctuation">(</span>“file<span class="token operator">:</span><span class="token operator">/</span><span class="token comment">//home/spark/data/sparksql/t01.csv”)</span>
</code></pre></div><img src="/assets/img/dp/spark/sparksql/20191015094000734.png" alt="wxmp" class="zoom-custom-imgs"> <div class="language-java extra-class"><pre class="language-java"><code>val df <span class="token operator">=</span> spark<span class="token punctuation">.</span>read<span class="token punctuation">.</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>“delimiter”<span class="token punctuation">,</span> “<span class="token punctuation">,</span>”<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>“header”<span class="token punctuation">,</span> “<span class="token boolean">false</span>”<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token function">schema</span><span class="token punctuation">(</span>schema6<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">csv</span><span class="token punctuation">(</span>“file<span class="token operator">:</span><span class="token operator">/</span><span class="token comment">//home/spark/data/sparksql/t01.csv”)</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code>val df <span class="token operator">=</span> spark<span class="token punctuation">.</span>read<span class="token punctuation">.</span><span class="token function">csv</span><span class="token punctuation">(</span>“file<span class="token operator">:</span><span class="token operator">/</span><span class="token comment">//home/spark/data/sparksql/t01.csv”)</span>
</code></pre></div><img src="/assets/img/dp/spark/sparksql/20191015094007391.png" alt="wxmp" class="zoom-custom-imgs"> <h4 id="_6-1-3-从mysql读取数据"><a href="#_6-1-3-从mysql读取数据" class="header-anchor">#</a> 6.1.3 ** 从MySQL读取数据 **</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 读取数据库中的数据</span>
val jdbcDF <span class="token operator">=</span> spark<span class="token punctuation">.</span>read<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;jdbc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
				<span class="token function">option</span><span class="token punctuation">(</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;jdbc:mysql://localhost:3306/spark&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
				<span class="token function">option</span><span class="token punctuation">(</span><span class="token string">&quot;driver&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;com.mysql.jdbc.Driver&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
				<span class="token function">option</span><span class="token punctuation">(</span><span class="token string">&quot;dbtable&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;student&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
				<span class="token function">option</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hive&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
				<span class="token function">option</span><span class="token punctuation">(</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hive&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
jdbcDF<span class="token punctuation">.</span>show
jdbcDF<span class="token punctuation">.</span>printSchema

</code></pre></div><p>备注：</p> <ul><li>1、将jdbc驱动拷贝到<code>$SPARK_HOME/jars</code>目录下，是最简单的做法；</li> <li>2、明白每一个参数的意思，一个参数不对整个结果出不来；</li> <li>3、从数据库从读大量的数据进行分析，不推荐；读取少量的数据是可以接受的，也是常见的做法。</li></ul> <h3 id="_7-rdd-dataframe-dataset-相互转换"><a href="#_7-rdd-dataframe-dataset-相互转换" class="header-anchor">#</a> 7 RDD &amp; DataFrame &amp; DataSet 相互转换</h3> <img src="/assets/img/dp/spark/sparksql/20191015094947148.png" alt="wxmp" class="zoom-custom-imgs"> <h4 id="_7-1-共性"><a href="#_7-1-共性" class="header-anchor">#</a> 7.1 共性</h4> <p>1、RDD、DataFrame、Dataset都是spark平台下的分布式弹性数据集，为处理超大型数据提供便利；</p> <p>2、三者都有惰性机制。在进行创建、转换时（如map方法），不会立即执行;只有在遇到Action时(如foreach) ，才会开始遍历运算。极端情况下，如果代码里面仅有创建、转换，但后面没有在Action中使用对应的结果，在执行时会被直接跳过；</p> <p>3、三者都有partition的概念，进行缓存(cache)操作、还可以进行检查点（checkpoint）操作；</p> <p>4、三者有许多相似的函数，如map、filter，排序等；</p> <p>5、在对DataFrame和Dataset进行操作时，很多情况下需要 spark.implicits._ 进行支持；</p> <h4 id="_7-2-dataframe"><a href="#_7-2-dataframe" class="header-anchor">#</a> 7.2 DataFrame</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">DataFrame</span><span class="token punctuation">(</span><span class="token class-name">DataFrame</span> 是 <span class="token class-name">Dataset</span><span class="token punctuation">[</span><span class="token class-name">Row</span><span class="token punctuation">]</span>的别名<span class="token punctuation">)</span>：
<span class="token class-name">DataFrame</span> <span class="token operator">=</span> RDD<span class="token punctuation">[</span><span class="token class-name">Row</span><span class="token punctuation">]</span> <span class="token operator">+</span> schema<span class="token operator">*</span><span class="token operator">*</span>
</code></pre></div><p>1、与RDD和Dataset不同，DataFrame每一行的类型固定为Row，只有通过解析才能获取各个字段的值；</p> <p>2、DataFrame与Dataset一般与spark ml同时使用；</p> <p>3、DataFrame与Dataset均支持sparksql的操作，比如select，groupBy之类，还能注册临时视图，进行sql语句操作；</p> <p>4、DataFrame与Dataset支持一些特别方便的保存方式，比如保存成csv，可以带上表头，这样每一列的字段名一目了然；</p> <h4 id="_7-3-dataset"><a href="#_7-3-dataset" class="header-anchor">#</a> 7.3 Dataset</h4> <p>Dataset = RDD<code>[case class]</code>.toDS</p> <p>1、Dataset和DataFrame拥有完全相同的成员函数，区别只是每一行的数据类型不同；</p> <p>2、DataFrame 定义为 Dataset[Row]。每一行的类型是Row，每一行究竟有哪些字段，各个字段又是什么类型都无从得知，只能用前面提到的getAS方法或者模式匹配拿出特定字段；</p> <p>3、Dataset每一行的类型都是一个case class，在自定义了case class之后可以很自由的获得每一行的信息；</p> <h4 id="_7-3-转换"><a href="#_7-3-转换" class="header-anchor">#</a> 7.3 转换</h4> <p>RDD、DataFrame、Dataset三者有许多共性，有各自适用的场景常常需要在三者之间转换</p> <img src="/assets/img/dp/spark/sparksql/20191015094854495.png" alt="wxmp" class="zoom-custom-imgs"> <h5 id="_7-3-1dataframe-dataset-转-rdd"><a href="#_7-3-1dataframe-dataset-转-rdd" class="header-anchor">#</a> 7.3.1<strong>DataFrame/Dataset 转 RDD</strong>：</h5> <div class="language-ini extra-class"><pre class="language-ini"><code>// 这个转换很简单
val rdd1<span class="token attr-value"><span class="token punctuation">=</span>testDF.rdd</span>
val rdd2<span class="token attr-value"><span class="token punctuation">=</span>testDS.rdd</span>

</code></pre></div><h5 id="_7-3-2rdd-转-dataframe"><a href="#_7-3-2rdd-转-dataframe" class="header-anchor">#</a> 7.3.2<strong>RDD 转 DataFrame</strong>：</h5> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 一般用元组把一行的数据写在一起，然后在toDF中指定字段名</span>
<span class="token keyword">import</span> <span class="token namespace">spark<span class="token punctuation">.</span>implicits<span class="token punctuation">.</span></span>_
val testDF <span class="token operator">=</span> rdd<span class="token punctuation">.</span>map <span class="token punctuation">{</span>line<span class="token operator">=</span><span class="token operator">&gt;</span>
      <span class="token punctuation">(</span>line<span class="token punctuation">.</span>_1<span class="token punctuation">,</span>line<span class="token punctuation">.</span>_2<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">toDF</span><span class="token punctuation">(</span><span class="token string">&quot;col1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;col2&quot;</span><span class="token punctuation">)</span>

</code></pre></div><h5 id="_7-3-3rdd-转-dataset"><a href="#_7-3-3rdd-转-dataset" class="header-anchor">#</a> 7.3.3<strong>RDD 转 DataSet</strong>：</h5> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 核心就是要定义case class</span>
<span class="token keyword">import</span> <span class="token namespace">spark<span class="token punctuation">.</span>implicits<span class="token punctuation">.</span></span>_
<span class="token keyword">case</span> <span class="token keyword">class</span> <span class="token class-name">Coltest</span><span class="token punctuation">(</span>col1<span class="token operator">:</span><span class="token class-name">String</span><span class="token punctuation">,</span> col2<span class="token operator">:</span><span class="token class-name">Int</span><span class="token punctuation">)</span>
val testDS <span class="token operator">=</span> rdd<span class="token punctuation">.</span>map<span class="token punctuation">{</span>line<span class="token operator">=</span><span class="token operator">&gt;</span><span class="token class-name">Coltest</span><span class="token punctuation">(</span>line<span class="token punctuation">.</span>_1<span class="token punctuation">,</span>line<span class="token punctuation">.</span>_2<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">.</span>toDS

</code></pre></div><h5 id="_7-3-4dataset-转-dataframe"><a href="#_7-3-4dataset-转-dataframe" class="header-anchor">#</a> 7.3.4<strong>Dataset 转 DataFrame</strong>：</h5> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 这个转换简单，只是把 case class 封装成Row</span>
<span class="token keyword">import</span> <span class="token namespace">spark<span class="token punctuation">.</span>implicits<span class="token punctuation">.</span></span>_
val testDF <span class="token operator">=</span> testDS<span class="token punctuation">.</span>toDF

</code></pre></div><h5 id="_7-3-5dataframe-转-dataset"><a href="#_7-3-5dataframe-转-dataset" class="header-anchor">#</a> 7.3.5<strong>DataFrame 转 Dataset</strong>：</h5> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 每一列的类型后，使用as方法（as方法后面还是跟的case class，这个是核心），转成Dataset。</span>
<span class="token keyword">import</span> <span class="token namespace">spark<span class="token punctuation">.</span>implicits<span class="token punctuation">.</span></span>_
<span class="token keyword">case</span> <span class="token keyword">class</span> <span class="token class-name">Coltest</span> … …
val testDS <span class="token operator">=</span> testDF<span class="token punctuation">.</span>as<span class="token punctuation">[</span><span class="token class-name">Coltest</span><span class="token punctuation">]</span>

</code></pre></div><p>特别注意：</p> <p>在使用一些特殊操作时，一定要加上import spark.implicits._ 不然toDF、toDS无法使用**</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">case</span> <span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">(</span>name<span class="token operator">:</span><span class="token class-name">String</span><span class="token punctuation">,</span> age<span class="token operator">:</span><span class="token class-name">Int</span><span class="token punctuation">,</span> height<span class="token operator">:</span><span class="token class-name">Int</span><span class="token punctuation">)</span>
val arr <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;Jack&quot;</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">184</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&quot;Tom&quot;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">144</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&quot;Andy&quot;</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">165</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
val rdd1 <span class="token operator">=</span> sc<span class="token punctuation">.</span><span class="token function">makeRDD</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
val df <span class="token operator">=</span> rdd1<span class="token punctuation">.</span><span class="token function">toDF</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
val df <span class="token operator">=</span> rdd1<span class="token punctuation">.</span><span class="token function">toDF</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;height&quot;</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>as<span class="token punctuation">[</span><span class="token class-name">Person</span><span class="token punctuation">]</span>
</code></pre></div><h2 id="二-spark-sql-算子"><a href="#二-spark-sql-算子" class="header-anchor">#</a> 二. spark sql 算子</h2> <h4 id="_1-数据类型"><a href="#_1-数据类型" class="header-anchor">#</a> 1.数据类型</h4> <p>import org.apache.spark.sql.types._
<img src="/assets/img/dp/spark/sparksql/20191015095553559.png" alt="wxmp" class="zoom-custom-imgs"></p> <h4 id="_2-actions"><a href="#_2-actions" class="header-anchor">#</a> 2. Actions</h4> <div class="language-java extra-class"><pre class="language-java"><code>df1<span class="token punctuation">.</span>count	

<span class="token comment">// 缺省只会显示20行（show里不写时）</span>
df1<span class="token punctuation">.</span><span class="token function">union</span><span class="token punctuation">(</span>df1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 显示2行</span>
df1<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment">// 不截断字符</span>
df1<span class="token punctuation">.</span>toJSON<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>

<span class="token comment">// 显示10行，不截断字符</span>
df1<span class="token punctuation">.</span>toJSON<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
spark<span class="token punctuation">.</span>catalog<span class="token punctuation">.</span>listFunctions<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>

<span class="token comment">// collect返回的是数组, Array[org.apache.spark.sql.Row]</span>
val c1 <span class="token operator">=</span> df1<span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// collectAsList返回的是List, List[org.apache.spark.sql.Row]</span>
val c2 <span class="token operator">=</span> df1<span class="token punctuation">.</span><span class="token function">collectAsList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 

<span class="token comment">// 返回 org.apache.spark.sql.Row</span>
val h1 <span class="token operator">=</span> df1<span class="token punctuation">.</span><span class="token function">head</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
val f1 <span class="token operator">=</span> df1<span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 返回 Array[org.apache.spark.sql.Row]，长度为3</span>
val h2 <span class="token operator">=</span> df1<span class="token punctuation">.</span><span class="token function">head</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
val f2 <span class="token operator">=</span> df1<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>

<span class="token comment">// 返回 List[org.apache.spark.sql.Row]，长度为2</span>
val t2 <span class="token operator">=</span> df1<span class="token punctuation">.</span><span class="token function">takeAsList</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token keyword">case</span> <span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">(</span>name<span class="token operator">:</span><span class="token class-name">String</span><span class="token punctuation">,</span> age<span class="token operator">:</span><span class="token class-name">Int</span><span class="token punctuation">,</span> height<span class="token operator">:</span><span class="token class-name">Int</span><span class="token punctuation">)</span>
val seq1 <span class="token operator">=</span> <span class="token class-name">Seq</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Jack&quot;</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">184</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
<span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Tom&quot;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">144</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Andy&quot;</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">165</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
val ds1 <span class="token operator">=</span> spark<span class="token punctuation">.</span><span class="token function">createDataset</span><span class="token punctuation">(</span>seq1<span class="token punctuation">)</span>
ds1<span class="token punctuation">.</span>reduce<span class="token punctuation">{</span> <span class="token punctuation">(</span>f1<span class="token punctuation">,</span> f2<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;sum&quot;</span><span class="token punctuation">,</span> f1<span class="token punctuation">.</span>age<span class="token operator">+</span>f2<span class="token punctuation">.</span>age<span class="token punctuation">,</span> f1<span class="token punctuation">.</span>height<span class="token operator">+</span>f2<span class="token punctuation">.</span>height<span class="token punctuation">)</span> <span class="token punctuation">}</span>

<span class="token comment">// 结构属性</span>
df1<span class="token punctuation">.</span>columns			<span class="token comment">// 查看列名</span>
df1<span class="token punctuation">.</span>dtypes			<span class="token comment">// 查看列名和类型</span>
df1<span class="token punctuation">.</span><span class="token function">explain</span><span class="token punctuation">(</span><span class="token punctuation">)</span>		<span class="token comment">// 参看执行计划</span>
df1<span class="token punctuation">.</span><span class="token function">col</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span>		<span class="token comment">// 获取某个列</span>
df1<span class="token punctuation">.</span>printSchema		<span class="token comment">// 常用</span>

</code></pre></div><h4 id="_3-transformations"><a href="#_3-transformations" class="header-anchor">#</a> 3. Transformations</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// map、flatMap操作（与RDD基本类似）</span>
df1<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token operator">&gt;</span>row<span class="token punctuation">.</span>getAs<span class="token punctuation">[</span><span class="token class-name">Int</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

<span class="token keyword">case</span> <span class="token keyword">class</span> <span class="token class-name">Peoples</span><span class="token punctuation">(</span>age<span class="token operator">:</span><span class="token class-name">Int</span><span class="token punctuation">,</span> names<span class="token operator">:</span><span class="token class-name">String</span><span class="token punctuation">)</span>

val seq1 <span class="token operator">=</span> <span class="token class-name">Seq</span><span class="token punctuation">(</span><span class="token class-name">Peoples</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">&quot;Tom, Andy, Jack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Peoples</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">&quot;Pand, Gate, Sundy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
val ds1 <span class="token operator">=</span> spark<span class="token punctuation">.</span><span class="token function">createDataset</span><span class="token punctuation">(</span>seq1<span class="token punctuation">)</span>
val ds2 <span class="token operator">=</span> ds1<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>x <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span>age<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> x<span class="token punctuation">.</span>names<span class="token punctuation">)</span><span class="token punctuation">)</span>
ds2<span class="token punctuation">.</span>show

val ds3 <span class="token operator">=</span> ds1<span class="token punctuation">.</span>flatMap<span class="token punctuation">{</span> x <span class="token operator">=</span><span class="token operator">&gt;</span>
  val a <span class="token operator">=</span> x<span class="token punctuation">.</span>age
  val s <span class="token operator">=</span> x<span class="token punctuation">.</span>names<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>name <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> name<span class="token punctuation">.</span>trim<span class="token punctuation">)</span><span class="token punctuation">)</span>
  s
<span class="token punctuation">}</span>
ds3<span class="token punctuation">.</span>show

<span class="token comment">// filter</span>
df1<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token string">&quot;sal&gt;3000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
	
<span class="token comment">// randomSplit(与RDD类似，将DF、DS按给定参数分成多份)</span>
val df2  <span class="token operator">=</span> df1<span class="token punctuation">.</span><span class="token function">randomSplit</span><span class="token punctuation">(</span><span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">df2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count
<span class="token function">df2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count
<span class="token function">df2</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count

<span class="token comment">// 取10行数据生成新的DataSet</span>
val df2 <span class="token operator">=</span> df1<span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>

<span class="token comment">// distinct，去重</span>
val df2 <span class="token operator">=</span> df1<span class="token punctuation">.</span><span class="token function">union</span><span class="token punctuation">(</span>df1<span class="token punctuation">)</span>
df2<span class="token punctuation">.</span>distinct<span class="token punctuation">.</span>count

<span class="token comment">// dropDuplicates，按列值去重</span>
df2<span class="token punctuation">.</span>dropDuplicates<span class="token punctuation">.</span>show
df2<span class="token punctuation">.</span><span class="token function">dropDuplicates</span><span class="token punctuation">(</span><span class="token string">&quot;mgr&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;deptno&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df2<span class="token punctuation">.</span><span class="token function">dropDuplicates</span><span class="token punctuation">(</span><span class="token string">&quot;mgr&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df2<span class="token punctuation">.</span><span class="token function">dropDuplicates</span><span class="token punctuation">(</span><span class="token string">&quot;deptno&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

<span class="token comment">// 返回全部列的统计（count、mean、stddev、min、max）</span>
ds1<span class="token punctuation">.</span><span class="token function">describe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

<span class="token comment">// 返回指定列的统计</span>
ds1<span class="token punctuation">.</span><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
ds1<span class="token punctuation">.</span><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;comm&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

<span class="token comment">// 存储相关的方法，与RDD的方法一致</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>storage<span class="token punctuation">.</span></span><span class="token class-name">StorageLevel</span>
spark<span class="token punctuation">.</span>sparkContext<span class="token punctuation">.</span><span class="token function">setCheckpointDir</span><span class="token punctuation">(</span><span class="token string">&quot;hdfs://node1:8020/checkpoint&quot;</span><span class="token punctuation">)</span>

df1<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
df1<span class="token punctuation">.</span><span class="token function">checkpoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
df1<span class="token punctuation">.</span><span class="token function">cache</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
df1<span class="token punctuation">.</span><span class="token function">persist</span><span class="token punctuation">(</span><span class="token class-name">StorageLevel</span><span class="token punctuation">.</span>MEMORY_ONLY<span class="token punctuation">)</span>
df1<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
df1<span class="token punctuation">.</span><span class="token function">unpersist</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

</code></pre></div><h4 id="_4-select相关"><a href="#_4-select相关" class="header-anchor">#</a> 4. select相关</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 列的多种表示方法（5种）。使用&quot;&quot;、$&quot;&quot;、'、col()、ds(&quot;&quot;)</span>
<span class="token comment">// 注意:不要混用;必要时使用spark.implicitis._;并非每个表示在所有的地方都有效</span>
df1<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>$<span class="token string">&quot;ename&quot;</span><span class="token punctuation">,</span> $<span class="token string">&quot;hiredate&quot;</span><span class="token punctuation">,</span> $<span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;ename&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hiredate&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'ename, '</span>hiredate<span class="token punctuation">,</span> 'sal<span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token function">col</span><span class="token punctuation">(</span><span class="token string">&quot;ename&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">col</span><span class="token punctuation">(</span><span class="token string">&quot;hiredate&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">col</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token function">df1</span><span class="token punctuation">(</span><span class="token string">&quot;ename&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">df1</span><span class="token punctuation">(</span><span class="token string">&quot;hiredate&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">df1</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

<span class="token comment">// 下面的写法无效，其他列的表示法有效</span>
df1<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;ename&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hiredate&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sal&quot;</span><span class="token operator">+</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;ename&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hiredate&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sal+100&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

<span class="token comment">// 可使用expr表达式(expr里面只能使用引号)</span>
df1<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token function">expr</span><span class="token punctuation">(</span><span class="token string">&quot;comm+100&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">expr</span><span class="token punctuation">(</span><span class="token string">&quot;sal+100&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">expr</span><span class="token punctuation">(</span><span class="token string">&quot;ename&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">selectExpr</span><span class="token punctuation">(</span><span class="token string">&quot;ename as name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">selectExpr</span><span class="token punctuation">(</span><span class="token string">&quot;power(sal, 2)&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
<span class="token comment">//四舍五入，负数取小数点以前的位置，正数取小数点后的位数</span>
df1<span class="token punctuation">.</span><span class="token function">selectExpr</span><span class="token punctuation">(</span><span class="token string">&quot;round(sal, -3) as newsal&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sal&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ename&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

</code></pre></div><p><strong>drop、withColumn、 withColumnRenamed、casting</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// drop 删除一个或多个列，得到新的DF</span>
df1<span class="token punctuation">.</span><span class="token function">drop</span><span class="token punctuation">(</span><span class="token string">&quot;mgr&quot;</span><span class="token punctuation">)</span>
df1<span class="token punctuation">.</span><span class="token function">drop</span><span class="token punctuation">(</span><span class="token string">&quot;empno&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;mgr&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// withColumn，修改列值</span>
val df2 <span class="token operator">=</span> df1<span class="token punctuation">.</span><span class="token function">withColumn</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">,</span> $<span class="token string">&quot;sal&quot;</span><span class="token operator">+</span><span class="token number">1000</span><span class="token punctuation">)</span>
df2<span class="token punctuation">.</span>show

<span class="token comment">// withColumnRenamed，更改列名</span>
df1<span class="token punctuation">.</span><span class="token function">withColumnRenamed</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;newsal&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// 备注：drop、withColumn、withColumnRenamed返回的是DF</span>

df1<span class="token punctuation">.</span><span class="token function">selectExpr</span><span class="token punctuation">(</span><span class="token string">&quot;cast(empno as string)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>printSchema

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>types<span class="token punctuation">.</span></span>_
df1<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>'empno<span class="token punctuation">.</span><span class="token function">cast</span><span class="token punctuation">(</span><span class="token class-name">StringType</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>printSchema

</code></pre></div><h4 id="_5-where-相关"><a href="#_5-where-相关" class="header-anchor">#</a> 5.where 相关</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// where操作</span>
df1<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token string">&quot;sal&gt;1000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token string">&quot;sal&gt;1000 and job=='MANAGER'&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

<span class="token comment">// filter操作</span>
df1<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&quot;sal&gt;1000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&quot;sal&gt;1000 and job=='MANAGER'&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
<span class="token number">1234567</span>
</code></pre></div><h4 id="_6-groupby-相关"><a href="#_6-groupby-相关" class="header-anchor">#</a> 6. groupBy 相关</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// groupBy、max、min、mean、sum、count（与df1.count不同）</span>
df1<span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span><span class="token string">&quot;列名&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span><span class="token string">&quot;Job&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span><span class="token string">&quot;Job&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span><span class="token string">&quot;Job&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">avg</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span><span class="token string">&quot;Job&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">.</span>show

<span class="token comment">// agg</span>
df1<span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">agg</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token operator">-&gt;</span><span class="token string">&quot;max&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sal&quot;</span><span class="token operator">-&gt;</span><span class="token string">&quot;min&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sal&quot;</span><span class="token operator">-&gt;</span><span class="token string">&quot;avg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sal&quot;</span><span class="token operator">-&gt;</span><span class="token string">&quot;sum&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sal&quot;</span><span class="token operator">-&gt;</span><span class="token string">&quot;count&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span><span class="token string">&quot;Job&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">agg</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token operator">-&gt;</span><span class="token string">&quot;max&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sal&quot;</span><span class="token operator">-&gt;</span><span class="token string">&quot;min&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sal&quot;</span><span class="token operator">-&gt;</span><span class="token string">&quot;avg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sal&quot;</span><span class="token operator">-&gt;</span><span class="token string">&quot;sum&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sal&quot;</span><span class="token operator">-&gt;</span><span class="token string">&quot;count&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span><span class="token string">&quot;deptno&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">agg</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token operator">-&gt;</span><span class="token string">&quot;max&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sal&quot;</span><span class="token operator">-&gt;</span><span class="token string">&quot;min&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sal&quot;</span><span class="token operator">-&gt;</span><span class="token string">&quot;avg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sal&quot;</span><span class="token operator">-&gt;</span><span class="token string">&quot;sum&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sal&quot;</span><span class="token operator">-&gt;</span><span class="token string">&quot;count&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

<span class="token comment">// 这种方式更好理解</span>
df1<span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span><span class="token string">&quot;Job&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">agg</span><span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
<span class="token comment">// 给列取别名</span>
df1<span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span><span class="token string">&quot;Job&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">agg</span><span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withColumnRenamed</span><span class="token punctuation">(</span><span class="token string">&quot;min(sal)&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;min1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
<span class="token comment">// 给列取别名，最简便</span>
df1<span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span><span class="token string">&quot;Job&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">agg</span><span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">as</span><span class="token punctuation">(</span><span class="token string">&quot;max1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">as</span><span class="token punctuation">(</span><span class="token string">&quot;min2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">as</span><span class="token punctuation">(</span><span class="token string">&quot;avg3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">as</span><span class="token punctuation">(</span><span class="token string">&quot;sum4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">as</span><span class="token punctuation">(</span><span class="token string">&quot;count5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
</code></pre></div><h4 id="_7-orderby、sort-相关"><a href="#_7-orderby、sort-相关" class="header-anchor">#</a> 7. orderBy、sort 相关</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// orderBy</span>

df1<span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span>$<span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span>$<span class="token string">&quot;sal&quot;</span><span class="token punctuation">.</span>asc<span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span>'sal<span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token function">col</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token function">df1</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
<span class="token comment">//降序	</span>
df1<span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span>$<span class="token string">&quot;sal&quot;</span><span class="token punctuation">.</span>desc<span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token operator">-</span>'sal<span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token string">'deptno, -'</span>sal<span class="token punctuation">)</span><span class="token punctuation">.</span>show

<span class="token comment">// sort，以下语句等价</span>

df1<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>$<span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>$<span class="token string">&quot;sal&quot;</span><span class="token punctuation">.</span>asc<span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>'sal<span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token function">col</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token function">df1</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
<span class="token comment">//降序	</span>
df1<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>$<span class="token string">&quot;sal&quot;</span><span class="token punctuation">.</span>desc<span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token operator">-</span>'sal<span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token string">'deptno, -'</span>sal<span class="token punctuation">)</span><span class="token punctuation">.</span>show

</code></pre></div><h4 id="_8-集合相关-交、并、差"><a href="#_8-集合相关-交、并、差" class="header-anchor">#</a> 8. 集合相关(交、并、差)</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// union、unionAll、intersect、except。集合的交、并、差</span>
val ds3 <span class="token operator">=</span> ds1<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;sname&quot;</span><span class="token punctuation">)</span>
val ds4 <span class="token operator">=</span> ds2<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;sname&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// union 求并集，不去重</span>
ds3<span class="token punctuation">.</span><span class="token function">union</span><span class="token punctuation">(</span>ds4<span class="token punctuation">)</span><span class="token punctuation">.</span>show

<span class="token comment">// unionAll、union 等价；unionAll过期方法，不建议使用</span>
ds3<span class="token punctuation">.</span><span class="token function">unionAll</span><span class="token punctuation">(</span>ds4<span class="token punctuation">)</span><span class="token punctuation">.</span>show

<span class="token comment">// intersect 求交</span>
ds3<span class="token punctuation">.</span><span class="token function">intersect</span><span class="token punctuation">(</span>ds4<span class="token punctuation">)</span><span class="token punctuation">.</span>show

<span class="token comment">// except 求差</span>
ds3<span class="token punctuation">.</span><span class="token function">except</span><span class="token punctuation">(</span>ds4<span class="token punctuation">)</span><span class="token punctuation">.</span>show

</code></pre></div><h4 id="_9-join-相关-ds在join操作之后变成了df"><a href="#_9-join-相关-ds在join操作之后变成了df" class="header-anchor">#</a> 9. join 相关(DS在join操作之后变成了DF)</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 10种join的连接方式（下面有9种，还有一种是笛卡尔积）</span>
ds1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>ds2<span class="token punctuation">,</span> <span class="token string">&quot;sname&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
ds1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>ds2<span class="token punctuation">,</span> <span class="token class-name">Seq</span><span class="token punctuation">(</span><span class="token string">&quot;sname&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;inner&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

ds1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>ds2<span class="token punctuation">,</span> <span class="token class-name">Seq</span><span class="token punctuation">(</span><span class="token string">&quot;sname&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;left&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
ds1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>ds2<span class="token punctuation">,</span> <span class="token class-name">Seq</span><span class="token punctuation">(</span><span class="token string">&quot;sname&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;left_outer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

ds1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>ds2<span class="token punctuation">,</span> <span class="token class-name">Seq</span><span class="token punctuation">(</span><span class="token string">&quot;sname&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;right&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
ds1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>ds2<span class="token punctuation">,</span> <span class="token class-name">Seq</span><span class="token punctuation">(</span><span class="token string">&quot;sname&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;right_outer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

ds1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>ds2<span class="token punctuation">,</span> <span class="token class-name">Seq</span><span class="token punctuation">(</span><span class="token string">&quot;sname&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;outer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
ds1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>ds2<span class="token punctuation">,</span> <span class="token class-name">Seq</span><span class="token punctuation">(</span><span class="token string">&quot;sname&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;full&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
ds1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>ds2<span class="token punctuation">,</span> <span class="token class-name">Seq</span><span class="token punctuation">(</span><span class="token string">&quot;sname&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;full_outer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

ds1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>ds2<span class="token punctuation">,</span> <span class="token class-name">Seq</span><span class="token punctuation">(</span><span class="token string">&quot;sname&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;left_semi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
ds1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>ds2<span class="token punctuation">,</span> <span class="token class-name">Seq</span><span class="token punctuation">(</span><span class="token string">&quot;sname&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;left_anti&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

备注：DS在join操作之后变成了DF
val ds1 <span class="token operator">=</span> spark<span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
val ds2 <span class="token operator">=</span> spark<span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span>
<span class="token comment">// 类似于集合求交</span>
ds1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>ds2<span class="token punctuation">,</span> <span class="token class-name">Seq</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;left_semi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
<span class="token comment">// 类似于集合求差</span>
ds1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>ds2<span class="token punctuation">,</span> <span class="token class-name">Seq</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;left_anti&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

</code></pre></div><h4 id="_10-空值处理"><a href="#_10-空值处理" class="header-anchor">#</a> 10.空值处理</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// NaN 非法值</span>
math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isNaN</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

df1<span class="token punctuation">.</span>show
<span class="token comment">// 删除所有列的空值和NaN</span>
df1<span class="token punctuation">.</span>na<span class="token punctuation">.</span>drop<span class="token punctuation">.</span>show

<span class="token comment">// 删除某列的空值和NaN</span>
df1<span class="token punctuation">.</span>na<span class="token punctuation">.</span><span class="token function">drop</span><span class="token punctuation">(</span><span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token string">&quot;mgr&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

<span class="token comment">// 对全部列填充；对指定单列填充；对指定多列填充</span>
df1<span class="token punctuation">.</span>na<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span>na<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token string">&quot;comm&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span>na<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token string">&quot;mgr&quot;</span><span class="token operator">-&gt;</span><span class="token number">2000</span><span class="token punctuation">,</span> <span class="token string">&quot;comm&quot;</span><span class="token operator">-&gt;</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

<span class="token comment">// 对指定的值进行替换</span>
df1<span class="token punctuation">.</span>na<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;comm&quot;</span> <span class="token operator">::</span> <span class="token string">&quot;deptno&quot;</span> <span class="token operator">::</span> <span class="token class-name">Nil</span><span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">-&gt;</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">10</span> <span class="token operator">-&gt;</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

<span class="token comment">// 查询空值列或非空值列。isNull、isNotNull为内置函数</span>
df1<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token string">&quot;comm is null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>$<span class="token string">&quot;comm&quot;</span><span class="token punctuation">.</span>isNull<span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token function">col</span><span class="token punctuation">(</span><span class="token string">&quot;comm&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isNull<span class="token punctuation">)</span><span class="token punctuation">.</span>show

df1<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token string">&quot;comm is not null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token function">col</span><span class="token punctuation">(</span><span class="token string">&quot;comm&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isNotNull<span class="token punctuation">)</span><span class="token punctuation">.</span>show

</code></pre></div><h4 id="_11-时间日期函数"><a href="#_11-时间日期函数" class="header-anchor">#</a> 11. 时间日期函数</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 各种时间函数</span>
df1<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token function">year</span><span class="token punctuation">(</span>$<span class="token string">&quot;hiredate&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token function">weekofyear</span><span class="token punctuation">(</span>$<span class="token string">&quot;hiredate&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token function">minute</span><span class="token punctuation">(</span>$<span class="token string">&quot;hiredate&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token function">date_add</span><span class="token punctuation">(</span>$<span class="token string">&quot;hiredate&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> $<span class="token string">&quot;hiredate&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>current_date<span class="token punctuation">)</span><span class="token punctuation">.</span>show
df1<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>unix_timestamp<span class="token punctuation">)</span><span class="token punctuation">.</span>show

val df2 <span class="token operator">=</span> df1<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>unix_timestamp as <span class="token string">&quot;unixtime&quot;</span><span class="token punctuation">)</span>
df2<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token function">from_unixtime</span><span class="token punctuation">(</span>$<span class="token string">&quot;unixtime&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

<span class="token comment">// 计算年龄</span>
df1<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token function">months_between</span><span class="token punctuation">(</span>current_date<span class="token punctuation">,</span> $<span class="token string">&quot;hiredate&quot;</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

</code></pre></div><h4 id="_12-json-数据源-建表"><a href="#_12-json-数据源-建表" class="header-anchor">#</a> 12. json 数据源 建表</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 读数据（txt、csv、json、parquet、jdbc）</span>
val df2 <span class="token operator">=</span> spark<span class="token punctuation">.</span>read<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token string">&quot;data/employees.json&quot;</span><span class="token punctuation">)</span>
df2<span class="token punctuation">.</span>show
<span class="token comment">// 备注：SparkSQL中支持的json文件，文件内容必须在一行中</span>

<span class="token comment">// 写文件</span>
df1<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;ename&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;csv&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token string">&quot;data/t2&quot;</span><span class="token punctuation">)</span>
df1<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;ename&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>write
<span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token string">&quot;header&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;csv&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token string">&quot;data/t2&quot;</span><span class="token punctuation">)</span>

建表<span class="token operator">:</span>
val data <span class="token operator">=</span>spark<span class="token punctuation">.</span>read<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token string">&quot;/project/weibo/*.json&quot;</span><span class="token punctuation">)</span>
data<span class="token punctuation">.</span><span class="token function">createOrReplaceTempView</span><span class="token punctuation">(</span><span class="token string">&quot;t2&quot;</span><span class="token punctuation">)</span>
 spark<span class="token punctuation">.</span><span class="token function">sql</span><span class="token punctuation">(</span><span class="token string">&quot;create table sparkproject.weibo as select * from t2&quot;</span><span class="token punctuation">)</span>
 spark<span class="token punctuation">.</span><span class="token function">sql</span><span class="token punctuation">(</span><span class="token string">&quot;select * from  sparkproject.weibo limit 5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

</code></pre></div><h4 id="_13-df、ds对象上的sql语句"><a href="#_13-df、ds对象上的sql语句" class="header-anchor">#</a> 13. DF、DS对象上的SQL语句</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 注册为临时视图。</span>
<span class="token comment">// 有两种形式：createOrReplaceTempView / createTempView </span>
df1<span class="token punctuation">.</span><span class="token function">createOrReplaceTempView</span><span class="token punctuation">(</span><span class="token string">&quot;temp1&quot;</span><span class="token punctuation">)</span>
spark<span class="token punctuation">.</span><span class="token function">sql</span><span class="token punctuation">(</span><span class="token string">&quot;select * from temp1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

df1<span class="token punctuation">.</span><span class="token function">createTempView</span><span class="token punctuation">(</span><span class="token string">&quot;temp2&quot;</span><span class="token punctuation">)</span>
spark<span class="token punctuation">.</span><span class="token function">sql</span><span class="token punctuation">(</span><span class="token string">&quot;select * from temp2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

<span class="token comment">// 使用下面的语句可以看见注册的临时表</span>
spark<span class="token punctuation">.</span>catalog<span class="token punctuation">.</span>listTables<span class="token punctuation">.</span>show	

备注：
<span class="token number">1</span>、spark<span class="token punctuation">.</span>sql返回的是<span class="token class-name">DataFrame</span>；
<span class="token number">2</span>、如果<span class="token class-name">TempView</span>已经存在，使用createTempView会报错；
<span class="token number">3</span>、SQL的语法与HQL兼容；

</code></pre></div><h2 id="三-窗体函数-不断地累计计算"><a href="#三-窗体函数-不断地累计计算" class="header-anchor">#</a> 三 窗体函数 （不断地累计计算）</h2> <h3 id="_1-语法形式"><a href="#_1-语法形式" class="header-anchor">#</a> 1. 语法形式</h3> <p>分析函数的语法结构一般是：</p> <div class="language-java extra-class"><pre class="language-java"><code>分析函数名<span class="token punctuation">(</span>参数<span class="token punctuation">)</span> OVER <span class="token punctuation">(</span>PARTITION BY子句 ORDER BY子句 ROWS<span class="token operator">/</span>RANGE子句<span class="token punctuation">)</span>

分析函数名：sum、max、min、count、avg等聚集函数<span class="token punctuation">,</span>或lead、lag行比较函数 或 排名函数等；
over：关键字，表示前面的函数是分析函数，不是普通的集合函数；
分析子句：over关键字后面挂号内的内容；分析子句又由以下三部分组成：
partition by：分组子句，表示分析函数的计算范围，不同的组互不相干；
ORDER BY：排序子句，表示分组后，组内的排序方式；
ROWS<span class="token operator">/</span>RANGE：窗口子句，是在分组<span class="token punctuation">(</span><span class="token class-name">PARTITION</span> BY<span class="token punctuation">)</span>后，组内的子分组（也称窗口），是分析函数的计算范围窗口。窗口有两种，ROWS和RANGE；

</code></pre></div><img src="/assets/img/dp/spark/sparksql/20191015141355739.png" alt="wxmp" class="zoom-custom-imgs"> <div class="language-sql extra-class"><pre class="language-sql"><code>spark<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;&quot;
SELECT cookieid, createtime, pv,
SUM(pv) OVER(PARTITION BY cookieid ORDER BY createtime) AS pv1,
SUM(pv) OVER(PARTITION BY cookieid ORDER BY createtime
ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS pv2
FROM t1
“”&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">show</span>


<span class="token keyword">ROWS</span> <span class="token operator">BETWEEN</span>，也叫做Window子句
当同一个<span class="token keyword">select</span>查询中存在多个窗口函数时<span class="token punctuation">,</span>他们相互之间是没有影响的<span class="token punctuation">.</span>每个窗口函数应用自己的规则；

<span class="token keyword">ROWS</span> <span class="token operator">BETWEEN</span> <span class="token keyword">UNBOUNDED</span> <span class="token keyword">PRECEDING</span> <span class="token operator">AND</span> <span class="token keyword">CURRENT</span> <span class="token keyword">ROW</span>：
<span class="token keyword">ROWS</span> <span class="token operator">BETWEEN</span> … <span class="token operator">AND</span> …<span class="token punctuation">(</span>开始到结束，位置不能交换<span class="token punctuation">)</span>
<span class="token keyword">UNBOUNDED</span> <span class="token keyword">PRECEDING</span>：从第一行开始
<span class="token keyword">CURRENT</span> <span class="token keyword">ROW</span>：当前行

第一行：<span class="token keyword">UNBOUNDED</span> <span class="token keyword">PRECEDING</span>
最后一行：<span class="token keyword">UNBOUNDED</span> <span class="token keyword">FOLLOWING</span>
前 n 行：n <span class="token keyword">PRECEDING</span>
后 n 行：n <span class="token keyword">FOLLOWING</span>

</code></pre></div><img src="/assets/img/dp/spark/sparksql/20191015141533753.png" alt="wxmp" class="zoom-custom-imgs"> <h3 id="_2-rows-range"><a href="#_2-rows-range" class="header-anchor">#</a> 2. rows &amp; range</h3> <div class="language-sql extra-class"><pre class="language-sql"><code>	range是逻辑窗口，是指定当前行对应值的范围取值，行数不固定，
只要行值在范围内，对应列都包含在内。

	<span class="token keyword">rows</span>是物理窗口，即根据<span class="token keyword">order</span> <span class="token keyword">by</span> 子句排序后，取的前N行及后N行的数据计算
（与当前行的值无关，只与排序后的行号相关）。
“<span class="token keyword">ROWS</span>” 是按照行数进行范围定位的，
而“RANGE”则是按照值范围进行定位的，
这两个不同的定位方式 主要用来处理并列排序的情况	前后遇到相同的值的时候会进行累加

</code></pre></div><img src="/assets/img/dp/spark/sparksql/20191015141853245.png" alt="wxmp" class="zoom-custom-imgs"> <h3 id="_3-partition-by-order-by的组合"><a href="#_3-partition-by-order-by的组合" class="header-anchor">#</a> 3.partition by &amp; order by的组合</h3> <ol><li><p>同时存在</p> <div class="language-sql extra-class"><pre class="language-sql"><code> spark<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;&quot;
 SELECT cookieid, createtime, pv,
        SUM(pv) OVER(PARTITION BY cookieid ORDER BY createtime) AS pv1
 FROM t1
 &quot;&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">show</span>

</code></pre></div></li></ol> <p>正常显示</p> <ol start="2"><li>partition by出现</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code>	spark<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;&quot;
	SELECT cookieid, createtime, pv,
	       SUM(pv) OVER(PARTITION BY cookieid ) AS pv1
	FROM t1
	&quot;&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">show</span>

</code></pre></div><p>没有排序仅分组内没有一个个迭代计算</p> <p>都是分组的计算值</p> <ol start="3"><li><p>order by 出现
只有排序 两两相加再加上,上一个的和(两两是计算机分组的数)</p></li> <li><p>都没有
显示总计算值</p></li></ol> <h3 id="_4-排名函数"><a href="#_4-排名函数" class="header-anchor">#</a> 4. 排名函数</h3> <p>row_number() 是没有重复值的排序(即使两行记录相等也是不重复的)
rank() 是跳跃排序，两个第二名下来就是第四名
dense_rank() 是连续排序，两个第二名仍然跟着第三名
NTILE(n)，用于将分组数据按照顺序切分成n片</p> <div class="language-sql extra-class"><pre class="language-sql"><code>spark<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;&quot;
SELECT cookieid, createtime, pv,
       row_number() OVER(PARTITION BY cookieid ORDER BY pv desc) AS rank1,
       rank()       OVER(PARTITION BY cookieid ORDER BY pv desc) AS rank2,
       dense_rank() OVER(PARTITION BY cookieid ORDER BY pv desc) AS rank3,
       ntile(3)      OVER(PARTITION BY cookieid ORDER BY pv desc) AS rank4
FROM t1
&quot;&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">show</span>

</code></pre></div><h3 id="_5-行函数-lag、lead"><a href="#_5-行函数-lag、lead" class="header-anchor">#</a> 5. 行函数：lag、lead</h3> <p>lag(field, N) 取前N行的值</p> <p>lead(field, N) 取后N行的值</p> <p>注意:取前/后N行的值是当前行往前/后数第n行的值</p> <p>first_value，取分组内排序后，截止到当前行，第一个值</p> <p>根据组内排序获得第一行的</p> <p>last_value，取分组内排序后，截止到当前行，最后一个值</p> <p>也就是当前行的值</p> <div class="language-sql extra-class"><pre class="language-sql"><code>spark<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;&quot;
  select cookieid, createtime, pv,
         lag(pv)    over (PARTITION BY cookieid ORDER BY pv) as col1,
         lag(pv, 1) over (PARTITION BY cookieid ORDER BY pv) as col2,
         lag(pv, 2) over (PARTITION BY cookieid ORDER BY pv) as col3
    from t1
  order by cookieid&quot;&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">show</span>

spark<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;&quot;
  select cookieid, createtime, pv,
         lead(pv)    over (PARTITION BY cookieid ORDER BY pv) as col1,
         lead(pv, 1) over (PARTITION BY cookieid ORDER BY pv) as col2,
         lead(pv, 2) over (PARTITION BY cookieid ORDER BY pv) as col3
    from t1
  order by cookieid&quot;&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">show</span>

spark<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;&quot;
  select cookieid, createtime, pv,
         lead(pv, -2) over (PARTITION BY cookieid ORDER BY pv) as col1,
         lag(pv, 2)   over (PARTITION BY cookieid ORDER BY pv) as col2
    from t1
  order by cookieid&quot;&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">show</span>

</code></pre></div><h3 id="_6-first-value、last-value"><a href="#_6-first-value、last-value" class="header-anchor">#</a> 6. first_value、last_value</h3> <p>first_value，取分组内排序后，截止到当前行，第一个值
根据组内排序获得第一行的
last_value，取分组内排序后，截止到当前行，最后一个值
也就是当前行的值</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">// first_value，取分组内排序后，截止到当前行，第一个值</span>
spark<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;&quot;
SELECT cookieid, createtime, pv,
       row_number()  OVER(PARTITION BY cookieid ORDER BY pv desc) AS rank1,
       first_value(createtime) OVER(PARTITION BY cookieid ORDER BY pv desc) AS rank2,
       first_value(pv) OVER(PARTITION BY cookieid ORDER BY pv desc) AS rank3
FROM t1
&quot;&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">show</span>

<span class="token comment">// last_value，取分组内排序后，截止到当前行，最后一个值</span>
spark<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;&quot;
SELECT cookieid, createtime, pv,
       row_number()  OVER(PARTITION BY cookieid ORDER BY pv desc) AS rank1,
       last_value(createtime) OVER(PARTITION BY cookieid ORDER BY pv desc) AS rank2,
       last_value(pv) OVER(PARTITION BY cookieid ORDER BY pv desc) AS rank3
FROM t1
&quot;&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">show</span>

<span class="token comment">// 备注：lag、lead、first_value、last_value 不支持窗口子句</span>

</code></pre></div><h3 id="_7-合并记录-collect-set-concat-ws-collect-list"><a href="#_7-合并记录-collect-set-concat-ws-collect-list" class="header-anchor">#</a> 7.合并记录(collect_set,concat_ws,collect_list)</h3> <p>都是内置的函数
concat_ws：实现多行记录合并成一行
collect_set：对记录去重
collect_list：不对记录去重<img src="/assets/img/dp/spark/sparksql/20191015143432625.png" alt="wxmp" class="zoom-custom-imgs"><strong>案例</strong>：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">case</span> class UserAddress<span class="token punctuation">(</span>userid:String<span class="token punctuation">,</span> address:String<span class="token punctuation">)</span>
val userinfo <span class="token operator">=</span> Seq<span class="token punctuation">(</span>UserAddress<span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;address1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> UserAddress<span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;address2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> UserAddress<span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;address2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> UserAddress<span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;address3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> UserAddress<span class="token punctuation">(</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;address4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
val ds1 <span class="token operator">=</span> spark<span class="token punctuation">.</span>createDataset<span class="token punctuation">(</span>userinfo<span class="token punctuation">)</span>
ds1<span class="token punctuation">.</span>createOrReplaceTempView<span class="token punctuation">(</span><span class="token string">&quot;t1&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// SQL语句</span>
val df2 <span class="token operator">=</span> spark<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;&quot;
  select userid, concat_ws(';', collect_set(address))  as addSet,
                 concat_ws(',', collect_list(address)) as addList,
                 collect_list(address) as addSet1,
                 collect_list(address) as addList1
    from t1 
  group by userid
&quot;&quot;&quot;</span><span class="token punctuation">)</span>
df2<span class="token punctuation">.</span>printSchema
df2<span class="token punctuation">.</span><span class="token keyword">show</span>

<span class="token comment">// DSL语法</span>
ds1<span class="token punctuation">.</span>groupBy<span class="token punctuation">(</span>$<span class="token string">&quot;userid&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
   agg<span class="token punctuation">(</span>collect_list<span class="token punctuation">(</span>$<span class="token string">&quot;address&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alias<span class="token punctuation">(</span><span class="token string">&quot;address1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
        collect_set<span class="token punctuation">(</span>$<span class="token string">&quot;address&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alias<span class="token punctuation">(</span><span class="token string">&quot;address2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">show</span>

</code></pre></div><h3 id="_8-展开记录-explode"><a href="#_8-展开记录-explode" class="header-anchor">#</a> 8.展开记录（explode）</h3> <img src="/assets/img/dp/spark/sparksql/20191015143806199.png" alt="wxmp" class="zoom-custom-imgs"> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//合并</span>
val ds2 <span class="token operator">=</span> ds1<span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span>$<span class="token string">&quot;userid&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">agg</span><span class="token punctuation">(</span><span class="token function">collect_set</span><span class="token punctuation">(</span>$<span class="token string">&quot;address&quot;</span><span class="token punctuation">)</span> as <span class="token string">&quot;address&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// 拆分</span>
<span class="token comment">// SQL语句</span>
ds2<span class="token punctuation">.</span><span class="token function">createOrReplaceTempView</span><span class="token punctuation">(</span><span class="token string">&quot;t2&quot;</span><span class="token punctuation">)</span>
<span class="token comment">// explode：将一行中复杂的array或者map结构拆分成多行</span>
spark<span class="token punctuation">.</span><span class="token function">sql</span><span class="token punctuation">(</span><span class="token string">&quot;select userid, explode(address) from t2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

<span class="token comment">// DSL语法</span>
ds2<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>$<span class="token string">&quot;userid&quot;</span><span class="token punctuation">,</span> <span class="token function">explode</span><span class="token punctuation">(</span>$<span class="token string">&quot;address&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

</code></pre></div><h3 id="_9-left-semi-anti-join"><a href="#_9-left-semi-anti-join" class="header-anchor">#</a> 9.left semi &amp; anti join</h3> <p>半连接：左半连接实现了类似in、exists的查询语义，输出符合条件的左表内容;</p> <p>反连接：两表关联，只返回主表的数据，并且只返回主表与子表没关联上的数据，这种连接就叫反连接。反连接一般就是指的 not in 和 not exists;</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">// 等价的SQL（左半连接、in、exists）这几个等价</span>
<span class="token comment">// 效率最低</span>
<span class="token keyword">sql</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;&quot;
  (select id from t1
  intersect
  select id from t2)
  order by id
&quot;&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">show</span>

spark<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;&quot;
  select t1.id 
    from t1 left semi join t2 on (t1.id=t2.id)
&quot;&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">show</span>

spark<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;&quot;
  select t1.id 
    from t1
   where t1.id in (select id from t2)
&quot;&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">show</span>

spark<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;&quot;
  select t1.id 
    from t1
   where exists (select id from t2 where t1.id = t2.id)
&quot;&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">show</span>
备注：三条查询语句使用了相同的执行计划
</code></pre></div><img src="/assets/img/dp/spark/sparksql/2019101514462577.png" alt="wxmp" class="zoom-custom-imgs"> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">// 等价的SQL（左反连接、in、exists）</span>
spark<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;&quot;
  select t1.id 
    from t1 left anti join t2 on (t1.id=t2.id)
&quot;&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">show</span>

spark<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;&quot;
  select t1.id 
    from t1
   where t1.id not in (select id from t2)
&quot;&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">show</span>

spark<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;&quot;
  select t1.id 
    from t1
   where not exists (select id from t2 where t1.id = t2.id)
&quot;&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">show</span>

</code></pre></div><img src="/assets/img/dp/spark/sparksql/20191015144639840.png" alt="wxmp" class="zoom-custom-imgs">
备注：
- 1、Hive在0.13版本中才实现(not) in/exists功能。在低版本的Hive中只能使用left semi/anti join；
- 2、传统的数据库中，历史上exists先执行外层查询，再执行内层查询，与in相反；现在的优化引擎一般情况下能够做出正确的选择；
- 3、在数据量小的情况下，三者等同。数据量大推荐使用join，具体还要看执行计划
<h2 id="四-udf"><a href="#四-udf" class="header-anchor">#</a> 四.UDF</h2> <p>UDF: 自定义函数。函数的输入、输出都是一条数据记录，类似于Spark SQL中普通的数学或字符串函数，从实现上看就是普通的Scala函数；
为了解决一些复杂的计算,并在SQL函数与Scala函数之间左右逢源
UDF的参数视为数据表的某个列;
书写规范:</p> <h3 id="_1-注册版"><a href="#_1-注册版" class="header-anchor">#</a> 1.注册版</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token number">1.</span> <span class="token keyword">import</span> <span class="token namespace">spark<span class="token punctuation">.</span>implicits<span class="token punctuation">.</span></span>_
<span class="token number">2.</span> def <span class="token function">funName</span><span class="token punctuation">(</span>参数<span class="token operator">:</span>类型<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">{</span>函数体<span class="token punctuation">}</span> <span class="token comment">//自定义函数</span>
<span class="token number">3.</span> spark<span class="token punctuation">.</span>udf<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>“fun1”<span class="token punctuation">,</span> funName _ <span class="token punctuation">)</span>
   fun1 <span class="token operator">:</span>是sql中要用的函数
   funName _ <span class="token operator">:</span>自定义的函数名<span class="token operator">+</span>空格<span class="token operator">+</span>下划线
   <span class="token comment">// 注册函数</span>
   <span class="token number">4</span><span class="token punctuation">)</span>val x<span class="token operator">=</span>spark<span class="token punctuation">.</span><span class="token function">sql</span><span class="token punctuation">(</span>“select id<span class="token punctuation">,</span> <span class="token function">fun1</span><span class="token punctuation">(</span>colname<span class="token punctuation">)</span> from tbName ”<span class="token punctuation">)</span>
   
</code></pre></div><h3 id="_2-非注册版"><a href="#_2-非注册版" class="header-anchor">#</a> 2.非注册版</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token number">1.</span> <span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>functions<span class="token punctuation">.</span></span>_
   <span class="token keyword">import</span> <span class="token namespace">spark<span class="token punctuation">.</span>implicits<span class="token punctuation">.</span></span>_
<span class="token number">2.</span> val fun2<span class="token operator">=</span><span class="token function">udf</span><span class="token punctuation">(</span><span class="token punctuation">(</span>参数<span class="token operator">:</span>类型<span class="token punctuation">,</span>length<span class="token operator">:</span><span class="token class-name">Int</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">&gt;</span>参数<span class="token punctuation">.</span>length<span class="token operator">&gt;</span>length<span class="token punctuation">)</span>
<span class="token number">3.</span> val getData<span class="token operator">=</span><span class="token class-name">DataFrame</span>类型数据<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token function">fun2</span><span class="token punctuation">(</span>$ ”参数”<span class="token punctuation">,</span><span class="token function">lit</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   $ <span class="token operator">:</span> 可以接收的数据会当成<span class="token class-name">Column</span>对象<span class="token punctuation">(</span>$符号来包裹一个字符串表示一个<span class="token class-name">Column</span><span class="token punctuation">)</span>
   当不用注册时要有udf包住自定义函数—<span class="token operator">&gt;</span>udf函数
</code></pre></div><h3 id="_3-案例"><a href="#_3-案例" class="header-anchor">#</a> 3. 案例</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token punctuation">{</span><span class="token class-name">Row</span><span class="token punctuation">,</span> <span class="token class-name">SparkSession</span><span class="token punctuation">}</span>

object <span class="token class-name">UDFDemo</span> <span class="token punctuation">{</span>
  def <span class="token function">main</span><span class="token punctuation">(</span>args<span class="token operator">:</span> <span class="token class-name">Array</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Unit</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    val spark <span class="token operator">=</span> <span class="token class-name">SparkSession</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">appName</span><span class="token punctuation">(</span><span class="token string">&quot;UDFDemo&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">master</span><span class="token punctuation">(</span><span class="token string">&quot;local[*]&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">getOrCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    spark<span class="token punctuation">.</span>sparkContext<span class="token punctuation">.</span><span class="token function">setLogLevel</span><span class="token punctuation">(</span><span class="token string">&quot;WARN&quot;</span><span class="token punctuation">)</span>

    val data <span class="token operator">=</span> <span class="token class-name">List</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;scala&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;author1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&quot;spark&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;author2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&quot;hadoop&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;author3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&quot;hive&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;author4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&quot;strom&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;author5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&quot;kafka&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;author6&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    val df <span class="token operator">=</span> spark<span class="token punctuation">.</span><span class="token function">createDataFrame</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDF</span><span class="token punctuation">(</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;author&quot;</span><span class="token punctuation">)</span>
    df<span class="token punctuation">.</span><span class="token function">createTempView</span><span class="token punctuation">(</span><span class="token string">&quot;books&quot;</span><span class="token punctuation">)</span>

    <span class="token comment">// 定义函数并注册</span>
    def <span class="token function">len1</span><span class="token punctuation">(</span>bookTitle<span class="token operator">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token class-name">Int</span> <span class="token operator">=</span> bookTitle<span class="token punctuation">.</span>length
    spark<span class="token punctuation">.</span>udf<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">&quot;len1&quot;</span><span class="token punctuation">,</span> len1 _<span class="token punctuation">)</span>
    <span class="token comment">// UDF可以在select语句、where语句等多处使用</span>
    spark<span class="token punctuation">.</span><span class="token function">sql</span><span class="token punctuation">(</span><span class="token string">&quot;select title, author, len1(title) from books&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
    spark<span class="token punctuation">.</span><span class="token function">sql</span><span class="token punctuation">(</span><span class="token string">&quot;select title, author from books where len1(title)&gt;5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

    <span class="token comment">// UDF可以在DataFrame、Dataset的API中使用</span>
    <span class="token keyword">import</span> <span class="token namespace">spark<span class="token punctuation">.</span>implicits<span class="token punctuation">.</span></span>_
    df<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token string">&quot;len1(title)&gt;5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
    <span class="token comment">// 不能通过编译</span>
    <span class="token comment">//df.filter(len1($&quot;title&quot;)&gt;5).show</span>
    <span class="token comment">// 能通过编译，但不能执行</span>
    <span class="token comment">//df.select(&quot;len1(title)&quot;).show</span>
    <span class="token comment">// 不能通过编译</span>
    <span class="token comment">//df.select(len1($&quot;title&quot;)).show</span>

    <span class="token comment">// 如果要在DSL语法中使用$符号包裹字符串表示一个Column，需要用udf方法来接收函数。这种函数无需注册</span>
    <span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>spark<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>functions<span class="token punctuation">.</span></span>_
    val len2 <span class="token operator">=</span> <span class="token function">udf</span><span class="token punctuation">(</span><span class="token punctuation">(</span>bookTitle<span class="token operator">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> bookTitle<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
    df<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token function">len2</span><span class="token punctuation">(</span>$<span class="token string">&quot;title&quot;</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show
    df<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token function">len2</span><span class="token punctuation">(</span>$<span class="token string">&quot;title&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>show

    <span class="token comment">// 不使用UDF</span>
    df<span class="token punctuation">.</span>map<span class="token punctuation">{</span><span class="token keyword">case</span> <span class="token class-name">Row</span><span class="token punctuation">(</span>title<span class="token operator">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> author<span class="token operator">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>title<span class="token punctuation">,</span> author<span class="token punctuation">,</span> title<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">.</span>show

    spark<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="五-udaf"><a href="#五-udaf" class="header-anchor">#</a> 五. UDAF</h2> <p>UDAF :用户自定义聚合函数。函数本身作用于数据集合，能够在聚合操作的基础上进行自定义操作（多条数据输入，一条数据输出）；类似于在group by之后使用的sum、avg等函数</p> <img src="/assets/img/dp/spark/sparksql/20191015182243248.png" alt="wxmp" class="zoom-custom-imgs"> <img src="/assets/img/dp/spark/sparksql/20191015182253304.png" alt="wxmp" class="zoom-custom-imgs"> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">UserDefinedAggregateFunction</span> <span class="token keyword">extends</span> <span class="token class-name">Serializable</span><span class="token punctuation">{</span>
def inputSchema <span class="token operator">:</span> <span class="token class-name">StructType</span>
<span class="token comment">//inputSchema用于定义与DataFrame列有关的输入样式</span>

def bufferSchema <span class="token operator">:</span> <span class="token class-name">StructType</span>
<span class="token comment">//bufferSchema用于定义存储聚合运算时产生的中间数据结果的Schema；</span>

def dataType <span class="token operator">:</span> <span class="token class-name">DataFrame</span>
<span class="token comment">//dataType标明了UDAF函数的返回值类型；</span>

def deterministic <span class="token operator">:</span> <span class="token class-name">Boolean</span>
<span class="token comment">//deterministic是一个布尔值，用以标记针对给定的一组输入,UDAF是否总是生成相同的结果；</span>

def initialize <span class="token punctuation">(</span> buffer <span class="token operator">:</span> <span class="token class-name">MutableAggregationBuffer</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token class-name">Unit</span>
<span class="token comment">//initialize对聚合运算中间结果的初始化；</span>

def update <span class="token punctuation">(</span> buffer <span class="token operator">:</span> <span class="token class-name">MutableAggregationBuffer</span> <span class="token punctuation">,</span> input <span class="token operator">:</span><span class="token class-name">Row</span><span class="token punctuation">)</span> <span class="token operator">:</span><span class="token class-name">Unit</span>
<span class="token comment">//update函数的第一个参数为bufferSchema中两个Field的索引，默认以0开始；</span>
UDAF的核心计算都发生在update函数中；
update函数的第二个参数input<span class="token operator">:</span> <span class="token class-name">Row</span>对应的并非<span class="token class-name">DataFrame</span>的行，
而是被inputSchema投影了的行<span class="token punctuation">;</span>

def merge <span class="token punctuation">(</span>buffer1 <span class="token operator">:</span> <span class="token class-name">MutableAggregationBuffer</span> <span class="token punctuation">,</span> buffer2 <span class="token operator">:</span> <span class="token class-name">Row</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token class-name">Unit</span>
<span class="token comment">//merge函数负责合并两个聚合运算的buffer，再将其存储到MutableAggregationBuffer中;</span>

def evluate <span class="token punctuation">(</span> buffer <span class="token operator">:</span><span class="token class-name">Row</span> <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Any</span>                       
<span class="token comment">//evaluate函数完成对聚合Buffer值的运算，得到最终的结果</span>
 <span class="token punctuation">}</span>

</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code>普通的UDF不支持数据的聚合运算。如当要对销售数据执行年度同比计算，就需要对当年和上一年的销量分别求和，然后再利用同比公式进行计算。
书写UDAF 先继承<span class="token class-name">UserDefinedAggregateFunction</span>接口
在重写他的方法
def update <span class="token punctuation">(</span> buffer <span class="token operator">:</span> <span class="token class-name">MutableAggregationBuffer</span> <span class="token punctuation">,</span> input <span class="token operator">:</span><span class="token class-name">Row</span><span class="token punctuation">)</span> <span class="token operator">:</span><span class="token class-name">Unit</span>
<span class="token comment">// UDAF的核心计算都发生在update函数中。</span>
<span class="token comment">// 扫描每行数据，都会调用一次update，输入buffer（缓存中间结果）、input（这一行的输入值）</span>
<span class="token comment">// update函数的第一个参数为bufferSchema中两个Field的索引，默认以0开始</span>
<span class="token comment">// update函数的第二个参数input: Row对应的是被inputSchema投影了的行。</span>
<span class="token comment">// 本例中每一个input就应该只有两个Field的值，input(0)代表销量，input(1)代表销售日期</span>

</code></pre></div><h3 id="案例"><a href="#案例" class="header-anchor">#</a> 案例</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">YearOnYearBasis</span> <span class="token keyword">extends</span> <span class="token class-name">UserDefinedAggregateFunction</span> <span class="token punctuation">{</span>
  <span class="token comment">// UDAF与DataFrame列有关的输入样式</span>
  override def inputSchema<span class="token operator">:</span> <span class="token class-name">StructType</span> 
  				<span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StructType</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				  <span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;sales&quot;</span><span class="token punctuation">,</span> <span class="token class-name">DoubleType</span><span class="token punctuation">)</span>
				  <span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;saledate&quot;</span><span class="token punctuation">,</span> <span class="token class-name">StringType</span><span class="token punctuation">)</span>

  <span class="token comment">// UDAF函数的返回值类型</span>
  override def dataType<span class="token operator">:</span> <span class="token class-name">DataType</span> <span class="token operator">=</span> <span class="token class-name">DoubleType</span>

  <span class="token comment">// 缓存中间结果</span>
  override def bufferSchema<span class="token operator">:</span> <span class="token class-name">StructType</span> 
  					<span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StructType</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  					<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;year2014&quot;</span><span class="token punctuation">,</span> <span class="token class-name">DoubleType</span><span class="token punctuation">)</span>
  					<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;year2015&quot;</span><span class="token punctuation">,</span> <span class="token class-name">DoubleType</span><span class="token punctuation">)</span>

  <span class="token comment">// 布尔值，用以标记针对给定的一组输入，UDAF是否总是生成相同的结果。通常用true</span>
  override def deterministic<span class="token operator">:</span> <span class="token class-name">Boolean</span> <span class="token operator">=</span> <span class="token boolean">true</span>

  <span class="token comment">// initialize就是对聚合运算中间结果的初始化</span>
  override def <span class="token function">initialize</span><span class="token punctuation">(</span>buffer<span class="token operator">:</span> <span class="token class-name">MutableAggregationBuffer</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Unit</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">buffer</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token function">buffer</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0.0</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// UDAF的核心计算都发生在update函数中。</span>
  <span class="token comment">// 扫描每行数据，都会调用一次update，输入buffer（缓存中间结果）、input（这一行的输入值）</span>
  <span class="token comment">// update函数的第一个参数为bufferSchema中两个Field的索引，默认以0开始</span>
  <span class="token comment">// update函数的第二个参数input: Row对应的是被inputSchema投影了的行。</span>
  <span class="token comment">// 本例中每一个input就应该只有两个Field的值，input(0)代表销量，input(1)代表销售日期</span>
  override def <span class="token function">update</span><span class="token punctuation">(</span>buffer<span class="token operator">:</span> <span class="token class-name">MutableAggregationBuffer</span><span class="token punctuation">,</span> input<span class="token operator">:</span> <span class="token class-name">Row</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Unit</span> <span class="token operator">=</span> <span class="token punctuation">{</span>	  
    val salenumber <span class="token operator">=</span> input<span class="token punctuation">.</span>getAs<span class="token punctuation">[</span><span class="token class-name">Double</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    input<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> match <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">&quot;2014&quot;</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">buffer</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> buffer<span class="token punctuation">.</span>getAs<span class="token punctuation">[</span><span class="token class-name">Double</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> salenumber
      <span class="token keyword">case</span> <span class="token string">&quot;2015&quot;</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">buffer</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> buffer<span class="token punctuation">.</span>getAs<span class="token punctuation">[</span><span class="token class-name">Double</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> salenumber
      <span class="token keyword">case</span> _ <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ERROR!&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 合并两个分区的buffer1、buffer2，将最终结果保存在buffer1中</span>
  override def <span class="token function">merge</span><span class="token punctuation">(</span>buffer1<span class="token operator">:</span> <span class="token class-name">MutableAggregationBuffer</span><span class="token punctuation">,</span> buffer2<span class="token operator">:</span> <span class="token class-name">Row</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Unit</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">buffer1</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> buffer1<span class="token punctuation">.</span><span class="token function">getDouble</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> buffer2<span class="token punctuation">.</span><span class="token function">getDouble</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token function">buffer1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> buffer1<span class="token punctuation">.</span><span class="token function">getDouble</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> buffer2<span class="token punctuation">.</span><span class="token function">getDouble</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 取出buffer（缓存的值）进行运算，得到最终结果</span>
  override def <span class="token function">evaluate</span><span class="token punctuation">(</span>buffer<span class="token operator">:</span> <span class="token class-name">Row</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Double</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">println</span><span class="token punctuation">(</span>s<span class="token string">&quot;evaluate : ${buffer.getDouble(0)}, ${buffer.getDouble(1)}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>buffer<span class="token punctuation">.</span><span class="token function">getDouble</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0.0</span><span class="token punctuation">)</span> <span class="token number">0.0</span>
    <span class="token keyword">else</span> <span class="token punctuation">(</span>buffer<span class="token punctuation">.</span><span class="token function">getDouble</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> buffer<span class="token punctuation">.</span><span class="token function">getDouble</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> buffer<span class="token punctuation">.</span><span class="token function">getDouble</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

object <span class="token class-name">UDAFDemo</span> <span class="token punctuation">{</span>
  def <span class="token function">main</span><span class="token punctuation">(</span>args<span class="token operator">:</span> <span class="token class-name">Array</span><span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Unit</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token string">&quot;org&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setLevel</span><span class="token punctuation">(</span><span class="token class-name">Level</span><span class="token punctuation">.</span>WARN<span class="token punctuation">)</span>
    val spark <span class="token operator">=</span> <span class="token class-name">SparkSession</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">appName</span><span class="token punctuation">(</span>s<span class="token string">&quot;${this.getClass.getCanonicalName}&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">master</span><span class="token punctuation">(</span><span class="token string">&quot;local[*]&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">getOrCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    val sales <span class="token operator">=</span> <span class="token class-name">Seq</span><span class="token punctuation">(</span>
      <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;Widget Co&quot;</span><span class="token punctuation">,</span>        <span class="token number">1000.00</span><span class="token punctuation">,</span> <span class="token number">0.00</span><span class="token punctuation">,</span>    <span class="token string">&quot;AZ&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2014-01-02&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;Acme Widgets&quot;</span><span class="token punctuation">,</span>     <span class="token number">2000.00</span><span class="token punctuation">,</span> <span class="token number">500.00</span><span class="token punctuation">,</span>  <span class="token string">&quot;CA&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2014-02-01&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;Widgetry&quot;</span><span class="token punctuation">,</span>         <span class="token number">1000.00</span><span class="token punctuation">,</span> <span class="token number">200.00</span><span class="token punctuation">,</span>  <span class="token string">&quot;CA&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2015-01-11&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&quot;Widgets R Us&quot;</span><span class="token punctuation">,</span>     <span class="token number">2000.00</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span>     <span class="token string">&quot;CA&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2015-02-19&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">&quot;Ye Olde Widgete&quot;</span><span class="token punctuation">,</span>  <span class="token number">3000.00</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span>     <span class="token string">&quot;MA&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2015-02-28&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>

    val salesDF <span class="token operator">=</span> spark<span class="token punctuation">.</span><span class="token function">createDataFrame</span><span class="token punctuation">(</span>sales<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDF</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sales&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;discount&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;state&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;saleDate&quot;</span><span class="token punctuation">)</span>
    salesDF<span class="token punctuation">.</span><span class="token function">createTempView</span><span class="token punctuation">(</span><span class="token string">&quot;sales&quot;</span><span class="token punctuation">)</span>

    val yearOnYear <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">YearOnYearBasis</span>
    spark<span class="token punctuation">.</span>udf<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">&quot;yearOnYear&quot;</span><span class="token punctuation">,</span> yearOnYear<span class="token punctuation">)</span>
    spark<span class="token punctuation">.</span><span class="token function">sql</span><span class="token punctuation">(</span><span class="token string">&quot;select yearOnYear(sales, saleDate) as yearOnYear from sales&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    spark<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><img src="/assets/img/dp/spark/sparksql/20191015182559249.png" alt="wxmp" class="zoom-custom-imgs"> <h2 id="六-从mysql读取数据"><a href="#六-从mysql读取数据" class="header-anchor">#</a> 六. 从MySQL读取数据</h2> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 读取数据库中的数据</span>
val jdbcDF <span class="token operator">=</span> spark<span class="token punctuation">.</span>read<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;jdbc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
				<span class="token function">option</span><span class="token punctuation">(</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;jdbc:mysql://localhost:3306/spark&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
				<span class="token function">option</span><span class="token punctuation">(</span><span class="token string">&quot;driver&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;com.mysql.jdbc.Driver&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
				<span class="token function">option</span><span class="token punctuation">(</span><span class="token string">&quot;dbtable&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;student&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
				<span class="token function">option</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hive&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
				<span class="token function">option</span><span class="token punctuation">(</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hive&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
jdbcDF<span class="token punctuation">.</span>show
jdbcDF<span class="token punctuation">.</span>printSchema

</code></pre></div><p>备注：</p> <ul><li>1、将jdbc驱动拷贝到<code>$SPARK_HOME/jars</code>目录下，是最简单的做法；</li> <li>2、明白每一个参数的意思，一个参数不对整个结果出不来；</li> <li>3、从数据库从读大量的数据进行分析，不推荐；读取少量的数据是可以接受的，也是常见的做法。</li></ul> <h2 id="参考文章"><a href="#参考文章" class="header-anchor">#</a> 参考文章</h2> <ul><li>https://blog.csdn.net/qq_45710900/article/details/102560025</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">2021-09-10 19:13:59</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/dp/spark/07-sparkshellintro.html" class="prev">
        Spark-SparkShell介绍
      </a></span> <span class="next"><a href="/dp/spark/09-sparkmllibintro.html">
        SparkMLLib-基础介绍
      </a>
      →
    </span></p></div> <div class="page_article_visit_tail" data-v-17815e06><img src="/assets/img/view/visit.png" alt="" data-v-17815e06>
         
        <span style="display:none;" data-v-17815e06>0</span></div> <div class="page_article_comment" data-v-17815e06></div></main> <div class="page-right-index-sidebar" data-v-17815e06><div class="content_index_title" data-v-17815e06>
      Spark-SparkSQL总结
    </div> <div class="page-right-index-toc" data-v-17815e06><ul data-v-17815e06><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#一-概述" aria-current="page" class="unactive_index_li" data-v-17815e06>一.概述
          </a> <ul data-v-17815e06><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#_1-spark历史" aria-current="page" class="unactive_index_li" data-v-17815e06>1 spark历史</a></li></ul><ul data-v-17815e06><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#_2-spark-sql-概述" aria-current="page" class="unactive_index_li" data-v-17815e06>2 Spark-SQL 概述</a></li></ul><ul data-v-17815e06><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#_3-dataset演进历史" aria-current="page" class="unactive_index_li" data-v-17815e06>3 Dataset演进历史</a></li></ul><ul data-v-17815e06><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#_4-sparksql-api" aria-current="page" class="unactive_index_li" data-v-17815e06>4 SparkSQL API</a></li></ul><ul data-v-17815e06><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#_5-基本操作" aria-current="page" class="unactive_index_li" data-v-17815e06>5 基本操作</a></li></ul><ul data-v-17815e06><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#_6-dataset-dataframe" aria-current="page" class="unactive_index_li" data-v-17815e06>6 Dataset &amp; DataFrame</a></li></ul><ul data-v-17815e06><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#_7-rdd-dataframe-dataset-相互转换" aria-current="page" class="unactive_index_li" data-v-17815e06>7 RDD &amp; DataFrame &amp; DataSet 相互转换</a></li></ul></li><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#二-spark-sql-算子" aria-current="page" class="unactive_index_li" data-v-17815e06>二. spark sql 算子
          </a> </li><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#三-窗体函数-不断地累计计算" aria-current="page" class="unactive_index_li" data-v-17815e06>三 窗体函数 （不断地累计计算）
          </a> <ul data-v-17815e06><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#_1-语法形式" aria-current="page" class="unactive_index_li" data-v-17815e06>1. 语法形式</a></li></ul><ul data-v-17815e06><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#_2-rows-range" aria-current="page" class="unactive_index_li" data-v-17815e06>2. rows &amp; range</a></li></ul><ul data-v-17815e06><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#_3-partition-by-order-by的组合" aria-current="page" class="unactive_index_li" data-v-17815e06>3.partition by &amp; order by的组合</a></li></ul><ul data-v-17815e06><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#_4-排名函数" aria-current="page" class="unactive_index_li" data-v-17815e06>4. 排名函数</a></li></ul><ul data-v-17815e06><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#_5-行函数-lag、lead" aria-current="page" class="unactive_index_li" data-v-17815e06>5. 行函数：lag、lead</a></li></ul><ul data-v-17815e06><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#_6-first-value、last-value" aria-current="page" class="unactive_index_li" data-v-17815e06>6. firstvalue、lastvalue</a></li></ul><ul data-v-17815e06><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#_7-合并记录-collect-set-concat-ws-collect-list" aria-current="page" class="unactive_index_li" data-v-17815e06>7.合并记录(collectset,concatws,collect_list)</a></li></ul><ul data-v-17815e06><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#_8-展开记录-explode" aria-current="page" class="unactive_index_li" data-v-17815e06>8.展开记录（explode）</a></li></ul><ul data-v-17815e06><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#_9-left-semi-anti-join" aria-current="page" class="unactive_index_li" data-v-17815e06>9.left semi &amp; anti join</a></li></ul></li><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#四-udf" aria-current="page" class="unactive_index_li" data-v-17815e06>四.UDF
          </a> <ul data-v-17815e06><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#_1-注册版" aria-current="page" class="unactive_index_li" data-v-17815e06>1.注册版</a></li></ul><ul data-v-17815e06><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#_2-非注册版" aria-current="page" class="unactive_index_li" data-v-17815e06>2.非注册版</a></li></ul><ul data-v-17815e06><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#_3-案例" aria-current="page" class="unactive_index_li" data-v-17815e06>3. 案例</a></li></ul></li><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#五-udaf" aria-current="page" class="unactive_index_li" data-v-17815e06>五. UDAF
          </a> <ul data-v-17815e06><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#案例" aria-current="page" class="unactive_index_li" data-v-17815e06>案例</a></li></ul></li><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#六-从mysql读取数据" aria-current="page" class="unactive_index_li" data-v-17815e06>六. 从MySQL读取数据
          </a> </li><li data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html#参考文章" aria-current="page" class="unactive_index_li" data-v-17815e06>参考文章
          </a> </li></ul> <div style="height:10px" data-v-17815e06></div></div></div> <div class="page-right-tool-sidebar" data-v-17815e06><div class="tool_bar_div" data-v-17815e06><img src="/assets/img/toolbar/phone.png" class="tool_bar_img_icon" data-v-17815e06> <div data-v-17815e06>手机看</div></div> <div class="tool_bar_div" data-v-17815e06><img src="/assets/img/toolbar/wechat.png" class="tool_bar_img_icon" data-v-17815e06> <div data-v-17815e06>公众号</div></div> <div class="tool_bar_div" data-v-17815e06><img src="/assets/img/toolbar/communication.png" class="tool_bar_img_icon" data-v-17815e06> <div data-v-17815e06>讨论</div></div> <div class="tool_bar_div" data-v-17815e06><img src="/assets/img/toolbar/leftclose.png" class="tool_bar_img_icon" data-v-17815e06> <div data-v-17815e06>左栏</div></div> <div class="tool_bar_div" data-v-17815e06><img src="/assets/img/toolbar/fullscreen.png" class="tool_bar_img_icon" data-v-17815e06> <div data-v-17815e06>全屏</div></div> <div style="display:none;" data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html" aria-current="page" class="router-link-exact-active router-link-active" data-v-17815e06><div class="tool_bar_div" data-v-17815e06><img src="/assets/img/toolbar/prev.png" class="tool_bar_img_icon" data-v-17815e06> <div data-v-17815e06>上一篇</div></div></a></div> <div style="display:none;" data-v-17815e06><a href="/dp/spark/08-sparksqlsum.html" aria-current="page" class="router-link-exact-active router-link-active" data-v-17815e06><div class="tool_bar_div" data-v-17815e06><img src="/assets/img/toolbar/next.png" class="tool_bar_img_icon" data-v-17815e06> <div data-v-17815e06>下一篇</div></div></a></div></div> <div id="qrCodeDiv" class="toolbar_qrcode_unactive" data-v-17815e06><div class=" toolbar_head_tile" data-v-17815e06>扫一扫 手机阅读</div> <img src="" class="img-qrcode" data-v-17815e06> <h5 data-v-17815e06>可分享给好友和朋友圈</h5></div> <div id="wxmpDiv" class="toolbar_wxmp_active" style="display:none;" data-v-17815e06><div class="toolbar_head_tile" data-v-17815e06>扫描关注公众号，回复&quot;资料&quot;，下载相关图书和资料</div> <img src="/assets/img/wx/wxmp.jpg" class="img-wx-mp" data-v-17815e06> <h5 data-v-17815e06>公众号:智能后端和架构</h5></div> <div id="coummpDiv" class="toolbar_communication_active" style="display:none;" data-v-17815e06><div class="toolbar_head_tile" data-v-17815e06>QQ群:569556849 <br data-v-17815e06>问题咨询和技术交流</div> <img src="/assets/img/qq/qqgroup.png" class="img-wx-mp" data-v-17815e06> <h5 data-v-17815e06>PS 备注:智能后端和架构</h5></div> <div class="topDivImg" style="display:none;" data-v-17815e06><img src="/assets/img/toolbar/top.png" class="tool_top_img_icon" data-v-17815e06></div> <div style="display:none" data-v-17815e06><script type="text/javascript" src="https://s9.cnzz.com/z_stat.php?id=1279777129&web_id=1279777129" data-v-17815e06></script></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.db30138a.js" defer></script><script src="/assets/js/5.df8bf371.js" defer></script><script src="/assets/js/1.60d99fe1.js" defer></script><script src="/assets/js/415.ad521b94.js" defer></script>
  </body>
</html>
